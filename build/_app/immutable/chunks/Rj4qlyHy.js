import{c as Mi,a as We,t as ft}from"./EPCxPUkR.js";import{i as ss,p as fo}from"./BntKbsvq.js";import{al as Hf,g as _c,h as lt,d as Ua,aD as jf,a3 as lo,aE as En,a1 as $i,Y as oa,i as Tn,q as Fa,k as $r,ap as Gi,ao as Vi,aF as ho,x as Kf,aa as qi,j as li,W as zf,K as Wf,C as gt,R as Us,ae as Yf,aG as Fs,az as vc,P as Hi,aH as Zf,ay as Xf,aI as Jf,aJ as Pa,aK as Ia,aL as Qf,w as Lf,M as Df,J as el,a7 as tl,a8 as po,a9 as Ps,av as rl,as as nl,aM as xc,aN as il,E as sl,aO as al,aP as ol,e as cl,u as ul,aQ as fl,aR as ll,aS as dl,aT as hl,v as hn,aq as pl,p as as,aB as di,aC as Ec,f as Xr,a as os,c as st,r as at,s as Gt,t as Tc,n as cs,U as pn,am as Zn,aU as gl}from"./Ed0z3nlt.js";import{b as yl,w as wl,s as Sc,e as Yt,c as bl}from"./BzXf-lHf.js";import{_ as Ac,p as Sn,a as An,i as Jr,s as ka}from"./BzlzEd_H.js";import{i as Nc,b as ml,a as _l,s as vl,g as Is}from"./00WE3K8Z.js";import{w as $n,d as Bc,o as Rc}from"./gaEbZ0v4.js";const ks=0,Xn=1,Cs=2;function xl(t,e,r,n,i){lt&&Ua();var s=t,c=Hf(),u=Kf,l=lo,p,b,x,_=(c?$i:oa)(void 0),v=(c?$i:oa)(void 0),d=!1;function A(P,I){d=!0,I&&(Gi(S),Vi(S),ho(u));try{P===ks&&r&&(p?qi(p):p=Tn(()=>r(s))),P===Xn&&n&&(b?qi(b):b=Tn(()=>n(s,_))),P!==ks&&p&&li(p,()=>p=null),P!==Xn&&b&&li(b,()=>b=null),P!==Cs&&x&&li(x,()=>x=null)}finally{I&&(ho(null),Vi(null),Gi(null),zf())}}var S=_c(()=>{if(l!==(l=e())){if(jf(l)){var P=l;d=!1,P.then(I=>{P===l&&(En(_,I),A(Xn,!0))},I=>{if(P===l)throw En(v,I),A(Cs,!0),v.v}),lt?r&&(p=Tn(()=>r(s))):Fa(()=>{d||A(ks,!0)})}else En(_,l),A(Xn,!1);return()=>l=lo}});lt&&(s=$r)}function Fg(t,e){return e}function El(t,e,r,n){for(var i=[],s=e.length,c=0;c<s;c++)Zf(e[c].e,i,!0);var u=s>0&&i.length===0&&r!==null;if(u){var l=r.parentNode;Xf(l),l.append(r),n.clear(),ar(t,e[0].prev,e[s-1].next)}Jf(i,()=>{for(var p=0;p<s;p++){var b=e[p];u||(n.delete(b.k),ar(t,b.prev,b.next)),Lf(b.e,!u)}})}function Oc(t,e,r,n,i,s=null){var c=t,u={flags:e,items:new Map,first:null},l=(e&xc)!==0;if(l){var p=t;c=lt?Us(Df(p)):p.appendChild(Wf())}lt&&Ua();var b=null,x=!1,_=Yf(()=>{var v=r();return el(v)?v:v==null?[]:vc(v)});_c(()=>{var v=gt(_),d=v.length;if(x&&d===0)return;x=d===0;let A=!1;if(lt){var S=c.data===tl;S!==(d===0)&&(c=po(),Us(c),Ps(!1),A=!0)}if(lt){for(var P=null,I,R=0;R<d;R++){if($r.nodeType===8&&$r.data===rl){c=$r,A=!0,Ps(!1);break}var H=v[R],B=n(H,R);I=Uc($r,u,P,null,H,B,R,i,e,r),u.items.set(B,I),P=I}d>0&&Us(po())}lt||Tl(v,u,c,i,e,n,r),s!==null&&(d===0?b?qi(b):b=Tn(()=>s(c)):b!==null&&li(b,()=>{b=null})),A&&Ps(!0),gt(_)}),lt&&(c=$r)}function Tl(t,e,r,n,i,s,c){var u=(i&il)!==0,l=(i&(Ia|Pa))!==0,p=t.length,b=e.items,x=e.first,_=x,v,d=null,A,S=[],P=[],I,R,H,B;if(u)for(B=0;B<p;B+=1)I=t[B],R=s(I,B),H=b.get(R),H!==void 0&&(H.a?.measure(),(A??(A=new Set)).add(H));for(B=0;B<p;B+=1){if(I=t[B],R=s(I,B),H=b.get(R),H===void 0){var j=_?_.e.nodes_start:r;d=Uc(j,e,d,d===null?e.first:d.next,I,R,B,n,i,c),b.set(R,d),S=[],P=[],_=d.next;continue}if(l&&Sl(H,I,B,i),H.e.f&Fs&&(qi(H.e),u&&(H.a?.unfix(),(A??(A=new Set)).delete(H))),H!==_){if(v!==void 0&&v.has(H)){if(S.length<P.length){var V=P[0],K;d=V.prev;var Y=S[0],z=S[S.length-1];for(K=0;K<S.length;K+=1)go(S[K],V,r);for(K=0;K<P.length;K+=1)v.delete(P[K]);ar(e,Y.prev,z.next),ar(e,d,Y),ar(e,z,V),_=V,d=z,B-=1,S=[],P=[]}else v.delete(H),go(H,_,r),ar(e,H.prev,H.next),ar(e,H,d===null?e.first:d.next),ar(e,d,H),d=H;continue}for(S=[],P=[];_!==null&&_.k!==R;)_.e.f&Fs||(v??(v=new Set)).add(_),P.push(_),_=_.next;if(_===null)continue;H=_}S.push(H),d=H,_=H.next}if(_!==null||v!==void 0){for(var ne=v===void 0?[]:vc(v);_!==null;)_.e.f&Fs||ne.push(_),_=_.next;var D=ne.length;if(D>0){var T=i&xc&&p===0?r:null;if(u){for(B=0;B<D;B+=1)ne[B].a?.measure();for(B=0;B<D;B+=1)ne[B].a?.fix()}El(e,ne,T,b)}}u&&Fa(()=>{if(A!==void 0)for(H of A)H.a?.apply()}),Hi.first=e.first&&e.first.e,Hi.last=d&&d.e}function Sl(t,e,r,n){n&Ia&&En(t.v,e),n&Pa?En(t.i,r):t.i=r}function Uc(t,e,r,n,i,s,c,u,l,p){var b=(l&Ia)!==0,x=(l&Qf)===0,_=b?x?oa(i):$i(i):i,v=l&Pa?$i(c):c,d={i:v,v:_,k:s,a:null,e:null,prev:r,next:n};try{return d.e=Tn(()=>u(t,_,v,p),lt),d.e.prev=r&&r.e,d.e.next=n&&n.e,r===null?e.first=d:(r.next=d,r.e.next=d.e),n!==null&&(n.prev=d,n.e.prev=d.e),d}finally{}}function go(t,e,r){for(var n=t.next?t.next.e.nodes_start:r,i=e?e.e.nodes_start:r,s=t.e.nodes_start;s!==n;){var c=nl(s);i.before(s),s=c}}function ar(t,e,r){e===null?t.first=r:(e.next=r,e.e.next=r&&r.e),r!==null&&(r.prev=e,r.e.prev=e&&e.e)}function Al(t,e,r,n,i){lt&&Ua();var s=e.$$slots?.[r],c=!1;s===!0&&(s=e.children,c=!0),s===void 0||s(t,c?()=>n:n)}function Fc(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(r=Fc(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Nl(){for(var t,e,r=0,n="",i=arguments.length;r<i;r++)(t=arguments[r])&&(e=Fc(t))&&(n&&(n+=" "),n+=e);return n}function Pg(t){return typeof t=="object"?Nl(t):t??""}const yo=[...` 	
\r\f \v\uFEFF`];function Bl(t,e,r){var n=t==null?"":""+t;if(e&&(n=n?n+" "+e:e),r){for(var i in r)if(r[i])n=n?n+" "+i:i;else if(n.length)for(var s=i.length,c=0;(c=n.indexOf(i,c))>=0;){var u=c+s;(c===0||yo.includes(n[c-1]))&&(u===n.length||yo.includes(n[u]))?n=(c===0?"":n.substring(0,c))+n.substring(u+1):c=u}}return n===""?null:n}function Ig(t,e){return t==null?null:String(t)}function Pc(t,e,r,n,i,s){var c=t.__className;if(lt||c!==r){var u=Bl(r,n,s);(!lt||u!==t.getAttribute("class"))&&(u==null?t.removeAttribute("class"):e?t.className=u:t.setAttribute("class",u)),t.__className=r}else if(s&&i!==s)for(var l in s){var p=!!s[l];(i==null||p!==!!i[l])&&t.classList.toggle(l,p)}return s}const Rl=()=>performance.now(),Kt={tick:t=>requestAnimationFrame(t),now:()=>Rl(),tasks:new Set};function Ic(){const t=Kt.now();Kt.tasks.forEach(e=>{e.c(t)||(Kt.tasks.delete(e),e.f())}),Kt.tasks.size!==0&&Kt.tick(Ic)}function Ol(t){let e;return Kt.tasks.size===0&&Kt.tick(Ic),{promise:new Promise(r=>{Kt.tasks.add(e={c:t,f:r})}),abort(){Kt.tasks.delete(e)}}}function Jn(t,e){wl(()=>{t.dispatchEvent(new CustomEvent(e))})}function Ul(t){if(t==="float")return"cssFloat";if(t==="offset")return"cssOffset";if(t.startsWith("--"))return t;const e=t.split("-");return e.length===1?e[0]:e[0]+e.slice(1).map(r=>r[0].toUpperCase()+r.slice(1)).join("")}function wo(t){const e={},r=t.split(";");for(const n of r){const[i,s]=n.split(":");if(!i||s===void 0)break;const c=Ul(i.trim());e[c]=s.trim()}return e}const Fl=t=>t;function ca(t,e,r,n){var i=(t&ll)!==0,s=(t&dl)!==0,c=i&&s,u=(t&fl)!==0,l=c?"both":i?"in":"out",p,b=e.inert,x=e.style.overflow,_,v;function d(){var R=pl,H=Hi;Vi(null),Gi(null);try{return p??(p=r()(e,n?.()??{},{direction:l}))}finally{Vi(R),Gi(H)}}var A={is_global:u,in(){if(e.inert=b,!i){v?.abort(),v?.reset?.();return}s||_?.abort(),Jn(e,"introstart"),_=ua(e,d(),v,1,()=>{Jn(e,"introend"),_?.abort(),_=p=void 0,e.style.overflow=x})},out(R){if(!s){R?.(),p=void 0;return}e.inert=!0,Jn(e,"outrostart"),v=ua(e,d(),_,0,()=>{Jn(e,"outroend"),R?.()})},stop:()=>{_?.abort(),v?.abort()}},S=Hi;if((S.transitions??(S.transitions=[])).push(A),i&&yl){var P=u;if(!P){for(var I=S.parent;I&&I.f&sl;)for(;(I=I.parent)&&!(I.f&al););P=!I||(I.f&ol)!==0}P&&cl(()=>{ul(()=>A.in())})}}function ua(t,e,r,n,i){var s=n===1;if(hl(e)){var c,u=!1;return Fa(()=>{if(!u){var S=e({direction:s?"in":"out"});c=ua(t,S,r,n,i)}}),{abort:()=>{u=!0,c?.abort()},deactivate:()=>c.deactivate(),reset:()=>c.reset(),t:()=>c.t()}}if(r?.deactivate(),!e?.duration)return i(),{abort:hn,deactivate:hn,reset:hn,t:()=>n};const{delay:l=0,css:p,tick:b,easing:x=Fl}=e;var _=[];if(s&&r===void 0&&(b&&b(0,1),p)){var v=wo(p(0,1));_.push(v,v)}var d=()=>1-n,A=t.animate(_,{duration:l});return A.onfinish=()=>{var S=r?.t()??1-n;r?.abort();var P=n-S,I=e.duration*Math.abs(P),R=[];if(I>0){var H=!1;if(p)for(var B=Math.ceil(I/16.666666666666668),j=0;j<=B;j+=1){var V=S+P*x(j/B),K=wo(p(V,1-V));R.push(K),H||(H=K.overflow==="hidden")}H&&(t.style.overflow="hidden"),d=()=>{var Y=A.currentTime;return S+P*x(Y/I)},b&&Ol(()=>{if(A.playState!=="running")return!1;var Y=d();return b(Y,1-Y),!0})}A=t.animate(R,{duration:I,fill:"forwards"}),A.onfinish=()=>{d=()=>n,b?.(n,1-n),i()}},{abort:()=>{A&&(A.cancel(),A.effect=null,A.onfinish=hn)},deactivate:()=>{i=hn},reset:()=>{n===0&&b?.(1,0)},t:()=>d()}}var Dr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Pl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}const Il=BigInt(60*60*1e3*1e3*1e3*24*14),kl=576,Cl=625;var fa;(function(t){t[t.SysFatal=1]="SysFatal",t[t.SysTransient=2]="SysTransient",t[t.DestinationInvalid=3]="DestinationInvalid",t[t.CanisterReject=4]="CanisterReject",t[t.CanisterError=5]="CanisterError"})(fa||(fa={}));const ji="abcdefghijklmnopqrstuvwxyz234567",en=Object.create(null);for(let t=0;t<ji.length;t++)en[ji[t]]=t;en[0]=en.o;en[1]=en.i;function Ml(t){let e=0,r=0,n="";function i(s){return e<0?r|=s>>-e:r=s<<e&248,e>3?(e-=8,1):(e<4&&(n+=ji[r>>3],e+=5),0)}for(let s=0;s<t.length;)s+=i(t[s]);return n+(e<0?ji[r>>3]:"")}function $l(t){let e=0,r=0;const n=new Uint8Array(t.length*4/3|0);let i=0;function s(c){let u=en[c.toLowerCase()];if(u===void 0)throw new Error(`Invalid character: ${JSON.stringify(c)}`);u<<=3,r|=u>>>e,e+=5,e>=8&&(n[i++]=r,e-=8,e>0?r=u<<5-e&255:r=0)}for(const c of t)s(c);return n.slice(0,i)}const Gl=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function Vl(t){const e=new Uint8Array(t);let r=-1;for(let n=0;n<e.length;n++){const s=(e[n]^r)&255;r=Gl[s]^r>>>8}return(r^-1)>>>0}function ql(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function kc(t,...e){if(!ql(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function bo(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Hl(t,e){kc(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Ir=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Ms(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ot(t,e){return t<<32-e|t>>>e}function jl(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Cc(t){return typeof t=="string"&&(t=jl(t)),kc(t),t}class Kl{clone(){return this._cloneInto()}}function Ca(t){const e=n=>t().update(Cc(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Mc(t=32){if(Ir&&typeof Ir.getRandomValues=="function")return Ir.getRandomValues(new Uint8Array(t));if(Ir&&typeof Ir.randomBytes=="function")return Ir.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function zl(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),c=Number(r>>i&s),u=Number(r&s),l=n?4:0,p=n?0:4;t.setUint32(e+l,c,n),t.setUint32(e+p,u,n)}function Wl(t,e,r){return t&e^~t&r}function Yl(t,e,r){return t&e^t&r^e&r}class $c extends Kl{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Ms(this.buffer)}update(e){bo(this);const{view:r,buffer:n,blockLen:i}=this;e=Cc(e);const s=e.length;for(let c=0;c<s;){const u=Math.min(i-this.pos,s-c);if(u===i){const l=Ms(e);for(;i<=s-c;c+=i)this.process(l,c);continue}n.set(e.subarray(c,c+u),this.pos),this.pos+=u,c+=u,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){bo(this),Hl(e,this),this.finished=!0;const{buffer:r,view:n,blockLen:i,isLE:s}=this;let{pos:c}=this;r[c++]=128,this.buffer.subarray(c).fill(0),this.padOffset>i-c&&(this.process(n,0),c=0);for(let x=c;x<i;x++)r[x]=0;zl(n,i-8,BigInt(this.length*8),s),this.process(n,0);const u=Ms(e),l=this.outputLen;if(l%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const p=l/4,b=this.get();if(p>b.length)throw new Error("_sha2: outputLen bigger than state");for(let x=0;x<p;x++)u.setUint32(4*x,b[x],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:n,length:i,finished:s,destroyed:c,pos:u}=this;return e.length=i,e.pos=u,e.finished=s,e.destroyed=c,i%r&&e.buffer.set(n),e}}const Zl=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Dt=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),er=new Uint32Array(64);class Gc extends $c{constructor(){super(64,32,8,!1),this.A=Dt[0]|0,this.B=Dt[1]|0,this.C=Dt[2]|0,this.D=Dt[3]|0,this.E=Dt[4]|0,this.F=Dt[5]|0,this.G=Dt[6]|0,this.H=Dt[7]|0}get(){const{A:e,B:r,C:n,D:i,E:s,F:c,G:u,H:l}=this;return[e,r,n,i,s,c,u,l]}set(e,r,n,i,s,c,u,l){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=s|0,this.F=c|0,this.G=u|0,this.H=l|0}process(e,r){for(let x=0;x<16;x++,r+=4)er[x]=e.getUint32(r,!1);for(let x=16;x<64;x++){const _=er[x-15],v=er[x-2],d=Ot(_,7)^Ot(_,18)^_>>>3,A=Ot(v,17)^Ot(v,19)^v>>>10;er[x]=A+er[x-7]+d+er[x-16]|0}let{A:n,B:i,C:s,D:c,E:u,F:l,G:p,H:b}=this;for(let x=0;x<64;x++){const _=Ot(u,6)^Ot(u,11)^Ot(u,25),v=b+_+Wl(u,l,p)+Zl[x]+er[x]|0,A=(Ot(n,2)^Ot(n,13)^Ot(n,22))+Yl(n,i,s)|0;b=p,p=l,l=u,u=c+v|0,c=s,s=i,i=n,n=v+A|0}n=n+this.A|0,i=i+this.B|0,s=s+this.C|0,c=c+this.D|0,u=u+this.E|0,l=l+this.F|0,p=p+this.G|0,b=b+this.H|0,this.set(n,i,s,c,u,l,p,b)}roundClean(){er.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}class Xl extends Gc{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}}const Ma=Ca(()=>new Gc),Jl=Ca(()=>new Xl);function Ql(t){return Jl.create().update(new Uint8Array(t)).digest()}const Qn="__principal__",Ll=2,mo=4,Dl="aaaaa-aa",ed=t=>{var e;return new Uint8Array(((e=t.match(/.{1,2}/g))!==null&&e!==void 0?e:[]).map(r=>parseInt(r,16)))},td=t=>t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),"");let ye=class hi{constructor(e){this._arr=e,this._isPrincipal=!0}static anonymous(){return new this(new Uint8Array([mo]))}static managementCanister(){return this.fromHex(Dl)}static selfAuthenticating(e){const r=Ql(e);return new this(new Uint8Array([...r,Ll]))}static from(e){if(typeof e=="string")return hi.fromText(e);if(Object.getPrototypeOf(e)===Uint8Array.prototype)return new hi(e);if(typeof e=="object"&&e!==null&&e._isPrincipal===!0)return new hi(e._arr);throw new Error(`Impossible to convert ${JSON.stringify(e)} to Principal.`)}static fromHex(e){return new this(ed(e))}static fromText(e){let r=e;if(e.includes(Qn)){const c=JSON.parse(e);Qn in c&&(r=c[Qn])}const n=r.toLowerCase().replace(/-/g,"");let i=$l(n);i=i.slice(4,i.length);const s=new this(i);if(s.toText()!==r)throw new Error(`Principal "${s.toText()}" does not have a valid checksum (original value "${r}" may not be a valid Principal ID).`);return s}static fromUint8Array(e){return new this(e)}isAnonymous(){return this._arr.byteLength===1&&this._arr[0]===mo}toUint8Array(){return this._arr}toHex(){return td(this._arr).toUpperCase()}toText(){const e=new ArrayBuffer(4);new DataView(e).setUint32(0,Vl(this._arr));const n=new Uint8Array(e),i=Uint8Array.from(this._arr),s=new Uint8Array([...n,...i]),u=Ml(s).match(/.{1,5}/g);if(!u)throw new Error;return u.join("-")}toString(){return this.toText()}toJSON(){return{[Qn]:this.toText()}}compareTo(e){for(let r=0;r<Math.min(this._arr.length,e._arr.length);r++){if(this._arr[r]<e._arr[r])return"lt";if(this._arr[r]>e._arr[r])return"gt"}return this._arr.length<e._arr.length?"lt":this._arr.length>e._arr.length?"gt":"eq"}ltEq(e){const r=this.compareTo(e);return r=="lt"||r=="eq"}gtEq(e){const r=this.compareTo(e);return r=="gt"||r=="eq"}};function Nt(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e.buffer}function Re(t){return[...new Uint8Array(t)].map(e=>e.toString(16).padStart(2,"0")).join("")}const rd=new RegExp(/^[0-9a-fA-F]+$/);function Qt(t){if(!rd.test(t))throw new Error("Invalid hexadecimal string.");const e=[...t].reduce((r,n,i)=>(r[i/2|0]=(r[i/2|0]||"")+n,r),[]).map(r=>Number.parseInt(r,16));return new Uint8Array(e).buffer}function Vc(t,e){if(t.byteLength!==e.byteLength)return t.byteLength-e.byteLength;const r=new Uint8Array(t),n=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]!==n[i])return r[i]-n[i];return 0}function Gn(t,e){return Vc(t,e)===0}function Nn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function $a(t){return t instanceof Uint8Array?Nn(t):t instanceof ArrayBuffer?t:Array.isArray(t)?Nn(new Uint8Array(t)):"buffer"in t?$a(t.buffer):Nn(new Uint8Array(t))}class Pe extends Error{constructor(e){super(e),this.message=e,this.name="AgentError",this.__proto__=Pe.prototype,Object.setPrototypeOf(this,Pe.prototype)}}function Ee(...t){const e=new Uint8Array(t.reduce((n,i)=>n+i.byteLength,0));let r=0;for(const n of t)e.set(new Uint8Array(n),r),r+=n.byteLength;return e}class nn{constructor(e,r=e?.byteLength||0){this._buffer=Ki(e||new ArrayBuffer(0)),this._view=new Uint8Array(this._buffer,0,r)}get buffer(){return Ki(this._view.slice())}get byteLength(){return this._view.byteLength}read(e){const r=this._view.subarray(0,e);return this._view=this._view.subarray(e),r.slice().buffer}readUint8(){const e=this._view[0];return this._view=this._view.subarray(1),e}write(e){const r=new Uint8Array(e),n=this._view.byteLength;this._view.byteOffset+this._view.byteLength+r.byteLength>=this._buffer.byteLength?this.alloc(r.byteLength):this._view=new Uint8Array(this._buffer,this._view.byteOffset,this._view.byteLength+r.byteLength),this._view.set(r,n)}get end(){return this._view.byteLength===0}alloc(e){const r=new ArrayBuffer((this._buffer.byteLength+e)*1.2|0),n=new Uint8Array(r,0,this._view.byteLength+e);n.set(this._view),this._buffer=r,this._view=n}}function $s(t){return new DataView(t.buffer,t.byteOffset,t.byteLength).buffer}function Ki(t){return t instanceof Uint8Array?$s(t):t instanceof ArrayBuffer?t:Array.isArray(t)?$s(new Uint8Array(t)):"buffer"in t?Ki(t.buffer):$s(new Uint8Array(t))}function nd(t){const r=new TextEncoder().encode(t);let n=0;for(const i of r)n=(n*223+i)%2**32;return n}function $t(t){if(/^_\d+_$/.test(t)||/^_0x[0-9a-fA-F]+_$/.test(t)){const e=+t.slice(1,-1);if(Number.isSafeInteger(e)&&e>=0&&e<2**32)return e}return nd(t)}function qc(){throw new Error("unexpected end of buffer")}function Or(t,e){return t.byteLength<e&&qc(),t.read(e)}function Ur(t){const e=t.readUint8();return e===void 0&&qc(),e}function Ie(t){if(typeof t=="number"&&(t=BigInt(t)),t<BigInt(0))throw new Error("Cannot leb encode negative values.");const e=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,r=new nn(new ArrayBuffer(e),0);for(;;){const n=Number(t&BigInt(127));if(t/=BigInt(128),t===BigInt(0)){r.write(new Uint8Array([n]));break}else r.write(new Uint8Array([n|128]))}return r.buffer}function Ke(t){let e=BigInt(1),r=BigInt(0),n;do n=Ur(t),r+=BigInt(n&127).valueOf()*e,e*=BigInt(128);while(n>=128);return r}function qe(t){typeof t=="number"&&(t=BigInt(t));const e=t<BigInt(0);e&&(t=-t-BigInt(1));const r=(t===BigInt(0)?0:Math.ceil(Math.log2(Number(t))))+1,n=new nn(new ArrayBuffer(r),0);for(;;){const s=i(t);if(t/=BigInt(128),e&&t===BigInt(0)&&s&64||!e&&t===BigInt(0)&&!(s&64)){n.write(new Uint8Array([s]));break}else n.write(new Uint8Array([s|128]))}function i(s){const c=s%BigInt(128);return Number(e?BigInt(128)-c-BigInt(1):c)}return n.buffer}function ir(t){const e=new Uint8Array(t.buffer);let r=0;for(;r<e.byteLength;r++)if(e[r]<128){if(!(e[r]&64))return Ke(t);break}const n=new Uint8Array(Or(t,r+1));let i=BigInt(0);for(let s=n.byteLength-1;s>=0;s--)i=i*BigInt(128)+BigInt(128-(n[s]&127)-1);return-i-BigInt(1)}function id(t,e){if(BigInt(t)<BigInt(0))throw new Error("Cannot write negative values.");return Hc(t,e)}function Hc(t,e){t=BigInt(t);const r=new nn(new ArrayBuffer(Math.min(1,e)),0);let n=0,i=BigInt(256),s=BigInt(0),c=Number(t%i);for(r.write(new Uint8Array([c]));++n<e;)t<0&&s===BigInt(0)&&c!==0&&(s=BigInt(1)),c=Number((t/i-s)%BigInt(256)),r.write(new Uint8Array([c])),i*=BigInt(256);return r.buffer}function jc(t,e){let r=BigInt(Ur(t)),n=BigInt(1),i=0;for(;++i<e;){n*=BigInt(256);const s=BigInt(Ur(t));r=r+n*s}return r}function sd(t,e){let r=jc(t,e);const n=BigInt(2)**(BigInt(8)*BigInt(e-1)+BigInt(7));return r>=n&&(r-=n*BigInt(2)),r}function la(t){const e=BigInt(t);if(t<0)throw new RangeError("Input must be non-negative");return BigInt(1)<<e}const pi="DIDL",_o=400;function Fn(t,e,r){return t.map((n,i)=>r(n,e[i]))}class ad{constructor(){this._typs=[],this._idx=new Map}has(e){return this._idx.has(e.name)}add(e,r){const n=this._typs.length;this._idx.set(e.name,n),this._typs.push(r)}merge(e,r){const n=this._idx.get(e.name),i=this._idx.get(r);if(n===void 0)throw new Error("Missing type index for "+e);if(i===void 0)throw new Error("Missing type index for "+r);this._typs[n]=this._typs[i],this._typs.splice(i,1),this._idx.delete(r)}encode(){const e=Ie(this._typs.length),r=Ee(...this._typs);return Ee(e,r)}indexOf(e){if(!this._idx.has(e))throw new Error("Missing type index for "+e);return qe(this._idx.get(e)||0)}}class od{visitType(e,r){throw new Error("Not implemented")}visitPrimitive(e,r){return this.visitType(e,r)}visitEmpty(e,r){return this.visitPrimitive(e,r)}visitBool(e,r){return this.visitPrimitive(e,r)}visitNull(e,r){return this.visitPrimitive(e,r)}visitReserved(e,r){return this.visitPrimitive(e,r)}visitText(e,r){return this.visitPrimitive(e,r)}visitNumber(e,r){return this.visitPrimitive(e,r)}visitInt(e,r){return this.visitNumber(e,r)}visitNat(e,r){return this.visitNumber(e,r)}visitFloat(e,r){return this.visitPrimitive(e,r)}visitFixedInt(e,r){return this.visitNumber(e,r)}visitFixedNat(e,r){return this.visitNumber(e,r)}visitPrincipal(e,r){return this.visitPrimitive(e,r)}visitConstruct(e,r){return this.visitType(e,r)}visitVec(e,r,n){return this.visitConstruct(e,n)}visitOpt(e,r,n){return this.visitConstruct(e,n)}visitRecord(e,r,n){return this.visitConstruct(e,n)}visitTuple(e,r,n){const i=r.map((s,c)=>[`_${c}_`,s]);return this.visitRecord(e,i,n)}visitVariant(e,r,n){return this.visitConstruct(e,n)}visitRec(e,r,n){return this.visitConstruct(r,n)}visitFunc(e,r){return this.visitConstruct(e,r)}visitService(e,r){return this.visitConstruct(e,r)}}class us{display(){return this.name}valueToString(e){return Me(e)}buildTypeTable(e){e.has(this)||this._buildTypeTableImpl(e)}}class wt extends us{checkType(e){if(this.name!==e.name)throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`);return e}_buildTypeTableImpl(e){}}class mr extends us{checkType(e){if(e instanceof _r){const r=e.getType();if(typeof r>"u")throw new Error("type mismatch with uninitialized type");return r}throw new Error(`type mismatch: type on the wire ${e.name}, expect type ${this.name}`)}encodeType(e){return e.indexOf(this.name)}}class Kc extends wt{accept(e,r){return e.visitEmpty(this,r)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(){throw new Error("Empty cannot appear as a function argument")}valueToString(){throw new Error("Empty cannot appear as a value")}encodeType(){return qe(-17)}decodeValue(){throw new Error("Empty cannot appear as an output")}get name(){return"empty"}}class zc extends us{checkType(e){throw new Error("Method not implemented for unknown.")}accept(e,r){throw e.visitType(this,r)}covariant(e){throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(){throw new Error("Unknown cannot appear as a function argument")}valueToString(){throw new Error("Unknown cannot appear as a value")}encodeType(){throw new Error("Unknown cannot be serialized")}decodeValue(e,r){let n=r.decodeValue(e,r);Object(n)!==n&&(n=Object(n));let i;return r instanceof _r?i=()=>r.getType():i=()=>r,Object.defineProperty(n,"type",{value:i,writable:!0,enumerable:!1,configurable:!0}),n}_buildTypeTableImpl(){throw new Error("Unknown cannot be serialized")}get name(){return"Unknown"}}class Wc extends wt{accept(e,r){return e.visitBool(this,r)}covariant(e){if(typeof e=="boolean")return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){return new Uint8Array([e?1:0])}encodeType(){return qe(-2)}decodeValue(e,r){switch(this.checkType(r),Ur(e)){case 0:return!1;case 1:return!0;default:throw new Error("Boolean value out of range")}}get name(){return"bool"}}class Yc extends wt{accept(e,r){return e.visitNull(this,r)}covariant(e){if(e===null)return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(){return new ArrayBuffer(0)}encodeType(){return qe(-1)}decodeValue(e,r){return this.checkType(r),null}get name(){return"null"}}class zi extends wt{accept(e,r){return e.visitReserved(this,r)}covariant(e){return!0}encodeValue(){return new ArrayBuffer(0)}encodeType(){return qe(-16)}decodeValue(e,r){return r.name!==this.name&&r.decodeValue(e,r),null}get name(){return"reserved"}}class Zc extends wt{accept(e,r){return e.visitText(this,r)}covariant(e){if(typeof e=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){const r=new TextEncoder().encode(e),n=Ie(r.byteLength);return Ee(n,r)}encodeType(){return qe(-15)}decodeValue(e,r){this.checkType(r);const n=Ke(e),i=Or(e,Number(n));return new TextDecoder("utf8",{fatal:!0}).decode(i)}get name(){return"text"}valueToString(e){return'"'+e+'"'}}class Xc extends wt{accept(e,r){return e.visitInt(this,r)}covariant(e){if(typeof e=="bigint"||Number.isInteger(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){return qe(e)}encodeType(){return qe(-4)}decodeValue(e,r){return this.checkType(r),ir(e)}get name(){return"int"}valueToString(e){return e.toString()}}class Jc extends wt{accept(e,r){return e.visitNat(this,r)}covariant(e){if(typeof e=="bigint"&&e>=BigInt(0)||Number.isInteger(e)&&e>=0)return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){return Ie(e)}encodeType(){return qe(-3)}decodeValue(e,r){return this.checkType(r),Ke(e)}get name(){return"nat"}valueToString(e){return e.toString()}}class Ga extends wt{constructor(e){if(super(),this._bits=e,e!==32&&e!==64)throw new Error("not a valid float type")}accept(e,r){return e.visitFloat(this,r)}covariant(e){if(typeof e=="number"||e instanceof Number)return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){const r=new ArrayBuffer(this._bits/8),n=new DataView(r);return this._bits===32?n.setFloat32(0,e,!0):n.setFloat64(0,e,!0),r}encodeType(){const e=this._bits===32?-13:-14;return qe(e)}decodeValue(e,r){this.checkType(r);const n=Or(e,this._bits/8),i=new DataView(n);return this._bits===32?i.getFloat32(0,!0):i.getFloat64(0,!0)}get name(){return"float"+this._bits}valueToString(e){return e.toString()}}class Fr extends wt{constructor(e){super(),this._bits=e}accept(e,r){return e.visitFixedInt(this,r)}covariant(e){const r=la(this._bits-1)*BigInt(-1),n=la(this._bits-1)-BigInt(1);let i=!1;if(typeof e=="bigint")i=e>=r&&e<=n;else if(Number.isInteger(e)){const s=BigInt(e);i=s>=r&&s<=n}else i=!1;if(i)return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){return Hc(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return qe(-9-e)}decodeValue(e,r){this.checkType(r);const n=sd(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`int${this._bits}`}valueToString(e){return e.toString()}}class yr extends wt{constructor(e){super(),this._bits=e}accept(e,r){return e.visitFixedNat(this,r)}covariant(e){const r=la(this._bits);let n=!1;if(typeof e=="bigint"&&e>=BigInt(0)?n=e<r:Number.isInteger(e)&&e>=0?n=BigInt(e)<r:n=!1,n)return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){return id(e,this._bits/8)}encodeType(){const e=Math.log2(this._bits)-3;return qe(-5-e)}decodeValue(e,r){this.checkType(r);const n=jc(e,this._bits/8);return this._bits<=32?Number(n):n}get name(){return`nat${this._bits}`}valueToString(e){return e.toString()}}class fs extends mr{constructor(e){super(),this._type=e,this._blobOptimization=!1,e instanceof yr&&e._bits===8&&(this._blobOptimization=!0)}accept(e,r){return e.visitVec(this,this._type,r)}covariant(e){const r=this._type instanceof yr?this._type._bits:this._type instanceof Fr?this._type._bits:0;if(ArrayBuffer.isView(e)&&r==e.BYTES_PER_ELEMENT*8||Array.isArray(e)&&e.every((n,i)=>{try{return this._type.covariant(n)}catch(s){throw new Error(`Invalid ${this.display()} argument: 

index ${i} -> ${s.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){const r=Ie(e.length);if(this._blobOptimization)return Ee(r,new Uint8Array(e));if(ArrayBuffer.isView(e))return Ee(r,new Uint8Array(e.buffer));const n=new nn(new ArrayBuffer(r.byteLength+e.length),0);n.write(r);for(const i of e){const s=this._type.encodeValue(i);n.write(new Uint8Array(s))}return n.buffer}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const r=qe(-19),n=this._type.encodeType(e);e.add(this,Ee(r,n))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof fs))throw new Error("Not a vector type");const i=Number(Ke(e));if(this._type instanceof yr){if(this._type._bits==8)return new Uint8Array(e.read(i));if(this._type._bits==16)return new Uint16Array(e.read(i*2));if(this._type._bits==32)return new Uint32Array(e.read(i*4));if(this._type._bits==64)return new BigUint64Array(e.read(i*8))}if(this._type instanceof Fr){if(this._type._bits==8)return new Int8Array(e.read(i));if(this._type._bits==16)return new Int16Array(e.read(i*2));if(this._type._bits==32)return new Int32Array(e.read(i*4));if(this._type._bits==64)return new BigInt64Array(e.read(i*8))}const s=[];for(let c=0;c<i;c++)s.push(this._type.decodeValue(e,n._type));return s}get name(){return`vec ${this._type.name}`}display(){return`vec ${this._type.display()}`}valueToString(e){return"vec {"+e.map(n=>this._type.valueToString(n)).join("; ")+"}"}}class tn extends mr{constructor(e){super(),this._type=e}accept(e,r){return e.visitOpt(this,this._type,r)}covariant(e){try{if(Array.isArray(e)&&(e.length===0||e.length===1&&this._type.covariant(e[0])))return!0}catch(r){throw new Error(`Invalid ${this.display()} argument: ${Me(e)} 

-> ${r.message}`)}throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){return e.length===0?new Uint8Array([0]):Ee(new Uint8Array([1]),this._type.encodeValue(e[0]))}_buildTypeTableImpl(e){this._type.buildTypeTable(e);const r=qe(-18),n=this._type.encodeType(e);e.add(this,Ee(r,n))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof tn))throw new Error("Not an option type");switch(Ur(e)){case 0:return[];case 1:return[this._type.decodeValue(e,n._type)];default:throw new Error("Not an option value")}}get name(){return`opt ${this._type.name}`}display(){return`opt ${this._type.display()}`}valueToString(e){return e.length===0?"null":`opt ${this._type.valueToString(e[0])}`}}class Vn extends mr{constructor(e={}){super(),this._fields=Object.entries(e).sort((r,n)=>$t(r[0])-$t(n[0]))}accept(e,r){return e.visitRecord(this,this._fields,r)}tryAsTuple(){const e=[];for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(n!==`_${r}_`)return null;e.push(i)}return e}covariant(e){if(typeof e=="object"&&this._fields.every(([r,n])=>{if(!e.hasOwnProperty(r))throw new Error(`Record is missing key "${r}".`);try{return n.covariant(e[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

field ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){const r=this._fields.map(([i])=>e[i]),n=Fn(this._fields,r,([,i],s)=>i.encodeValue(s));return Ee(...n)}_buildTypeTableImpl(e){this._fields.forEach(([s,c])=>c.buildTypeTable(e));const r=qe(-20),n=Ie(this._fields.length),i=this._fields.map(([s,c])=>Ee(Ie($t(s)),c.encodeType(e)));e.add(this,Ee(r,n,Ee(...i)))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof Vn))throw new Error("Not a record type");const i={};let s=0,c=0;for(;c<n._fields.length;){const[u,l]=n._fields[c];if(s>=this._fields.length){l.decodeValue(e,l),c++;continue}const[p,b]=this._fields[s],x=$t(this._fields[s][0]),_=$t(u);if(x===_)i[p]=b.decodeValue(e,l),s++,c++;else if(_>x)if(b instanceof tn||b instanceof zi)i[p]=[],s++;else throw new Error("Cannot find required field "+p);else l.decodeValue(e,l),c++}for(const[u,l]of this._fields.slice(s))if(l instanceof tn||l instanceof zi)i[u]=[];else throw new Error("Cannot find required field "+u);return i}get name(){return`record {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`record {${this._fields.map(([r,n])=>r+":"+n.display()).join("; ")}}`}valueToString(e){const r=this._fields.map(([i])=>e[i]);return`record {${Fn(this._fields,r,([i,s],c)=>i+"="+s.valueToString(c)).join("; ")}}`}}class ls extends Vn{constructor(e){const r={};e.forEach((n,i)=>r["_"+i+"_"]=n),super(r),this._components=e}accept(e,r){return e.visitTuple(this,this._components,r)}covariant(e){if(Array.isArray(e)&&e.length>=this._fields.length&&this._components.every((r,n)=>{try{return r.covariant(e[n])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

index ${n} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){const r=Fn(this._components,e,(n,i)=>n.encodeValue(i));return Ee(...r)}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof ls))throw new Error("not a tuple type");if(n._components.length<this._components.length)throw new Error("tuple mismatch");const i=[];for(const[s,c]of n._components.entries())s>=this._components.length?c.decodeValue(e,c):i.push(this._components[s].decodeValue(e,c));return i}display(){return`record {${this._components.map(r=>r.display()).join("; ")}}`}valueToString(e){return`record {${Fn(this._components,e,(n,i)=>n.valueToString(i)).join("; ")}}`}}class ds extends mr{constructor(e={}){super(),this._fields=Object.entries(e).sort((r,n)=>$t(r[0])-$t(n[0]))}accept(e,r){return e.visitVariant(this,this._fields,r)}covariant(e){if(typeof e=="object"&&Object.entries(e).length===1&&this._fields.every(([r,n])=>{try{return!e.hasOwnProperty(r)||n.covariant(e[r])}catch(i){throw new Error(`Invalid ${this.display()} argument: 

variant ${r} -> ${i.message}`)}}))return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){for(let r=0;r<this._fields.length;r++){const[n,i]=this._fields[r];if(e.hasOwnProperty(n)){const s=Ie(r),c=i.encodeValue(e[n]);return Ee(s,c)}}throw Error("Variant has no data: "+e)}_buildTypeTableImpl(e){this._fields.forEach(([,s])=>{s.buildTypeTable(e)});const r=qe(-21),n=Ie(this._fields.length),i=this._fields.map(([s,c])=>Ee(Ie($t(s)),c.encodeType(e)));e.add(this,Ee(r,n,...i))}decodeValue(e,r){const n=this.checkType(r);if(!(n instanceof ds))throw new Error("Not a variant type");const i=Number(Ke(e));if(i>=n._fields.length)throw Error("Invalid variant index: "+i);const[s,c]=n._fields[i];for(const[u,l]of this._fields)if($t(s)===$t(u)){const p=l.decodeValue(e,c);return{[u]:p}}throw new Error("Cannot find field hash "+s)}get name(){return`variant {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}display(){return`variant {${this._fields.map(([r,n])=>r+(n.name==="null"?"":`:${n.display()}`)).join("; ")}}`}valueToString(e){for(const[r,n]of this._fields)if(e.hasOwnProperty(r)){const i=n.valueToString(e[r]);return i==="null"?`variant {${r}}`:`variant {${r}=${i}}`}throw new Error("Variant has no data: "+e)}}class _r extends mr{constructor(){super(...arguments),this._id=_r._counter++,this._type=void 0}accept(e,r){if(!this._type)throw Error("Recursive type uninitialized.");return e.visitRec(this,this._type,r)}fill(e){this._type=e}getType(){return this._type}covariant(e){if(this._type&&this._type.covariant(e))return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.encodeValue(e)}_buildTypeTableImpl(e){if(!this._type)throw Error("Recursive type uninitialized.");e.add(this,new Uint8Array([])),this._type.buildTypeTable(e),e.merge(this,this._type.name)}decodeValue(e,r){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.decodeValue(e,r)}get name(){return`rec_${this._id}`}display(){if(!this._type)throw Error("Recursive type uninitialized.");return`μ${this.name}.${this._type.name}`}valueToString(e){if(!this._type)throw Error("Recursive type uninitialized.");return this._type.valueToString(e)}}_r._counter=0;function Va(t){if(Ur(t)!==1)throw new Error("Cannot decode principal");const r=Number(Ke(t));return ye.fromUint8Array(new Uint8Array(Or(t,r)))}class Qc extends wt{accept(e,r){return e.visitPrincipal(this,r)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){const r=e.toUint8Array(),n=Ie(r.byteLength);return Ee(new Uint8Array([1]),n,r)}encodeType(){return qe(-24)}decodeValue(e,r){return this.checkType(r),Va(e)}get name(){return"principal"}valueToString(e){return`${this.name} "${e.toText()}"`}}class qa extends mr{constructor(e,r,n=[]){super(),this.argTypes=e,this.retTypes=r,this.annotations=n}static argsToString(e,r){if(e.length!==r.length)throw new Error("arity mismatch");return"("+e.map((n,i)=>n.valueToString(r[i])).join(", ")+")"}accept(e,r){return e.visitFunc(this,r)}covariant(e){if(Array.isArray(e)&&e.length===2&&e[0]&&e[0]._isPrincipal&&typeof e[1]=="string")return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue([e,r]){const n=e.toUint8Array(),i=Ie(n.byteLength),s=Ee(new Uint8Array([1]),i,n),c=new TextEncoder().encode(r),u=Ie(c.byteLength);return Ee(new Uint8Array([1]),s,u,c)}_buildTypeTableImpl(e){this.argTypes.forEach(p=>p.buildTypeTable(e)),this.retTypes.forEach(p=>p.buildTypeTable(e));const r=qe(-22),n=Ie(this.argTypes.length),i=Ee(...this.argTypes.map(p=>p.encodeType(e))),s=Ie(this.retTypes.length),c=Ee(...this.retTypes.map(p=>p.encodeType(e))),u=Ie(this.annotations.length),l=Ee(...this.annotations.map(p=>this.encodeAnnotation(p)));e.add(this,Ee(r,n,i,s,c,u,l))}decodeValue(e){if(Ur(e)!==1)throw new Error("Cannot decode function reference");const n=Va(e),i=Number(Ke(e)),s=Or(e,i),u=new TextDecoder("utf8",{fatal:!0}).decode(s);return[n,u]}get name(){const e=this.argTypes.map(i=>i.name).join(", "),r=this.retTypes.map(i=>i.name).join(", "),n=" "+this.annotations.join(" ");return`(${e}) -> (${r})${n}`}valueToString([e,r]){return`func "${e.toText()}".${r}`}display(){const e=this.argTypes.map(i=>i.display()).join(", "),r=this.retTypes.map(i=>i.display()).join(", "),n=" "+this.annotations.join(" ");return`(${e}) → (${r})${n}`}encodeAnnotation(e){if(e==="query")return new Uint8Array([1]);if(e==="oneway")return new Uint8Array([2]);if(e==="composite_query")return new Uint8Array([3]);throw new Error("Illegal function annotation")}}class Lc extends mr{constructor(e){super(),this._fields=Object.entries(e).sort((r,n)=>r[0]<n[0]?-1:r[0]>n[0]?1:0)}accept(e,r){return e.visitService(this,r)}covariant(e){if(e&&e._isPrincipal)return!0;throw new Error(`Invalid ${this.display()} argument: ${Me(e)}`)}encodeValue(e){const r=e.toUint8Array(),n=Ie(r.length);return Ee(new Uint8Array([1]),n,r)}_buildTypeTableImpl(e){this._fields.forEach(([s,c])=>c.buildTypeTable(e));const r=qe(-23),n=Ie(this._fields.length),i=this._fields.map(([s,c])=>{const u=new TextEncoder().encode(s),l=Ie(u.length);return Ee(l,u,c.encodeType(e))});e.add(this,Ee(r,n,...i))}decodeValue(e){return Va(e)}get name(){return`service {${this._fields.map(([r,n])=>r+":"+n.name).join("; ")}}`}valueToString(e){return`service "${e.toText()}"`}}function Me(t){const e=JSON.stringify(t,(r,n)=>typeof n=="bigint"?`BigInt(${n})`:n);return e&&e.length>_o?e.substring(0,_o-3)+"...":e}function da(t,e){if(e.length<t.length)throw Error("Wrong number of message arguments");const r=new ad;t.forEach(l=>l.buildTypeTable(r));const n=new TextEncoder().encode(pi),i=r.encode(),s=Ie(e.length),c=Ee(...t.map(l=>l.encodeType(r))),u=Ee(...Fn(t,e,(l,p)=>{try{l.covariant(p)}catch(b){throw new Error(b.message+`

`)}return l.encodeValue(p)}));return Ee(n,i,s,c,u)}function Dc(t,e){const r=new nn(e);if(e.byteLength<pi.length)throw new Error("Message length smaller than magic number");const n=Or(r,pi.length),i=new TextDecoder().decode(n);if(i!==pi)throw new Error("Wrong magic number: "+JSON.stringify(i));function s(v){const d=[],A=Number(Ke(v));for(let I=0;I<A;I++){const R=Number(ir(v));switch(R){case-18:case-19:{const H=Number(ir(v));d.push([R,H]);break}case-20:case-21:{const H=[];let B=Number(Ke(v)),j;for(;B--;){const V=Number(Ke(v));if(V>=Math.pow(2,32))throw new Error("field id out of 32-bit range");if(typeof j=="number"&&j>=V)throw new Error("field id collision or not sorted");j=V;const K=Number(ir(v));H.push([V,K])}d.push([R,H]);break}case-22:{const H=[];let B=Number(Ke(v));for(;B--;)H.push(Number(ir(v)));const j=[];let V=Number(Ke(v));for(;V--;)j.push(Number(ir(v)));const K=[];let Y=Number(Ke(v));for(;Y--;)switch(Number(Ke(v))){case 1:{K.push("query");break}case 2:{K.push("oneway");break}case 3:{K.push("composite_query");break}default:throw new Error("unknown annotation")}d.push([R,[H,j,K]]);break}case-23:{let H=Number(Ke(v));const B=[];for(;H--;){const j=Number(Ke(v)),V=new TextDecoder().decode(Or(v,j)),K=ir(v);B.push([V,K])}d.push([R,B]);break}default:throw new Error("Illegal op_code: "+R)}}const S=[],P=Number(Ke(v));for(let I=0;I<P;I++)S.push(Number(ir(v)));return[d,S]}const[c,u]=s(r);if(u.length<t.length)throw new Error("Wrong number of return values");const l=c.map(v=>Eu());function p(v){if(v<-24)throw new Error("future value not supported");if(v<0)switch(v){case-1:return nu;case-2:return ru;case-3:return au;case-4:return su;case-5:return hu;case-6:return pu;case-7:return gu;case-8:return yu;case-9:return uu;case-10:return fu;case-11:return lu;case-12:return du;case-13:return ou;case-14:return cu;case-15:return iu;case-16:return tu;case-17:return eu;case-24:return wu;default:throw new Error("Illegal op_code: "+v)}if(v>=c.length)throw new Error("type index out of range");return l[v]}function b(v){switch(v[0]){case-19:{const d=p(v[1]);return mu(d)}case-18:{const d=p(v[1]);return _u(d)}case-20:{const d={};for(const[P,I]of v[1]){const R=`_${P}_`;d[R]=p(I)}const A=vu(d),S=A.tryAsTuple();return Array.isArray(S)?bu(...S):A}case-21:{const d={};for(const[A,S]of v[1]){const P=`_${A}_`;d[P]=p(S)}return xu(d)}case-22:{const[d,A,S]=v[1];return Tu(d.map(P=>p(P)),A.map(P=>p(P)),S)}case-23:{const d={},A=v[1];for(const[S,P]of A){let I=p(P);if(I instanceof _r&&(I=I.getType()),!(I instanceof qa))throw new Error("Illegal service definition: services can only contain functions");d[S]=I}return Su(d)}default:throw new Error("Illegal op_code: "+v[0])}}c.forEach((v,d)=>{if(v[0]===-22){const A=b(v);l[d].fill(A)}}),c.forEach((v,d)=>{if(v[0]!==-22){const A=b(v);l[d].fill(A)}});const x=u.map(v=>p(v)),_=t.map((v,d)=>v.decodeValue(r,x[d]));for(let v=t.length;v<x.length;v++)x[v].decodeValue(r,x[v]);if(r.byteLength>0)throw new Error("decode: Left-over bytes");return _}const eu=new Kc,tu=new zi,cd=new zc,ru=new Wc,nu=new Yc,iu=new Zc,su=new Xc,au=new Jc,ou=new Ga(32),cu=new Ga(64),uu=new Fr(8),fu=new Fr(16),lu=new Fr(32),du=new Fr(64),hu=new yr(8),pu=new yr(16),gu=new yr(32),yu=new yr(64),wu=new Qc;function bu(...t){return new ls(t)}function mu(t){return new fs(t)}function _u(t){return new tn(t)}function vu(t){return new Vn(t)}function xu(t){return new ds(t)}function Eu(){return new _r}function Tu(t,e,r=[]){return new qa(t,e,r)}function Su(t){return new Lc(t)}const ud=Object.freeze(Object.defineProperty({__proto__:null,Bool:ru,BoolClass:Wc,ConstructType:mr,Empty:eu,EmptyClass:Kc,FixedIntClass:Fr,FixedNatClass:yr,Float32:ou,Float64:cu,FloatClass:Ga,Func:Tu,FuncClass:qa,Int:su,Int16:fu,Int32:lu,Int64:du,Int8:uu,IntClass:Xc,Nat:au,Nat16:pu,Nat32:gu,Nat64:yu,Nat8:hu,NatClass:Jc,Null:nu,NullClass:Yc,Opt:_u,OptClass:tn,PrimitiveType:wt,Principal:wu,PrincipalClass:Qc,Rec:Eu,RecClass:_r,Record:vu,RecordClass:Vn,Reserved:tu,ReservedClass:zi,Service:Su,ServiceClass:Lc,Text:iu,TextClass:Zc,Tuple:bu,TupleClass:ls,Type:us,Unknown:cd,UnknownClass:zc,Variant:xu,VariantClass:ds,Vec:mu,VecClass:fs,Visitor:od,decode:Dc,encode:da},Symbol.toStringTag,{value:"Module"}));var Au={},qn={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){var e=ml,r=Nc,n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=u,t.SlowBuffer=I,t.INSPECT_MAX_BYTES=50;var i=2147483647;t.kMaxLength=i,u.TYPED_ARRAY_SUPPORT=s(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{var f=new Uint8Array(1),a={foo:function(){return 42}};return Object.setPrototypeOf(a,Uint8Array.prototype),Object.setPrototypeOf(f,a),f.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(f){if(f>i)throw new RangeError('The value "'+f+'" is invalid for option "size"');var a=new Uint8Array(f);return Object.setPrototypeOf(a,u.prototype),a}function u(f,a,o){if(typeof f=="number"){if(typeof a=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return x(f)}return l(f,a,o)}u.poolSize=8192;function l(f,a,o){if(typeof f=="string")return _(f,a);if(ArrayBuffer.isView(f))return d(f);if(f==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f);if(k(f,ArrayBuffer)||f&&k(f.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(k(f,SharedArrayBuffer)||f&&k(f.buffer,SharedArrayBuffer)))return A(f,a,o);if(typeof f=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var h=f.valueOf&&f.valueOf();if(h!=null&&h!==f)return u.from(h,a,o);var w=S(f);if(w)return w;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof f[Symbol.toPrimitive]=="function")return u.from(f[Symbol.toPrimitive]("string"),a,o);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f)}u.from=function(f,a,o){return l(f,a,o)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function p(f){if(typeof f!="number")throw new TypeError('"size" argument must be of type number');if(f<0)throw new RangeError('The value "'+f+'" is invalid for option "size"')}function b(f,a,o){return p(f),f<=0?c(f):a!==void 0?typeof o=="string"?c(f).fill(a,o):c(f).fill(a):c(f)}u.alloc=function(f,a,o){return b(f,a,o)};function x(f){return p(f),c(f<0?0:P(f)|0)}u.allocUnsafe=function(f){return x(f)},u.allocUnsafeSlow=function(f){return x(f)};function _(f,a){if((typeof a!="string"||a==="")&&(a="utf8"),!u.isEncoding(a))throw new TypeError("Unknown encoding: "+a);var o=R(f,a)|0,h=c(o),w=h.write(f,a);return w!==o&&(h=h.slice(0,w)),h}function v(f){for(var a=f.length<0?0:P(f.length)|0,o=c(a),h=0;h<a;h+=1)o[h]=f[h]&255;return o}function d(f){if(k(f,Uint8Array)){var a=new Uint8Array(f);return A(a.buffer,a.byteOffset,a.byteLength)}return v(f)}function A(f,a,o){if(a<0||f.byteLength<a)throw new RangeError('"offset" is outside of buffer bounds');if(f.byteLength<a+(o||0))throw new RangeError('"length" is outside of buffer bounds');var h;return a===void 0&&o===void 0?h=new Uint8Array(f):o===void 0?h=new Uint8Array(f,a):h=new Uint8Array(f,a,o),Object.setPrototypeOf(h,u.prototype),h}function S(f){if(u.isBuffer(f)){var a=P(f.length)|0,o=c(a);return o.length===0||f.copy(o,0,0,a),o}if(f.length!==void 0)return typeof f.length!="number"||F(f.length)?c(0):v(f);if(f.type==="Buffer"&&Array.isArray(f.data))return v(f.data)}function P(f){if(f>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return f|0}function I(f){return+f!=f&&(f=0),u.alloc(+f)}u.isBuffer=function(a){return a!=null&&a._isBuffer===!0&&a!==u.prototype},u.compare=function(a,o){if(k(a,Uint8Array)&&(a=u.from(a,a.offset,a.byteLength)),k(o,Uint8Array)&&(o=u.from(o,o.offset,o.byteLength)),!u.isBuffer(a)||!u.isBuffer(o))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(a===o)return 0;for(var h=a.length,w=o.length,N=0,q=Math.min(h,w);N<q;++N)if(a[N]!==o[N]){h=a[N],w=o[N];break}return h<w?-1:w<h?1:0},u.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(a,o){if(!Array.isArray(a))throw new TypeError('"list" argument must be an Array of Buffers');if(a.length===0)return u.alloc(0);var h;if(o===void 0)for(o=0,h=0;h<a.length;++h)o+=a[h].length;var w=u.allocUnsafe(o),N=0;for(h=0;h<a.length;++h){var q=a[h];if(k(q,Uint8Array))N+q.length>w.length?u.from(q).copy(w,N):Uint8Array.prototype.set.call(w,q,N);else if(u.isBuffer(q))q.copy(w,N);else throw new TypeError('"list" argument must be an Array of Buffers');N+=q.length}return w};function R(f,a){if(u.isBuffer(f))return f.length;if(ArrayBuffer.isView(f)||k(f,ArrayBuffer))return f.byteLength;if(typeof f!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof f);var o=f.length,h=arguments.length>2&&arguments[2]===!0;if(!h&&o===0)return 0;for(var w=!1;;)switch(a){case"ascii":case"latin1":case"binary":return o;case"utf8":case"utf-8":return X(f).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return o*2;case"hex":return o>>>1;case"base64":return m(f).length;default:if(w)return h?-1:X(f).length;a=(""+a).toLowerCase(),w=!0}}u.byteLength=R;function H(f,a,o){var h=!1;if((a===void 0||a<0)&&(a=0),a>this.length||((o===void 0||o>this.length)&&(o=this.length),o<=0)||(o>>>=0,a>>>=0,o<=a))return"";for(f||(f="utf8");;)switch(f){case"hex":return J(this,a,o);case"utf8":case"utf-8":return U(this,a,o);case"ascii":return M(this,a,o);case"latin1":case"binary":return W(this,a,o);case"base64":return T(this,a,o);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,a,o);default:if(h)throw new TypeError("Unknown encoding: "+f);f=(f+"").toLowerCase(),h=!0}}u.prototype._isBuffer=!0;function B(f,a,o){var h=f[a];f[a]=f[o],f[o]=h}u.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var o=0;o<a;o+=2)B(this,o,o+1);return this},u.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var o=0;o<a;o+=4)B(this,o,o+3),B(this,o+1,o+2);return this},u.prototype.swap64=function(){var a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var o=0;o<a;o+=8)B(this,o,o+7),B(this,o+1,o+6),B(this,o+2,o+5),B(this,o+3,o+4);return this},u.prototype.toString=function(){var a=this.length;return a===0?"":arguments.length===0?U(this,0,a):H.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(a){if(!u.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:u.compare(this,a)===0},u.prototype.inspect=function(){var a="",o=t.INSPECT_MAX_BYTES;return a=this.toString("hex",0,o).replace(/(.{2})/g,"$1 ").trim(),this.length>o&&(a+=" ... "),"<Buffer "+a+">"},n&&(u.prototype[n]=u.prototype.inspect),u.prototype.compare=function(a,o,h,w,N){if(k(a,Uint8Array)&&(a=u.from(a,a.offset,a.byteLength)),!u.isBuffer(a))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof a);if(o===void 0&&(o=0),h===void 0&&(h=a?a.length:0),w===void 0&&(w=0),N===void 0&&(N=this.length),o<0||h>a.length||w<0||N>this.length)throw new RangeError("out of range index");if(w>=N&&o>=h)return 0;if(w>=N)return-1;if(o>=h)return 1;if(o>>>=0,h>>>=0,w>>>=0,N>>>=0,this===a)return 0;for(var q=N-w,Q=h-o,ce=Math.min(q,Q),de=this.slice(w,N),he=a.slice(o,h),ee=0;ee<ce;++ee)if(de[ee]!==he[ee]){q=de[ee],Q=he[ee];break}return q<Q?-1:Q<q?1:0};function j(f,a,o,h,w){if(f.length===0)return-1;if(typeof o=="string"?(h=o,o=0):o>2147483647?o=2147483647:o<-2147483648&&(o=-2147483648),o=+o,F(o)&&(o=w?0:f.length-1),o<0&&(o=f.length+o),o>=f.length){if(w)return-1;o=f.length-1}else if(o<0)if(w)o=0;else return-1;if(typeof a=="string"&&(a=u.from(a,h)),u.isBuffer(a))return a.length===0?-1:V(f,a,o,h,w);if(typeof a=="number")return a=a&255,typeof Uint8Array.prototype.indexOf=="function"?w?Uint8Array.prototype.indexOf.call(f,a,o):Uint8Array.prototype.lastIndexOf.call(f,a,o):V(f,[a],o,h,w);throw new TypeError("val must be string, number or Buffer")}function V(f,a,o,h,w){var N=1,q=f.length,Q=a.length;if(h!==void 0&&(h=String(h).toLowerCase(),h==="ucs2"||h==="ucs-2"||h==="utf16le"||h==="utf-16le")){if(f.length<2||a.length<2)return-1;N=2,q/=2,Q/=2,o/=2}function ce(Ne,et){return N===1?Ne[et]:Ne.readUInt16BE(et*N)}var de;if(w){var he=-1;for(de=o;de<q;de++)if(ce(f,de)===ce(a,he===-1?0:de-he)){if(he===-1&&(he=de),de-he+1===Q)return he*N}else he!==-1&&(de-=de-he),he=-1}else for(o+Q>q&&(o=q-Q),de=o;de>=0;de--){for(var ee=!0,pe=0;pe<Q;pe++)if(ce(f,de+pe)!==ce(a,pe)){ee=!1;break}if(ee)return de}return-1}u.prototype.includes=function(a,o,h){return this.indexOf(a,o,h)!==-1},u.prototype.indexOf=function(a,o,h){return j(this,a,o,h,!0)},u.prototype.lastIndexOf=function(a,o,h){return j(this,a,o,h,!1)};function K(f,a,o,h){o=Number(o)||0;var w=f.length-o;h?(h=Number(h),h>w&&(h=w)):h=w;var N=a.length;h>N/2&&(h=N/2);for(var q=0;q<h;++q){var Q=parseInt(a.substr(q*2,2),16);if(F(Q))return q;f[o+q]=Q}return q}function Y(f,a,o,h){return E(X(a,f.length-o),f,o,h)}function z(f,a,o,h){return E(te(a),f,o,h)}function ne(f,a,o,h){return E(m(a),f,o,h)}function D(f,a,o,h){return E(y(a,f.length-o),f,o,h)}u.prototype.write=function(a,o,h,w){if(o===void 0)w="utf8",h=this.length,o=0;else if(h===void 0&&typeof o=="string")w=o,h=this.length,o=0;else if(isFinite(o))o=o>>>0,isFinite(h)?(h=h>>>0,w===void 0&&(w="utf8")):(w=h,h=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var N=this.length-o;if((h===void 0||h>N)&&(h=N),a.length>0&&(h<0||o<0)||o>this.length)throw new RangeError("Attempt to write outside buffer bounds");w||(w="utf8");for(var q=!1;;)switch(w){case"hex":return K(this,a,o,h);case"utf8":case"utf-8":return Y(this,a,o,h);case"ascii":case"latin1":case"binary":return z(this,a,o,h);case"base64":return ne(this,a,o,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,a,o,h);default:if(q)throw new TypeError("Unknown encoding: "+w);w=(""+w).toLowerCase(),q=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function T(f,a,o){return a===0&&o===f.length?e.fromByteArray(f):e.fromByteArray(f.slice(a,o))}function U(f,a,o){o=Math.min(f.length,o);for(var h=[],w=a;w<o;){var N=f[w],q=null,Q=N>239?4:N>223?3:N>191?2:1;if(w+Q<=o){var ce,de,he,ee;switch(Q){case 1:N<128&&(q=N);break;case 2:ce=f[w+1],(ce&192)===128&&(ee=(N&31)<<6|ce&63,ee>127&&(q=ee));break;case 3:ce=f[w+1],de=f[w+2],(ce&192)===128&&(de&192)===128&&(ee=(N&15)<<12|(ce&63)<<6|de&63,ee>2047&&(ee<55296||ee>57343)&&(q=ee));break;case 4:ce=f[w+1],de=f[w+2],he=f[w+3],(ce&192)===128&&(de&192)===128&&(he&192)===128&&(ee=(N&15)<<18|(ce&63)<<12|(de&63)<<6|he&63,ee>65535&&ee<1114112&&(q=ee))}}q===null?(q=65533,Q=1):q>65535&&(q-=65536,h.push(q>>>10&1023|55296),q=56320|q&1023),h.push(q),w+=Q}return $(h)}var G=4096;function $(f){var a=f.length;if(a<=G)return String.fromCharCode.apply(String,f);for(var o="",h=0;h<a;)o+=String.fromCharCode.apply(String,f.slice(h,h+=G));return o}function M(f,a,o){var h="";o=Math.min(f.length,o);for(var w=a;w<o;++w)h+=String.fromCharCode(f[w]&127);return h}function W(f,a,o){var h="";o=Math.min(f.length,o);for(var w=a;w<o;++w)h+=String.fromCharCode(f[w]);return h}function J(f,a,o){var h=f.length;(!a||a<0)&&(a=0),(!o||o<0||o>h)&&(o=h);for(var w="",N=a;N<o;++N)w+=C[f[N]];return w}function oe(f,a,o){for(var h=f.slice(a,o),w="",N=0;N<h.length-1;N+=2)w+=String.fromCharCode(h[N]+h[N+1]*256);return w}u.prototype.slice=function(a,o){var h=this.length;a=~~a,o=o===void 0?h:~~o,a<0?(a+=h,a<0&&(a=0)):a>h&&(a=h),o<0?(o+=h,o<0&&(o=0)):o>h&&(o=h),o<a&&(o=a);var w=this.subarray(a,o);return Object.setPrototypeOf(w,u.prototype),w};function se(f,a,o){if(f%1!==0||f<0)throw new RangeError("offset is not uint");if(f+a>o)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(a,o,h){a=a>>>0,o=o>>>0,h||se(a,o,this.length);for(var w=this[a],N=1,q=0;++q<o&&(N*=256);)w+=this[a+q]*N;return w},u.prototype.readUintBE=u.prototype.readUIntBE=function(a,o,h){a=a>>>0,o=o>>>0,h||se(a,o,this.length);for(var w=this[a+--o],N=1;o>0&&(N*=256);)w+=this[a+--o]*N;return w},u.prototype.readUint8=u.prototype.readUInt8=function(a,o){return a=a>>>0,o||se(a,1,this.length),this[a]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(a,o){return a=a>>>0,o||se(a,2,this.length),this[a]|this[a+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(a,o){return a=a>>>0,o||se(a,2,this.length),this[a]<<8|this[a+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(a,o){return a=a>>>0,o||se(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+this[a+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(a,o){return a=a>>>0,o||se(a,4,this.length),this[a]*16777216+(this[a+1]<<16|this[a+2]<<8|this[a+3])},u.prototype.readIntLE=function(a,o,h){a=a>>>0,o=o>>>0,h||se(a,o,this.length);for(var w=this[a],N=1,q=0;++q<o&&(N*=256);)w+=this[a+q]*N;return N*=128,w>=N&&(w-=Math.pow(2,8*o)),w},u.prototype.readIntBE=function(a,o,h){a=a>>>0,o=o>>>0,h||se(a,o,this.length);for(var w=o,N=1,q=this[a+--w];w>0&&(N*=256);)q+=this[a+--w]*N;return N*=128,q>=N&&(q-=Math.pow(2,8*o)),q},u.prototype.readInt8=function(a,o){return a=a>>>0,o||se(a,1,this.length),this[a]&128?(255-this[a]+1)*-1:this[a]},u.prototype.readInt16LE=function(a,o){a=a>>>0,o||se(a,2,this.length);var h=this[a]|this[a+1]<<8;return h&32768?h|4294901760:h},u.prototype.readInt16BE=function(a,o){a=a>>>0,o||se(a,2,this.length);var h=this[a+1]|this[a]<<8;return h&32768?h|4294901760:h},u.prototype.readInt32LE=function(a,o){return a=a>>>0,o||se(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},u.prototype.readInt32BE=function(a,o){return a=a>>>0,o||se(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},u.prototype.readFloatLE=function(a,o){return a=a>>>0,o||se(a,4,this.length),r.read(this,a,!0,23,4)},u.prototype.readFloatBE=function(a,o){return a=a>>>0,o||se(a,4,this.length),r.read(this,a,!1,23,4)},u.prototype.readDoubleLE=function(a,o){return a=a>>>0,o||se(a,8,this.length),r.read(this,a,!0,52,8)},u.prototype.readDoubleBE=function(a,o){return a=a>>>0,o||se(a,8,this.length),r.read(this,a,!1,52,8)};function ue(f,a,o,h,w,N){if(!u.isBuffer(f))throw new TypeError('"buffer" argument must be a Buffer instance');if(a>w||a<N)throw new RangeError('"value" argument is out of bounds');if(o+h>f.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(a,o,h,w){if(a=+a,o=o>>>0,h=h>>>0,!w){var N=Math.pow(2,8*h)-1;ue(this,a,o,h,N,0)}var q=1,Q=0;for(this[o]=a&255;++Q<h&&(q*=256);)this[o+Q]=a/q&255;return o+h},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(a,o,h,w){if(a=+a,o=o>>>0,h=h>>>0,!w){var N=Math.pow(2,8*h)-1;ue(this,a,o,h,N,0)}var q=h-1,Q=1;for(this[o+q]=a&255;--q>=0&&(Q*=256);)this[o+q]=a/Q&255;return o+h},u.prototype.writeUint8=u.prototype.writeUInt8=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,1,255,0),this[o]=a&255,o+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,2,65535,0),this[o]=a&255,this[o+1]=a>>>8,o+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,2,65535,0),this[o]=a>>>8,this[o+1]=a&255,o+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,4,4294967295,0),this[o+3]=a>>>24,this[o+2]=a>>>16,this[o+1]=a>>>8,this[o]=a&255,o+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,4,4294967295,0),this[o]=a>>>24,this[o+1]=a>>>16,this[o+2]=a>>>8,this[o+3]=a&255,o+4},u.prototype.writeIntLE=function(a,o,h,w){if(a=+a,o=o>>>0,!w){var N=Math.pow(2,8*h-1);ue(this,a,o,h,N-1,-N)}var q=0,Q=1,ce=0;for(this[o]=a&255;++q<h&&(Q*=256);)a<0&&ce===0&&this[o+q-1]!==0&&(ce=1),this[o+q]=(a/Q>>0)-ce&255;return o+h},u.prototype.writeIntBE=function(a,o,h,w){if(a=+a,o=o>>>0,!w){var N=Math.pow(2,8*h-1);ue(this,a,o,h,N-1,-N)}var q=h-1,Q=1,ce=0;for(this[o+q]=a&255;--q>=0&&(Q*=256);)a<0&&ce===0&&this[o+q+1]!==0&&(ce=1),this[o+q]=(a/Q>>0)-ce&255;return o+h},u.prototype.writeInt8=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,1,127,-128),a<0&&(a=255+a+1),this[o]=a&255,o+1},u.prototype.writeInt16LE=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,2,32767,-32768),this[o]=a&255,this[o+1]=a>>>8,o+2},u.prototype.writeInt16BE=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,2,32767,-32768),this[o]=a>>>8,this[o+1]=a&255,o+2},u.prototype.writeInt32LE=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,4,2147483647,-2147483648),this[o]=a&255,this[o+1]=a>>>8,this[o+2]=a>>>16,this[o+3]=a>>>24,o+4},u.prototype.writeInt32BE=function(a,o,h){return a=+a,o=o>>>0,h||ue(this,a,o,4,2147483647,-2147483648),a<0&&(a=4294967295+a+1),this[o]=a>>>24,this[o+1]=a>>>16,this[o+2]=a>>>8,this[o+3]=a&255,o+4};function Z(f,a,o,h,w,N){if(o+h>f.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("Index out of range")}function g(f,a,o,h,w){return a=+a,o=o>>>0,w||Z(f,a,o,4),r.write(f,a,o,h,23,4),o+4}u.prototype.writeFloatLE=function(a,o,h){return g(this,a,o,!0,h)},u.prototype.writeFloatBE=function(a,o,h){return g(this,a,o,!1,h)};function L(f,a,o,h,w){return a=+a,o=o>>>0,w||Z(f,a,o,8),r.write(f,a,o,h,52,8),o+8}u.prototype.writeDoubleLE=function(a,o,h){return L(this,a,o,!0,h)},u.prototype.writeDoubleBE=function(a,o,h){return L(this,a,o,!1,h)},u.prototype.copy=function(a,o,h,w){if(!u.isBuffer(a))throw new TypeError("argument should be a Buffer");if(h||(h=0),!w&&w!==0&&(w=this.length),o>=a.length&&(o=a.length),o||(o=0),w>0&&w<h&&(w=h),w===h||a.length===0||this.length===0)return 0;if(o<0)throw new RangeError("targetStart out of bounds");if(h<0||h>=this.length)throw new RangeError("Index out of range");if(w<0)throw new RangeError("sourceEnd out of bounds");w>this.length&&(w=this.length),a.length-o<w-h&&(w=a.length-o+h);var N=w-h;return this===a&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(o,h,w):Uint8Array.prototype.set.call(a,this.subarray(h,w),o),N},u.prototype.fill=function(a,o,h,w){if(typeof a=="string"){if(typeof o=="string"?(w=o,o=0,h=this.length):typeof h=="string"&&(w=h,h=this.length),w!==void 0&&typeof w!="string")throw new TypeError("encoding must be a string");if(typeof w=="string"&&!u.isEncoding(w))throw new TypeError("Unknown encoding: "+w);if(a.length===1){var N=a.charCodeAt(0);(w==="utf8"&&N<128||w==="latin1")&&(a=N)}}else typeof a=="number"?a=a&255:typeof a=="boolean"&&(a=Number(a));if(o<0||this.length<o||this.length<h)throw new RangeError("Out of range index");if(h<=o)return this;o=o>>>0,h=h===void 0?this.length:h>>>0,a||(a=0);var q;if(typeof a=="number")for(q=o;q<h;++q)this[q]=a;else{var Q=u.isBuffer(a)?a:u.from(a,w),ce=Q.length;if(ce===0)throw new TypeError('The value "'+a+'" is invalid for argument "value"');for(q=0;q<h-o;++q)this[q+o]=Q[q%ce]}return this};var ie=/[^+/0-9A-Za-z-_]/g;function ae(f){if(f=f.split("=")[0],f=f.trim().replace(ie,""),f.length<2)return"";for(;f.length%4!==0;)f=f+"=";return f}function X(f,a){a=a||1/0;for(var o,h=f.length,w=null,N=[],q=0;q<h;++q){if(o=f.charCodeAt(q),o>55295&&o<57344){if(!w){if(o>56319){(a-=3)>-1&&N.push(239,191,189);continue}else if(q+1===h){(a-=3)>-1&&N.push(239,191,189);continue}w=o;continue}if(o<56320){(a-=3)>-1&&N.push(239,191,189),w=o;continue}o=(w-55296<<10|o-56320)+65536}else w&&(a-=3)>-1&&N.push(239,191,189);if(w=null,o<128){if((a-=1)<0)break;N.push(o)}else if(o<2048){if((a-=2)<0)break;N.push(o>>6|192,o&63|128)}else if(o<65536){if((a-=3)<0)break;N.push(o>>12|224,o>>6&63|128,o&63|128)}else if(o<1114112){if((a-=4)<0)break;N.push(o>>18|240,o>>12&63|128,o>>6&63|128,o&63|128)}else throw new Error("Invalid code point")}return N}function te(f){for(var a=[],o=0;o<f.length;++o)a.push(f.charCodeAt(o)&255);return a}function y(f,a){for(var o,h,w,N=[],q=0;q<f.length&&!((a-=2)<0);++q)o=f.charCodeAt(q),h=o>>8,w=o%256,N.push(w),N.push(h);return N}function m(f){return e.toByteArray(ae(f))}function E(f,a,o,h){for(var w=0;w<h&&!(w+o>=a.length||w>=f.length);++w)a[w+o]=f[w];return w}function k(f,a){return f instanceof a||f!=null&&f.constructor!=null&&f.constructor.name!=null&&f.constructor.name===a.name}function F(f){return f!==f}var C=function(){for(var f="0123456789abcdef",a=new Array(256),o=0;o<16;++o)for(var h=o*16,w=0;w<16;++w)a[h+w]=f[o]+f[w];return a}()})(qn);var Nu={exports:{}};(function(t){(function(e){var r,n=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,i=Math.ceil,s=Math.floor,c="[BigNumber Error] ",u=c+"Number primitive has more than 15 significant digits: ",l=1e14,p=14,b=9007199254740991,x=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],_=1e7,v=1e9;function d(j){var V,K,Y,z=g.prototype={constructor:g,toString:null,valueOf:null},ne=new g(1),D=20,T=4,U=-7,G=21,$=-1e7,M=1e7,W=!1,J=1,oe=0,se={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},ue="0123456789abcdefghijklmnopqrstuvwxyz",Z=!0;function g(y,m){var E,k,F,C,f,a,o,h,w=this;if(!(w instanceof g))return new g(y,m);if(m==null){if(y&&y._isBigNumber===!0){w.s=y.s,!y.c||y.e>M?w.c=w.e=null:y.e<$?w.c=[w.e=0]:(w.e=y.e,w.c=y.c.slice());return}if((a=typeof y=="number")&&y*0==0){if(w.s=1/y<0?(y=-y,-1):1,y===~~y){for(C=0,f=y;f>=10;f/=10,C++);C>M?w.c=w.e=null:(w.e=C,w.c=[y]);return}h=String(y)}else{if(!n.test(h=String(y)))return Y(w,h,a);w.s=h.charCodeAt(0)==45?(h=h.slice(1),-1):1}(C=h.indexOf("."))>-1&&(h=h.replace(".","")),(f=h.search(/e/i))>0?(C<0&&(C=f),C+=+h.slice(f+1),h=h.substring(0,f)):C<0&&(C=h.length)}else{if(I(m,2,ue.length,"Base"),m==10&&Z)return w=new g(y),X(w,D+w.e+1,T);if(h=String(y),a=typeof y=="number"){if(y*0!=0)return Y(w,h,a,m);if(w.s=1/y<0?(h=h.slice(1),-1):1,g.DEBUG&&h.replace(/^0\.0*|\./,"").length>15)throw Error(u+y)}else w.s=h.charCodeAt(0)===45?(h=h.slice(1),-1):1;for(E=ue.slice(0,m),C=f=0,o=h.length;f<o;f++)if(E.indexOf(k=h.charAt(f))<0){if(k=="."){if(f>C){C=o;continue}}else if(!F&&(h==h.toUpperCase()&&(h=h.toLowerCase())||h==h.toLowerCase()&&(h=h.toUpperCase()))){F=!0,f=-1,C=0;continue}return Y(w,String(y),a,m)}a=!1,h=K(h,m,10,w.s),(C=h.indexOf("."))>-1?h=h.replace(".",""):C=h.length}for(f=0;h.charCodeAt(f)===48;f++);for(o=h.length;h.charCodeAt(--o)===48;);if(h=h.slice(f,++o)){if(o-=f,a&&g.DEBUG&&o>15&&(y>b||y!==s(y)))throw Error(u+w.s*y);if((C=C-f-1)>M)w.c=w.e=null;else if(C<$)w.c=[w.e=0];else{if(w.e=C,w.c=[],f=(C+1)%p,C<0&&(f+=p),f<o){for(f&&w.c.push(+h.slice(0,f)),o-=p;f<o;)w.c.push(+h.slice(f,f+=p));f=p-(h=h.slice(f)).length}else f-=o;for(;f--;h+="0");w.c.push(+h)}}else w.c=[w.e=0]}g.clone=d,g.ROUND_UP=0,g.ROUND_DOWN=1,g.ROUND_CEIL=2,g.ROUND_FLOOR=3,g.ROUND_HALF_UP=4,g.ROUND_HALF_DOWN=5,g.ROUND_HALF_EVEN=6,g.ROUND_HALF_CEIL=7,g.ROUND_HALF_FLOOR=8,g.EUCLID=9,g.config=g.set=function(y){var m,E;if(y!=null)if(typeof y=="object"){if(y.hasOwnProperty(m="DECIMAL_PLACES")&&(E=y[m],I(E,0,v,m),D=E),y.hasOwnProperty(m="ROUNDING_MODE")&&(E=y[m],I(E,0,8,m),T=E),y.hasOwnProperty(m="EXPONENTIAL_AT")&&(E=y[m],E&&E.pop?(I(E[0],-1e9,0,m),I(E[1],0,v,m),U=E[0],G=E[1]):(I(E,-1e9,v,m),U=-(G=E<0?-E:E))),y.hasOwnProperty(m="RANGE"))if(E=y[m],E&&E.pop)I(E[0],-1e9,-1,m),I(E[1],1,v,m),$=E[0],M=E[1];else if(I(E,-1e9,v,m),E)$=-(M=E<0?-E:E);else throw Error(c+m+" cannot be zero: "+E);if(y.hasOwnProperty(m="CRYPTO"))if(E=y[m],E===!!E)if(E)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))W=E;else throw W=!E,Error(c+"crypto unavailable");else W=E;else throw Error(c+m+" not true or false: "+E);if(y.hasOwnProperty(m="MODULO_MODE")&&(E=y[m],I(E,0,9,m),J=E),y.hasOwnProperty(m="POW_PRECISION")&&(E=y[m],I(E,0,v,m),oe=E),y.hasOwnProperty(m="FORMAT"))if(E=y[m],typeof E=="object")se=E;else throw Error(c+m+" not an object: "+E);if(y.hasOwnProperty(m="ALPHABET"))if(E=y[m],typeof E=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(E))Z=E.slice(0,10)=="0123456789",ue=E;else throw Error(c+m+" invalid: "+E)}else throw Error(c+"Object expected: "+y);return{DECIMAL_PLACES:D,ROUNDING_MODE:T,EXPONENTIAL_AT:[U,G],RANGE:[$,M],CRYPTO:W,MODULO_MODE:J,POW_PRECISION:oe,FORMAT:se,ALPHABET:ue}},g.isBigNumber=function(y){if(!y||y._isBigNumber!==!0)return!1;if(!g.DEBUG)return!0;var m,E,k=y.c,F=y.e,C=y.s;e:if({}.toString.call(k)=="[object Array]"){if((C===1||C===-1)&&F>=-1e9&&F<=v&&F===s(F)){if(k[0]===0){if(F===0&&k.length===1)return!0;break e}if(m=(F+1)%p,m<1&&(m+=p),String(k[0]).length==m){for(m=0;m<k.length;m++)if(E=k[m],E<0||E>=l||E!==s(E))break e;if(E!==0)return!0}}}else if(k===null&&F===null&&(C===null||C===1||C===-1))return!0;throw Error(c+"Invalid BigNumber: "+y)},g.maximum=g.max=function(){return ie(arguments,-1)},g.minimum=g.min=function(){return ie(arguments,1)},g.random=function(){var y=9007199254740992,m=Math.random()*y&2097151?function(){return s(Math.random()*y)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(E){var k,F,C,f,a,o=0,h=[],w=new g(ne);if(E==null?E=D:I(E,0,v),f=i(E/p),W)if(crypto.getRandomValues){for(k=crypto.getRandomValues(new Uint32Array(f*=2));o<f;)a=k[o]*131072+(k[o+1]>>>11),a>=9e15?(F=crypto.getRandomValues(new Uint32Array(2)),k[o]=F[0],k[o+1]=F[1]):(h.push(a%1e14),o+=2);o=f/2}else if(crypto.randomBytes){for(k=crypto.randomBytes(f*=7);o<f;)a=(k[o]&31)*281474976710656+k[o+1]*1099511627776+k[o+2]*4294967296+k[o+3]*16777216+(k[o+4]<<16)+(k[o+5]<<8)+k[o+6],a>=9e15?crypto.randomBytes(7).copy(k,o):(h.push(a%1e14),o+=7);o=f/7}else throw W=!1,Error(c+"crypto unavailable");if(!W)for(;o<f;)a=m(),a<9e15&&(h[o++]=a%1e14);for(f=h[--o],E%=p,f&&E&&(a=x[p-E],h[o]=s(f/a)*a);h[o]===0;h.pop(),o--);if(o<0)h=[C=0];else{for(C=-1;h[0]===0;h.splice(0,1),C-=p);for(o=1,a=h[0];a>=10;a/=10,o++);o<p&&(C-=p-o)}return w.e=C,w.c=h,w}}(),g.sum=function(){for(var y=1,m=arguments,E=new g(m[0]);y<m.length;)E=E.plus(m[y++]);return E},K=function(){var y="0123456789";function m(E,k,F,C){for(var f,a=[0],o,h=0,w=E.length;h<w;){for(o=a.length;o--;a[o]*=k);for(a[0]+=C.indexOf(E.charAt(h++)),f=0;f<a.length;f++)a[f]>F-1&&(a[f+1]==null&&(a[f+1]=0),a[f+1]+=a[f]/F|0,a[f]%=F)}return a.reverse()}return function(E,k,F,C,f){var a,o,h,w,N,q,Q,ce,de=E.indexOf("."),he=D,ee=T;for(de>=0&&(w=oe,oe=0,E=E.replace(".",""),ce=new g(k),q=ce.pow(E.length-de),oe=w,ce.c=m(B(S(q.c),q.e,"0"),10,F,y),ce.e=ce.c.length),Q=m(E,k,F,f?(a=ue,y):(a=y,ue)),h=w=Q.length;Q[--w]==0;Q.pop());if(!Q[0])return a.charAt(0);if(de<0?--h:(q.c=Q,q.e=h,q.s=C,q=V(q,ce,he,ee,F),Q=q.c,N=q.r,h=q.e),o=h+he+1,de=Q[o],w=F/2,N=N||o<0||Q[o+1]!=null,N=ee<4?(de!=null||N)&&(ee==0||ee==(q.s<0?3:2)):de>w||de==w&&(ee==4||N||ee==6&&Q[o-1]&1||ee==(q.s<0?8:7)),o<1||!Q[0])E=N?B(a.charAt(1),-he,a.charAt(0)):a.charAt(0);else{if(Q.length=o,N)for(--F;++Q[--o]>F;)Q[o]=0,o||(++h,Q=[1].concat(Q));for(w=Q.length;!Q[--w];);for(de=0,E="";de<=w;E+=a.charAt(Q[de++]));E=B(E,h,a.charAt(0))}return E}}(),V=function(){function y(k,F,C){var f,a,o,h,w=0,N=k.length,q=F%_,Q=F/_|0;for(k=k.slice();N--;)o=k[N]%_,h=k[N]/_|0,f=Q*o+h*q,a=q*o+f%_*_+w,w=(a/C|0)+(f/_|0)+Q*h,k[N]=a%C;return w&&(k=[w].concat(k)),k}function m(k,F,C,f){var a,o;if(C!=f)o=C>f?1:-1;else for(a=o=0;a<C;a++)if(k[a]!=F[a]){o=k[a]>F[a]?1:-1;break}return o}function E(k,F,C,f){for(var a=0;C--;)k[C]-=a,a=k[C]<F[C]?1:0,k[C]=a*f+k[C]-F[C];for(;!k[0]&&k.length>1;k.splice(0,1));}return function(k,F,C,f,a){var o,h,w,N,q,Q,ce,de,he,ee,pe,Ne,et,bt,Vt,we,mt,je=k.s==F.s?1:-1,ke=k.c,Te=F.c;if(!ke||!ke[0]||!Te||!Te[0])return new g(!k.s||!F.s||(ke?Te&&ke[0]==Te[0]:!Te)?NaN:ke&&ke[0]==0||!Te?je*0:je/0);for(de=new g(je),he=de.c=[],h=k.e-F.e,je=C+h+1,a||(a=l,h=A(k.e/p)-A(F.e/p),je=je/p|0),w=0;Te[w]==(ke[w]||0);w++);if(Te[w]>(ke[w]||0)&&h--,je<0)he.push(1),N=!0;else{for(bt=ke.length,we=Te.length,w=0,je+=2,q=s(a/(Te[0]+1)),q>1&&(Te=y(Te,q,a),ke=y(ke,q,a),we=Te.length,bt=ke.length),et=we,ee=ke.slice(0,we),pe=ee.length;pe<we;ee[pe++]=0);mt=Te.slice(),mt=[0].concat(mt),Vt=Te[0],Te[1]>=a/2&&Vt++;do{if(q=0,o=m(Te,ee,we,pe),o<0){if(Ne=ee[0],we!=pe&&(Ne=Ne*a+(ee[1]||0)),q=s(Ne/Vt),q>1)for(q>=a&&(q=a-1),Q=y(Te,q,a),ce=Q.length,pe=ee.length;m(Q,ee,ce,pe)==1;)q--,E(Q,we<ce?mt:Te,ce,a),ce=Q.length,o=1;else q==0&&(o=q=1),Q=Te.slice(),ce=Q.length;if(ce<pe&&(Q=[0].concat(Q)),E(ee,Q,pe,a),pe=ee.length,o==-1)for(;m(Te,ee,we,pe)<1;)q++,E(ee,we<pe?mt:Te,pe,a),pe=ee.length}else o===0&&(q++,ee=[0]);he[w++]=q,ee[0]?ee[pe++]=ke[et]||0:(ee=[ke[et]],pe=1)}while((et++<bt||ee[0]!=null)&&je--);N=ee[0]!=null,he[0]||he.splice(0,1)}if(a==l){for(w=1,je=he[0];je>=10;je/=10,w++);X(de,C+(de.e=w+h*p-1)+1,f,N)}else de.e=h,de.r=+N;return de}}();function L(y,m,E,k){var F,C,f,a,o;if(E==null?E=T:I(E,0,8),!y.c)return y.toString();if(F=y.c[0],f=y.e,m==null)o=S(y.c),o=k==1||k==2&&(f<=U||f>=G)?H(o,f):B(o,f,"0");else if(y=X(new g(y),m,E),C=y.e,o=S(y.c),a=o.length,k==1||k==2&&(m<=C||C<=U)){for(;a<m;o+="0",a++);o=H(o,C)}else if(m-=f,o=B(o,C,"0"),C+1>a){if(--m>0)for(o+=".";m--;o+="0");}else if(m+=C-a,m>0)for(C+1==a&&(o+=".");m--;o+="0");return y.s<0&&F?"-"+o:o}function ie(y,m){for(var E,k,F=1,C=new g(y[0]);F<y.length;F++)k=new g(y[F]),(!k.s||(E=P(C,k))===m||E===0&&C.s===m)&&(C=k);return C}function ae(y,m,E){for(var k=1,F=m.length;!m[--F];m.pop());for(F=m[0];F>=10;F/=10,k++);return(E=k+E*p-1)>M?y.c=y.e=null:E<$?y.c=[y.e=0]:(y.e=E,y.c=m),y}Y=function(){var y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,m=/^([^.]+)\.$/,E=/^\.([^.]+)$/,k=/^-?(Infinity|NaN)$/,F=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(C,f,a,o){var h,w=a?f:f.replace(F,"");if(k.test(w))C.s=isNaN(w)?null:w<0?-1:1;else{if(!a&&(w=w.replace(y,function(N,q,Q){return h=(Q=Q.toLowerCase())=="x"?16:Q=="b"?2:8,!o||o==h?q:N}),o&&(h=o,w=w.replace(m,"$1").replace(E,"0.$1")),f!=w))return new g(w,h);if(g.DEBUG)throw Error(c+"Not a"+(o?" base "+o:"")+" number: "+f);C.s=null}C.c=C.e=null}}();function X(y,m,E,k){var F,C,f,a,o,h,w,N=y.c,q=x;if(N){e:{for(F=1,a=N[0];a>=10;a/=10,F++);if(C=m-F,C<0)C+=p,f=m,o=N[h=0],w=s(o/q[F-f-1]%10);else if(h=i((C+1)/p),h>=N.length)if(k){for(;N.length<=h;N.push(0));o=w=0,F=1,C%=p,f=C-p+1}else break e;else{for(o=a=N[h],F=1;a>=10;a/=10,F++);C%=p,f=C-p+F,w=f<0?0:s(o/q[F-f-1]%10)}if(k=k||m<0||N[h+1]!=null||(f<0?o:o%q[F-f-1]),k=E<4?(w||k)&&(E==0||E==(y.s<0?3:2)):w>5||w==5&&(E==4||k||E==6&&(C>0?f>0?o/q[F-f]:0:N[h-1])%10&1||E==(y.s<0?8:7)),m<1||!N[0])return N.length=0,k?(m-=y.e+1,N[0]=q[(p-m%p)%p],y.e=-m||0):N[0]=y.e=0,y;if(C==0?(N.length=h,a=1,h--):(N.length=h+1,a=q[p-C],N[h]=f>0?s(o/q[F-f]%q[f])*a:0),k)for(;;)if(h==0){for(C=1,f=N[0];f>=10;f/=10,C++);for(f=N[0]+=a,a=1;f>=10;f/=10,a++);C!=a&&(y.e++,N[0]==l&&(N[0]=1));break}else{if(N[h]+=a,N[h]!=l)break;N[h--]=0,a=1}for(C=N.length;N[--C]===0;N.pop());}y.e>M?y.c=y.e=null:y.e<$&&(y.c=[y.e=0])}return y}function te(y){var m,E=y.e;return E===null?y.toString():(m=S(y.c),m=E<=U||E>=G?H(m,E):B(m,E,"0"),y.s<0?"-"+m:m)}return z.absoluteValue=z.abs=function(){var y=new g(this);return y.s<0&&(y.s=1),y},z.comparedTo=function(y,m){return P(this,new g(y,m))},z.decimalPlaces=z.dp=function(y,m){var E,k,F,C=this;if(y!=null)return I(y,0,v),m==null?m=T:I(m,0,8),X(new g(C),y+C.e+1,m);if(!(E=C.c))return null;if(k=((F=E.length-1)-A(this.e/p))*p,F=E[F])for(;F%10==0;F/=10,k--);return k<0&&(k=0),k},z.dividedBy=z.div=function(y,m){return V(this,new g(y,m),D,T)},z.dividedToIntegerBy=z.idiv=function(y,m){return V(this,new g(y,m),0,1)},z.exponentiatedBy=z.pow=function(y,m){var E,k,F,C,f,a,o,h,w,N=this;if(y=new g(y),y.c&&!y.isInteger())throw Error(c+"Exponent not an integer: "+te(y));if(m!=null&&(m=new g(m)),a=y.e>14,!N.c||!N.c[0]||N.c[0]==1&&!N.e&&N.c.length==1||!y.c||!y.c[0])return w=new g(Math.pow(+te(N),a?y.s*(2-R(y)):+te(y))),m?w.mod(m):w;if(o=y.s<0,m){if(m.c?!m.c[0]:!m.s)return new g(NaN);k=!o&&N.isInteger()&&m.isInteger(),k&&(N=N.mod(m))}else{if(y.e>9&&(N.e>0||N.e<-1||(N.e==0?N.c[0]>1||a&&N.c[1]>=24e7:N.c[0]<8e13||a&&N.c[0]<=9999975e7)))return C=N.s<0&&R(y)?-0:0,N.e>-1&&(C=1/C),new g(o?1/C:C);oe&&(C=i(oe/p+2))}for(a?(E=new g(.5),o&&(y.s=1),h=R(y)):(F=Math.abs(+te(y)),h=F%2),w=new g(ne);;){if(h){if(w=w.times(N),!w.c)break;C?w.c.length>C&&(w.c.length=C):k&&(w=w.mod(m))}if(F){if(F=s(F/2),F===0)break;h=F%2}else if(y=y.times(E),X(y,y.e+1,1),y.e>14)h=R(y);else{if(F=+te(y),F===0)break;h=F%2}N=N.times(N),C?N.c&&N.c.length>C&&(N.c.length=C):k&&(N=N.mod(m))}return k?w:(o&&(w=ne.div(w)),m?w.mod(m):C?X(w,oe,T,f):w)},z.integerValue=function(y){var m=new g(this);return y==null?y=T:I(y,0,8),X(m,m.e+1,y)},z.isEqualTo=z.eq=function(y,m){return P(this,new g(y,m))===0},z.isFinite=function(){return!!this.c},z.isGreaterThan=z.gt=function(y,m){return P(this,new g(y,m))>0},z.isGreaterThanOrEqualTo=z.gte=function(y,m){return(m=P(this,new g(y,m)))===1||m===0},z.isInteger=function(){return!!this.c&&A(this.e/p)>this.c.length-2},z.isLessThan=z.lt=function(y,m){return P(this,new g(y,m))<0},z.isLessThanOrEqualTo=z.lte=function(y,m){return(m=P(this,new g(y,m)))===-1||m===0},z.isNaN=function(){return!this.s},z.isNegative=function(){return this.s<0},z.isPositive=function(){return this.s>0},z.isZero=function(){return!!this.c&&this.c[0]==0},z.minus=function(y,m){var E,k,F,C,f=this,a=f.s;if(y=new g(y,m),m=y.s,!a||!m)return new g(NaN);if(a!=m)return y.s=-m,f.plus(y);var o=f.e/p,h=y.e/p,w=f.c,N=y.c;if(!o||!h){if(!w||!N)return w?(y.s=-m,y):new g(N?f:NaN);if(!w[0]||!N[0])return N[0]?(y.s=-m,y):new g(w[0]?f:T==3?-0:0)}if(o=A(o),h=A(h),w=w.slice(),a=o-h){for((C=a<0)?(a=-a,F=w):(h=o,F=N),F.reverse(),m=a;m--;F.push(0));F.reverse()}else for(k=(C=(a=w.length)<(m=N.length))?a:m,a=m=0;m<k;m++)if(w[m]!=N[m]){C=w[m]<N[m];break}if(C&&(F=w,w=N,N=F,y.s=-y.s),m=(k=N.length)-(E=w.length),m>0)for(;m--;w[E++]=0);for(m=l-1;k>a;){if(w[--k]<N[k]){for(E=k;E&&!w[--E];w[E]=m);--w[E],w[k]+=l}w[k]-=N[k]}for(;w[0]==0;w.splice(0,1),--h);return w[0]?ae(y,w,h):(y.s=T==3?-1:1,y.c=[y.e=0],y)},z.modulo=z.mod=function(y,m){var E,k,F=this;return y=new g(y,m),!F.c||!y.s||y.c&&!y.c[0]?new g(NaN):!y.c||F.c&&!F.c[0]?new g(F):(J==9?(k=y.s,y.s=1,E=V(F,y,0,3),y.s=k,E.s*=k):E=V(F,y,0,J),y=F.minus(E.times(y)),!y.c[0]&&J==1&&(y.s=F.s),y)},z.multipliedBy=z.times=function(y,m){var E,k,F,C,f,a,o,h,w,N,q,Q,ce,de,he,ee=this,pe=ee.c,Ne=(y=new g(y,m)).c;if(!pe||!Ne||!pe[0]||!Ne[0])return!ee.s||!y.s||pe&&!pe[0]&&!Ne||Ne&&!Ne[0]&&!pe?y.c=y.e=y.s=null:(y.s*=ee.s,!pe||!Ne?y.c=y.e=null:(y.c=[0],y.e=0)),y;for(k=A(ee.e/p)+A(y.e/p),y.s*=ee.s,o=pe.length,N=Ne.length,o<N&&(ce=pe,pe=Ne,Ne=ce,F=o,o=N,N=F),F=o+N,ce=[];F--;ce.push(0));for(de=l,he=_,F=N;--F>=0;){for(E=0,q=Ne[F]%he,Q=Ne[F]/he|0,f=o,C=F+f;C>F;)h=pe[--f]%he,w=pe[f]/he|0,a=Q*h+w*q,h=q*h+a%he*he+ce[C]+E,E=(h/de|0)+(a/he|0)+Q*w,ce[C--]=h%de;ce[C]=E}return E?++k:ce.splice(0,1),ae(y,ce,k)},z.negated=function(){var y=new g(this);return y.s=-y.s||null,y},z.plus=function(y,m){var E,k=this,F=k.s;if(y=new g(y,m),m=y.s,!F||!m)return new g(NaN);if(F!=m)return y.s=-m,k.minus(y);var C=k.e/p,f=y.e/p,a=k.c,o=y.c;if(!C||!f){if(!a||!o)return new g(F/0);if(!a[0]||!o[0])return o[0]?y:new g(a[0]?k:F*0)}if(C=A(C),f=A(f),a=a.slice(),F=C-f){for(F>0?(f=C,E=o):(F=-F,E=a),E.reverse();F--;E.push(0));E.reverse()}for(F=a.length,m=o.length,F-m<0&&(E=o,o=a,a=E,m=F),F=0;m;)F=(a[--m]=a[m]+o[m]+F)/l|0,a[m]=l===a[m]?0:a[m]%l;return F&&(a=[F].concat(a),++f),ae(y,a,f)},z.precision=z.sd=function(y,m){var E,k,F,C=this;if(y!=null&&y!==!!y)return I(y,1,v),m==null?m=T:I(m,0,8),X(new g(C),y,m);if(!(E=C.c))return null;if(F=E.length-1,k=F*p+1,F=E[F]){for(;F%10==0;F/=10,k--);for(F=E[0];F>=10;F/=10,k++);}return y&&C.e+1>k&&(k=C.e+1),k},z.shiftedBy=function(y){return I(y,-9007199254740991,b),this.times("1e"+y)},z.squareRoot=z.sqrt=function(){var y,m,E,k,F,C=this,f=C.c,a=C.s,o=C.e,h=D+4,w=new g("0.5");if(a!==1||!f||!f[0])return new g(!a||a<0&&(!f||f[0])?NaN:f?C:1/0);if(a=Math.sqrt(+te(C)),a==0||a==1/0?(m=S(f),(m.length+o)%2==0&&(m+="0"),a=Math.sqrt(+m),o=A((o+1)/2)-(o<0||o%2),a==1/0?m="5e"+o:(m=a.toExponential(),m=m.slice(0,m.indexOf("e")+1)+o),E=new g(m)):E=new g(a+""),E.c[0]){for(o=E.e,a=o+h,a<3&&(a=0);;)if(F=E,E=w.times(F.plus(V(C,F,h,1))),S(F.c).slice(0,a)===(m=S(E.c)).slice(0,a))if(E.e<o&&--a,m=m.slice(a-3,a+1),m=="9999"||!k&&m=="4999"){if(!k&&(X(F,F.e+D+2,0),F.times(F).eq(C))){E=F;break}h+=4,a+=4,k=1}else{(!+m||!+m.slice(1)&&m.charAt(0)=="5")&&(X(E,E.e+D+2,1),y=!E.times(E).eq(C));break}}return X(E,E.e+D+1,T,y)},z.toExponential=function(y,m){return y!=null&&(I(y,0,v),y++),L(this,y,m,1)},z.toFixed=function(y,m){return y!=null&&(I(y,0,v),y=y+this.e+1),L(this,y,m)},z.toFormat=function(y,m,E){var k,F=this;if(E==null)y!=null&&m&&typeof m=="object"?(E=m,m=null):y&&typeof y=="object"?(E=y,y=m=null):E=se;else if(typeof E!="object")throw Error(c+"Argument not an object: "+E);if(k=F.toFixed(y,m),F.c){var C,f=k.split("."),a=+E.groupSize,o=+E.secondaryGroupSize,h=E.groupSeparator||"",w=f[0],N=f[1],q=F.s<0,Q=q?w.slice(1):w,ce=Q.length;if(o&&(C=a,a=o,o=C,ce-=C),a>0&&ce>0){for(C=ce%a||a,w=Q.substr(0,C);C<ce;C+=a)w+=h+Q.substr(C,a);o>0&&(w+=h+Q.slice(C)),q&&(w="-"+w)}k=N?w+(E.decimalSeparator||"")+((o=+E.fractionGroupSize)?N.replace(new RegExp("\\d{"+o+"}\\B","g"),"$&"+(E.fractionGroupSeparator||"")):N):w}return(E.prefix||"")+k+(E.suffix||"")},z.toFraction=function(y){var m,E,k,F,C,f,a,o,h,w,N,q,Q=this,ce=Q.c;if(y!=null&&(a=new g(y),!a.isInteger()&&(a.c||a.s!==1)||a.lt(ne)))throw Error(c+"Argument "+(a.isInteger()?"out of range: ":"not an integer: ")+te(a));if(!ce)return new g(Q);for(m=new g(ne),h=E=new g(ne),k=o=new g(ne),q=S(ce),C=m.e=q.length-Q.e-1,m.c[0]=x[(f=C%p)<0?p+f:f],y=!y||a.comparedTo(m)>0?C>0?m:h:a,f=M,M=1/0,a=new g(q),o.c[0]=0;w=V(a,m,0,1),F=E.plus(w.times(k)),F.comparedTo(y)!=1;)E=k,k=F,h=o.plus(w.times(F=h)),o=F,m=a.minus(w.times(F=m)),a=F;return F=V(y.minus(E),k,0,1),o=o.plus(F.times(h)),E=E.plus(F.times(k)),o.s=h.s=Q.s,C=C*2,N=V(h,k,C,T).minus(Q).abs().comparedTo(V(o,E,C,T).minus(Q).abs())<1?[h,k]:[o,E],M=f,N},z.toNumber=function(){return+te(this)},z.toPrecision=function(y,m){return y!=null&&I(y,1,v),L(this,y,m,2)},z.toString=function(y){var m,E=this,k=E.s,F=E.e;return F===null?k?(m="Infinity",k<0&&(m="-"+m)):m="NaN":(y==null?m=F<=U||F>=G?H(S(E.c),F):B(S(E.c),F,"0"):y===10&&Z?(E=X(new g(E),D+F+1,T),m=B(S(E.c),E.e,"0")):(I(y,2,ue.length,"Base"),m=K(B(S(E.c),F,"0"),10,y,k,!0)),k<0&&E.c[0]&&(m="-"+m)),m},z.valueOf=z.toJSON=function(){return te(this)},z._isBigNumber=!0,j!=null&&g.set(j),g}function A(j){var V=j|0;return j>0||j===V?V:V-1}function S(j){for(var V,K,Y=1,z=j.length,ne=j[0]+"";Y<z;){for(V=j[Y++]+"",K=p-V.length;K--;V="0"+V);ne+=V}for(z=ne.length;ne.charCodeAt(--z)===48;);return ne.slice(0,z+1||1)}function P(j,V){var K,Y,z=j.c,ne=V.c,D=j.s,T=V.s,U=j.e,G=V.e;if(!D||!T)return null;if(K=z&&!z[0],Y=ne&&!ne[0],K||Y)return K?Y?0:-T:D;if(D!=T)return D;if(K=D<0,Y=U==G,!z||!ne)return Y?0:!z^K?1:-1;if(!Y)return U>G^K?1:-1;for(T=(U=z.length)<(G=ne.length)?U:G,D=0;D<T;D++)if(z[D]!=ne[D])return z[D]>ne[D]^K?1:-1;return U==G?0:U>G^K?1:-1}function I(j,V,K,Y){if(j<V||j>K||j!==s(j))throw Error(c+(Y||"Argument")+(typeof j=="number"?j<V||j>K?" out of range: ":" not an integer: ":" not a primitive number: ")+String(j))}function R(j){var V=j.c.length-1;return A(j.e/p)==V&&j.c[V]%2!=0}function H(j,V){return(j.length>1?j.charAt(0)+"."+j.slice(1):j)+(V<0?"e":"e+")+V}function B(j,V,K){var Y,z;if(V<0){for(z=K+".";++V;z+=K);j=z+j}else if(Y=j.length,++V>Y){for(z=K,V-=Y;--V;z+=K);j+=z}else V<Y&&(j=j.slice(0,V)+"."+j.slice(V));return j}r=d(),r.default=r.BigNumber=r,t.exports?t.exports=r:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=r)})(Dr)})(Nu);var hs=Nu.exports,fd=function(e,r,n){var i=new e.Uint8Array(n),s=r.pushInt,c=r.pushInt32,u=r.pushInt32Neg,l=r.pushInt64,p=r.pushInt64Neg,b=r.pushFloat,x=r.pushFloatSingle,_=r.pushFloatDouble,v=r.pushTrue,d=r.pushFalse,A=r.pushUndefined,S=r.pushNull,P=r.pushInfinity,I=r.pushInfinityNeg,R=r.pushNaN,H=r.pushNaNNeg,B=r.pushArrayStart,j=r.pushArrayStartFixed,V=r.pushArrayStartFixed32,K=r.pushArrayStartFixed64,Y=r.pushObjectStart,z=r.pushObjectStartFixed,ne=r.pushObjectStartFixed32,D=r.pushObjectStartFixed64,T=r.pushByteString,U=r.pushByteStringStart,G=r.pushUtf8String,$=r.pushUtf8StringStart,M=r.pushSimpleUnassigned,W=r.pushTagStart,J=r.pushTagStart4,oe=r.pushTagStart8,se=r.pushTagUnassigned,ue=r.pushBreak,Z=e.Math.pow,g=0,L=0,ie=0;function ae(O){for(O=O|0,g=0,L=O;(g|0)<(L|0)&&(ie=qf[i[g]&255](i[g]|0)|0,!((ie|0)>0)););return ie|0}function X(O){return O=O|0,((g|0)+(O|0)|0)<(L|0)?0:1}function te(O){return O=O|0,i[O|0]<<8|i[O+1|0]|0}function y(O){return O=O|0,i[O|0]<<24|i[O+1|0]<<16|i[O+2|0]<<8|i[O+3|0]|0}function m(O){return O=O|0,s(O|0),g=g+1|0,0}function E(O){return O=O|0,X(1)|0?1:(s(i[g+1|0]|0),g=g+2|0,0)}function k(O){return O=O|0,X(2)|0?1:(s(te(g+1|0)|0),g=g+3|0,0)}function F(O){return O=O|0,X(4)|0?1:(c(te(g+1|0)|0,te(g+3|0)|0),g=g+5|0,0)}function C(O){return O=O|0,X(8)|0?1:(l(te(g+1|0)|0,te(g+3|0)|0,te(g+5|0)|0,te(g+7|0)|0),g=g+9|0,0)}function f(O){return O=O|0,s(-1-(O-32|0)|0),g=g+1|0,0}function a(O){return O=O|0,X(1)|0?1:(s(-1-(i[g+1|0]|0)|0),g=g+2|0,0)}function o(O){O=O|0;var _e=0;return X(2)|0?1:(_e=te(g+1|0)|0,s(-1-(_e|0)|0),g=g+3|0,0)}function h(O){return O=O|0,X(4)|0?1:(u(te(g+1|0)|0,te(g+3|0)|0),g=g+5|0,0)}function w(O){return O=O|0,X(8)|0?1:(p(te(g+1|0)|0,te(g+3|0)|0,te(g+5|0)|0,te(g+7|0)|0),g=g+9|0,0)}function N(O){O=O|0;var _e=0,ve=0,be=0;return be=O-64|0,X(be|0)|0?1:(_e=g+1|0,ve=(g+1|0)+(be|0)|0,T(_e|0,ve|0),g=ve|0,0)}function q(O){O=O|0;var _e=0,ve=0,be=0;return X(1)|0||(be=i[g+1|0]|0,_e=g+2|0,ve=(g+2|0)+(be|0)|0,X(be+1|0)|0)?1:(T(_e|0,ve|0),g=ve|0,0)}function Q(O){O=O|0;var _e=0,ve=0,be=0;return X(2)|0||(be=te(g+1|0)|0,_e=g+3|0,ve=(g+3|0)+(be|0)|0,X(be+2|0)|0)?1:(T(_e|0,ve|0),g=ve|0,0)}function ce(O){O=O|0;var _e=0,ve=0,be=0;return X(4)|0||(be=y(g+1|0)|0,_e=g+5|0,ve=(g+5|0)+(be|0)|0,X(be+4|0)|0)?1:(T(_e|0,ve|0),g=ve|0,0)}function de(O){return O=O|0,1}function he(O){return O=O|0,U(),g=g+1|0,0}function ee(O){O=O|0;var _e=0,ve=0,be=0;return be=O-96|0,X(be|0)|0?1:(_e=g+1|0,ve=(g+1|0)+(be|0)|0,G(_e|0,ve|0),g=ve|0,0)}function pe(O){O=O|0;var _e=0,ve=0,be=0;return X(1)|0||(be=i[g+1|0]|0,_e=g+2|0,ve=(g+2|0)+(be|0)|0,X(be+1|0)|0)?1:(G(_e|0,ve|0),g=ve|0,0)}function Ne(O){O=O|0;var _e=0,ve=0,be=0;return X(2)|0||(be=te(g+1|0)|0,_e=g+3|0,ve=(g+3|0)+(be|0)|0,X(be+2|0)|0)?1:(G(_e|0,ve|0),g=ve|0,0)}function et(O){O=O|0;var _e=0,ve=0,be=0;return X(4)|0||(be=y(g+1|0)|0,_e=g+5|0,ve=(g+5|0)+(be|0)|0,X(be+4|0)|0)?1:(G(_e|0,ve|0),g=ve|0,0)}function bt(O){return O=O|0,1}function Vt(O){return O=O|0,$(),g=g+1|0,0}function we(O){return O=O|0,j(O-128|0),g=g+1|0,0}function mt(O){return O=O|0,X(1)|0?1:(j(i[g+1|0]|0),g=g+2|0,0)}function je(O){return O=O|0,X(2)|0?1:(j(te(g+1|0)|0),g=g+3|0,0)}function ke(O){return O=O|0,X(4)|0?1:(V(te(g+1|0)|0,te(g+3|0)|0),g=g+5|0,0)}function Te(O){return O=O|0,X(8)|0?1:(K(te(g+1|0)|0,te(g+3|0)|0,te(g+5|0)|0,te(g+7|0)|0),g=g+9|0,0)}function an(O){return O=O|0,B(),g=g+1|0,0}function Se(O){O=O|0;var _e=0;return _e=O-160|0,X(_e|0)|0?1:(z(_e|0),g=g+1|0,0)}function on(O){return O=O|0,X(1)|0?1:(z(i[g+1|0]|0),g=g+2|0,0)}function cn(O){return O=O|0,X(2)|0?1:(z(te(g+1|0)|0),g=g+3|0,0)}function un(O){return O=O|0,X(4)|0?1:(ne(te(g+1|0)|0,te(g+3|0)|0),g=g+5|0,0)}function fn(O){return O=O|0,X(8)|0?1:(D(te(g+1|0)|0,te(g+3|0)|0,te(g+5|0)|0,te(g+7|0)|0),g=g+9|0,0)}function ln(O){return O=O|0,Y(),g=g+1|0,0}function Rt(O){return O=O|0,W(O-192|0|0),g=g+1|0,0}function no(O){return O=O|0,W(O|0),g=g+1|0,0}function io(O){return O=O|0,W(O|0),g=g+1|0,0}function so(O){return O=O|0,W(O|0),g=g+1|0,0}function ao(O){return O=O|0,W(O|0),g=g+1|0,0}function $e(O){return O=O|0,W(O-192|0|0),g=g+1|0,0}function oo(O){return O=O|0,W(O|0),g=g+1|0,0}function co(O){return O=O|0,W(O|0),g=g+1|0,0}function uo(O){return O=O|0,W(O|0),g=g+1|0,0}function ms(O){return O=O|0,X(1)|0?1:(W(i[g+1|0]|0),g=g+2|0,0)}function _s(O){return O=O|0,X(2)|0?1:(W(te(g+1|0)|0),g=g+3|0,0)}function vs(O){return O=O|0,X(4)|0?1:(J(te(g+1|0)|0,te(g+3|0)|0),g=g+5|0,0)}function xs(O){return O=O|0,X(8)|0?1:(oe(te(g+1|0)|0,te(g+3|0)|0,te(g+5|0)|0,te(g+7|0)|0),g=g+9|0,0)}function Ue(O){return O=O|0,M((O|0)-224|0),g=g+1|0,0}function Es(O){return O=O|0,d(),g=g+1|0,0}function Ts(O){return O=O|0,v(),g=g+1|0,0}function Ss(O){return O=O|0,S(),g=g+1|0,0}function As(O){return O=O|0,A(),g=g+1|0,0}function Ns(O){return O=O|0,X(1)|0?1:(M(i[g+1|0]|0),g=g+2|0,0)}function Bs(O){O=O|0;var _e=0,ve=0,be=1,Yn=0,dn=0,Tg=0;return X(2)|0?1:(_e=i[g+1|0]|0,ve=i[g+2|0]|0,(_e|0)&128&&(be=-1),Yn=+(((_e|0)&124)>>2),dn=+(((_e|0)&3)<<8|ve),+Yn==0?b(+(+be*5960464477539063e-23*+dn)):+Yn==31?+be==1?+dn>0?R():P():+dn>0?H():I():b(+(+be*Z(2,+(+Yn-25))*+(1024+dn))),g=g+3|0,0)}function Rs(O){return O=O|0,X(4)|0?1:(x(i[g+1|0]|0,i[g+2|0]|0,i[g+3|0]|0,i[g+4|0]|0),g=g+5|0,0)}function Os(O){return O=O|0,X(8)|0?1:(_(i[g+1|0]|0,i[g+2|0]|0,i[g+3|0]|0,i[g+4|0]|0,i[g+5|0]|0,i[g+6|0]|0,i[g+7|0]|0,i[g+8|0]|0),g=g+9|0,0)}function xe(O){return O=O|0,1}function Vf(O){return O=O|0,ue(),g=g+1|0,0}var qf=[m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,m,E,k,F,C,xe,xe,xe,xe,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,f,a,o,h,w,xe,xe,xe,xe,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,N,q,Q,ce,de,xe,xe,xe,he,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,ee,pe,Ne,et,bt,xe,xe,xe,Vt,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,we,mt,je,ke,Te,xe,xe,xe,an,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,Se,on,cn,un,fn,xe,xe,xe,ln,Rt,Rt,Rt,Rt,Rt,Rt,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,$e,ms,_s,vs,xs,xe,xe,xe,xe,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Ue,Es,Ts,Ss,As,Ns,Bs,Rs,Os,xe,xe,xe,Vf];return{parse:ae}},ps={},De={};const Ha=hs.BigNumber;De.MT={POS_INT:0,NEG_INT:1,BYTE_STRING:2,UTF8_STRING:3,ARRAY:4,MAP:5,TAG:6,SIMPLE_FLOAT:7};De.TAG={DATE_STRING:0,DATE_EPOCH:1,POS_BIGINT:2,NEG_BIGINT:3,DECIMAL_FRAC:4,BIGFLOAT:5,BASE64URL_EXPECTED:21,BASE64_EXPECTED:22,BASE16_EXPECTED:23,CBOR:24,URI:32,BASE64URL:33,BASE64:34,REGEXP:35,MIME:36};De.NUMBYTES={ZERO:0,ONE:24,TWO:25,FOUR:26,EIGHT:27,INDEFINITE:31};De.SIMPLE={FALSE:20,TRUE:21,NULL:22,UNDEFINED:23};De.SYMS={NULL:Symbol("null"),UNDEFINED:Symbol("undef"),PARENT:Symbol("parent"),BREAK:Symbol("break"),STREAM:Symbol("stream")};De.SHIFT32=Math.pow(2,32);De.SHIFT16=Math.pow(2,16);De.MAX_SAFE_HIGH=2097151;De.NEG_ONE=new Ha(-1);De.TEN=new Ha(10);De.TWO=new Ha(2);De.PARENT={ARRAY:0,OBJECT:1,MAP:2,TAG:3,BYTE_STRING:4,UTF8_STRING:5};(function(t){const{Buffer:e}=qn,r=hs.BigNumber,n=De,i=n.SHIFT32,s=n.SHIFT16,c=2097151;t.parseHalf=function(p){var b,x,_;return _=p[0]&128?-1:1,b=(p[0]&124)>>2,x=(p[0]&3)<<8|p[1],b?b===31?_*(x?NaN:1/0):_*Math.pow(2,b-25)*(1024+x):_*5960464477539063e-23*x};function u(l){return l<16?"0"+l.toString(16):l.toString(16)}t.arrayBufferToBignumber=function(l){const p=l.byteLength;let b="";for(let x=0;x<p;x++)b+=u(l[x]);return new r(b,16)},t.buildMap=l=>{const p=new Map,b=Object.keys(l),x=b.length;for(let _=0;_<x;_++)p.set(b[_],l[b[_]]);return p},t.buildInt32=(l,p)=>l*s+p,t.buildInt64=(l,p,b,x)=>{const _=t.buildInt32(l,p),v=t.buildInt32(b,x);return _>c?new r(_).times(i).plus(v):_*i+v},t.writeHalf=function(p,b){const x=e.allocUnsafe(4);x.writeFloatBE(b,0);const _=x.readUInt32BE(0);if(_&8191)return!1;var v=_>>16&32768;const d=_>>23&255,A=_&8388607;if(d>=113&&d<=142)v+=(d-112<<10)+(A>>13);else if(d>=103&&d<113){if(A&(1<<126-d)-1)return!1;v+=A+8388608>>126-d}else return!1;return p.writeUInt16BE(v,0),!0},t.keySorter=function(l,p){var b=l[0].byteLength,x=p[0].byteLength;return b>x?1:x>b?-1:l[0].compare(p[0])},t.isNegativeZero=l=>l===0&&1/l<0,t.nextPowerOf2=l=>{let p=0;if(l&&!(l&l-1))return l;for(;l!==0;)l>>=1,p+=1;return 1<<p}})(ps);const ja=De,ld=ja.MT,Ln=ja.SIMPLE,Gs=ja.SYMS;let dd=class ha{constructor(e){if(typeof e!="number")throw new Error("Invalid Simple type: "+typeof e);if(e<0||e>255||(e|0)!==e)throw new Error("value must be a small positive integer: "+e);this.value=e}toString(){return"simple("+this.value+")"}inspect(){return"simple("+this.value+")"}encodeCBOR(e){return e._pushInt(this.value,ld.SIMPLE_FLOAT)}static isSimple(e){return e instanceof ha}static decode(e,r){switch(r==null&&(r=!0),e){case Ln.FALSE:return!1;case Ln.TRUE:return!0;case Ln.NULL:return r?null:Gs.NULL;case Ln.UNDEFINED:return r?void 0:Gs.UNDEFINED;case-1:if(!r)throw new Error("Invalid BREAK");return Gs.BREAK;default:return new ha(e)}}};var Bu=dd;let hd=class pa{constructor(e,r,n){if(this.tag=e,this.value=r,this.err=n,typeof this.tag!="number")throw new Error("Invalid tag type ("+typeof this.tag+")");if(this.tag<0||(this.tag|0)!==this.tag)throw new Error("Tag must be a positive integer: "+this.tag)}toString(){return`${this.tag}(${JSON.stringify(this.value)})`}encodeCBOR(e){return e._pushTag(this.tag),e.pushAny(this.value)}convert(e){var r,n;if(n=e?.[this.tag],typeof n!="function"&&(n=pa["_tag"+this.tag],typeof n!="function"))return this;try{return n.call(pa,this.value)}catch(i){return r=i,this.err=r,this}}};var Ru=hd;const Ou=self.location?self.location.protocol+"//"+self.location.host:"",ga=self.URL;let pd=class{constructor(e="",r=Ou){this.super=new ga(e,r),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(e){this.super.hash=e}set host(e){this.super.host=e}set hostname(e){this.super.hostname=e}set href(e){this.super.href=e}set origin(e){this.super.origin=e}set password(e){this.super.password=e}set pathname(e){this.super.pathname=e}set port(e){this.super.port=e}set protocol(e){this.super.protocol=e}set search(e){this.super.search=e}set searchParams(e){this.super.searchParams=e}set username(e){this.super.username=e}createObjectURL(e){return this.super.createObjectURL(e)}revokeObjectURL(e){this.super.revokeObjectURL(e)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}};function gd(t){if(typeof t=="string")return new ga(t).toString();if(!(t instanceof ga)){const e=t.username&&t.password?`${t.username}:${t.password}@`:"",r=t.auth?t.auth+"@":"",n=t.port?":"+t.port:"",i=t.protocol?t.protocol+"//":"",s=t.host||"",c=t.hostname||"",u=t.search||(t.query?"?"+t.query:""),l=t.hash||"",p=t.pathname||"",b=t.path||p+u;return`${i}${e||r}${s||c+n}${b}${l}`}}var Uu={URLWithLegacySupport:pd,URLSearchParams:self.URLSearchParams,defaultBase:Ou,format:gd};const{URLWithLegacySupport:Cg,format:Mg}=Uu,{URLWithLegacySupport:yd,format:$g,URLSearchParams:Gg,defaultBase:Vg}=Uu;var Fu={URL:yd};const{Buffer:kr}=qn,vo=Nc,wd=hs.BigNumber,bd=fd,tt=ps,Ae=De,md=Bu,_d=Ru,{URL:vd}=Fu;let ya=class wa{constructor(e){e=e||{},!e.size||e.size<65536?e.size=65536:e.size=tt.nextPowerOf2(e.size),this._heap=new ArrayBuffer(e.size),this._heap8=new Uint8Array(this._heap),this._buffer=kr.from(this._heap),this._reset(),this._knownTags=Object.assign({0:r=>new Date(r),1:r=>new Date(r*1e3),2:r=>tt.arrayBufferToBignumber(r),3:r=>Ae.NEG_ONE.minus(tt.arrayBufferToBignumber(r)),4:r=>Ae.TEN.pow(r[0]).times(r[1]),5:r=>Ae.TWO.pow(r[0]).times(r[1]),32:r=>new vd(r),35:r=>new RegExp(r)},e.tags),this.parser=bd(Dr,{log:console.log.bind(console),pushInt:this.pushInt.bind(this),pushInt32:this.pushInt32.bind(this),pushInt32Neg:this.pushInt32Neg.bind(this),pushInt64:this.pushInt64.bind(this),pushInt64Neg:this.pushInt64Neg.bind(this),pushFloat:this.pushFloat.bind(this),pushFloatSingle:this.pushFloatSingle.bind(this),pushFloatDouble:this.pushFloatDouble.bind(this),pushTrue:this.pushTrue.bind(this),pushFalse:this.pushFalse.bind(this),pushUndefined:this.pushUndefined.bind(this),pushNull:this.pushNull.bind(this),pushInfinity:this.pushInfinity.bind(this),pushInfinityNeg:this.pushInfinityNeg.bind(this),pushNaN:this.pushNaN.bind(this),pushNaNNeg:this.pushNaNNeg.bind(this),pushArrayStart:this.pushArrayStart.bind(this),pushArrayStartFixed:this.pushArrayStartFixed.bind(this),pushArrayStartFixed32:this.pushArrayStartFixed32.bind(this),pushArrayStartFixed64:this.pushArrayStartFixed64.bind(this),pushObjectStart:this.pushObjectStart.bind(this),pushObjectStartFixed:this.pushObjectStartFixed.bind(this),pushObjectStartFixed32:this.pushObjectStartFixed32.bind(this),pushObjectStartFixed64:this.pushObjectStartFixed64.bind(this),pushByteString:this.pushByteString.bind(this),pushByteStringStart:this.pushByteStringStart.bind(this),pushUtf8String:this.pushUtf8String.bind(this),pushUtf8StringStart:this.pushUtf8StringStart.bind(this),pushSimpleUnassigned:this.pushSimpleUnassigned.bind(this),pushTagUnassigned:this.pushTagUnassigned.bind(this),pushTagStart:this.pushTagStart.bind(this),pushTagStart4:this.pushTagStart4.bind(this),pushTagStart8:this.pushTagStart8.bind(this),pushBreak:this.pushBreak.bind(this)},this._heap)}get _depth(){return this._parents.length}get _currentParent(){return this._parents[this._depth-1]}get _ref(){return this._currentParent.ref}_closeParent(){var e=this._parents.pop();if(e.length>0)throw new Error(`Missing ${e.length} elements`);switch(e.type){case Ae.PARENT.TAG:this._push(this.createTag(e.ref[0],e.ref[1]));break;case Ae.PARENT.BYTE_STRING:this._push(this.createByteString(e.ref,e.length));break;case Ae.PARENT.UTF8_STRING:this._push(this.createUtf8String(e.ref,e.length));break;case Ae.PARENT.MAP:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createMap(e.ref,e.length));break;case Ae.PARENT.OBJECT:if(e.values%2>0)throw new Error("Odd number of elements in the map");this._push(this.createObject(e.ref,e.length));break;case Ae.PARENT.ARRAY:this._push(this.createArray(e.ref,e.length));break}this._currentParent&&this._currentParent.type===Ae.PARENT.TAG&&this._dec()}_dec(){const e=this._currentParent;e.length<0||(e.length--,e.length===0&&this._closeParent())}_push(e,r){const n=this._currentParent;switch(n.values++,n.type){case Ae.PARENT.ARRAY:case Ae.PARENT.BYTE_STRING:case Ae.PARENT.UTF8_STRING:n.length>-1?this._ref[this._ref.length-n.length]=e:this._ref.push(e),this._dec();break;case Ae.PARENT.OBJECT:n.tmpKey!=null?(this._ref[n.tmpKey]=e,n.tmpKey=null,this._dec()):(n.tmpKey=e,typeof n.tmpKey!="string"&&(n.type=Ae.PARENT.MAP,n.ref=tt.buildMap(n.ref)));break;case Ae.PARENT.MAP:n.tmpKey!=null?(this._ref.set(n.tmpKey,e),n.tmpKey=null,this._dec()):n.tmpKey=e;break;case Ae.PARENT.TAG:this._ref.push(e),r||this._dec();break;default:throw new Error("Unknown parent type")}}_createParent(e,r,n){this._parents[this._depth]={type:r,length:n,ref:e,values:0,tmpKey:null}}_reset(){this._res=[],this._parents=[{type:Ae.PARENT.ARRAY,length:-1,ref:this._res,values:0,tmpKey:null}]}createTag(e,r){const n=this._knownTags[e];return n?n(r):new _d(e,r)}createMap(e,r){return e}createObject(e,r){return e}createArray(e,r){return e}createByteString(e,r){return kr.concat(e)}createByteStringFromHeap(e,r){return e===r?kr.alloc(0):kr.from(this._heap.slice(e,r))}createInt(e){return e}createInt32(e,r){return tt.buildInt32(e,r)}createInt64(e,r,n,i){return tt.buildInt64(e,r,n,i)}createFloat(e){return e}createFloatSingle(e,r,n,i){return vo.read([e,r,n,i],0,!1,23,4)}createFloatDouble(e,r,n,i,s,c,u,l){return vo.read([e,r,n,i,s,c,u,l],0,!1,52,8)}createInt32Neg(e,r){return-1-tt.buildInt32(e,r)}createInt64Neg(e,r,n,i){const s=tt.buildInt32(e,r),c=tt.buildInt32(n,i);return s>Ae.MAX_SAFE_HIGH?Ae.NEG_ONE.minus(new wd(s).times(Ae.SHIFT32).plus(c)):-1-(s*Ae.SHIFT32+c)}createTrue(){return!0}createFalse(){return!1}createNull(){return null}createUndefined(){}createInfinity(){return 1/0}createInfinityNeg(){return-1/0}createNaN(){return NaN}createNaNNeg(){return NaN}createUtf8String(e,r){return e.join("")}createUtf8StringFromHeap(e,r){return e===r?"":this._buffer.toString("utf8",e,r)}createSimpleUnassigned(e){return new md(e)}pushInt(e){this._push(this.createInt(e))}pushInt32(e,r){this._push(this.createInt32(e,r))}pushInt64(e,r,n,i){this._push(this.createInt64(e,r,n,i))}pushFloat(e){this._push(this.createFloat(e))}pushFloatSingle(e,r,n,i){this._push(this.createFloatSingle(e,r,n,i))}pushFloatDouble(e,r,n,i,s,c,u,l){this._push(this.createFloatDouble(e,r,n,i,s,c,u,l))}pushInt32Neg(e,r){this._push(this.createInt32Neg(e,r))}pushInt64Neg(e,r,n,i){this._push(this.createInt64Neg(e,r,n,i))}pushTrue(){this._push(this.createTrue())}pushFalse(){this._push(this.createFalse())}pushNull(){this._push(this.createNull())}pushUndefined(){this._push(this.createUndefined())}pushInfinity(){this._push(this.createInfinity())}pushInfinityNeg(){this._push(this.createInfinityNeg())}pushNaN(){this._push(this.createNaN())}pushNaNNeg(){this._push(this.createNaNNeg())}pushArrayStart(){this._createParent([],Ae.PARENT.ARRAY,-1)}pushArrayStartFixed(e){this._createArrayStartFixed(e)}pushArrayStartFixed32(e,r){const n=tt.buildInt32(e,r);this._createArrayStartFixed(n)}pushArrayStartFixed64(e,r,n,i){const s=tt.buildInt64(e,r,n,i);this._createArrayStartFixed(s)}pushObjectStart(){this._createObjectStartFixed(-1)}pushObjectStartFixed(e){this._createObjectStartFixed(e)}pushObjectStartFixed32(e,r){const n=tt.buildInt32(e,r);this._createObjectStartFixed(n)}pushObjectStartFixed64(e,r,n,i){const s=tt.buildInt64(e,r,n,i);this._createObjectStartFixed(s)}pushByteStringStart(){this._parents[this._depth]={type:Ae.PARENT.BYTE_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushByteString(e,r){this._push(this.createByteStringFromHeap(e,r))}pushUtf8StringStart(){this._parents[this._depth]={type:Ae.PARENT.UTF8_STRING,length:-1,ref:[],values:0,tmpKey:null}}pushUtf8String(e,r){this._push(this.createUtf8StringFromHeap(e,r))}pushSimpleUnassigned(e){this._push(this.createSimpleUnassigned(e))}pushTagStart(e){this._parents[this._depth]={type:Ae.PARENT.TAG,length:1,ref:[e]}}pushTagStart4(e,r){this.pushTagStart(tt.buildInt32(e,r))}pushTagStart8(e,r,n,i){this.pushTagStart(tt.buildInt64(e,r,n,i))}pushTagUnassigned(e){this._push(this.createTag(e))}pushBreak(){if(this._currentParent.length>-1)throw new Error("Unexpected break");this._closeParent()}_createObjectStartFixed(e){if(e===0){this._push(this.createObject({}));return}this._createParent({},Ae.PARENT.OBJECT,e)}_createArrayStartFixed(e){if(e===0){this._push(this.createArray([]));return}this._createParent(new Array(e),Ae.PARENT.ARRAY,e)}_decode(e){if(e.byteLength===0)throw new Error("Input too short");this._reset(),this._heap8.set(e);const r=this.parser.parse(e.byteLength);if(this._depth>1){for(;this._currentParent.length===0;)this._closeParent();if(this._depth>1)throw new Error("Undeterminated nesting")}if(r>0)throw new Error("Failed to parse");if(this._res.length===0)throw new Error("No valid result")}decodeFirst(e){return this._decode(e),this._res[0]}decodeAll(e){return this._decode(e),this._res}static decode(e,r){return typeof e=="string"&&(e=kr.from(e,r||"hex")),new wa({size:e.length}).decodeFirst(e)}static decodeAll(e,r){return typeof e=="string"&&(e=kr.from(e,r||"hex")),new wa({size:e.length}).decodeAll(e)}};ya.decodeFirst=ya.decode;var Pu=ya;const{Buffer:Vs}=qn,xd=Pu,Ed=ps;class Ka extends xd{createTag(e,r){return`${e}(${r})`}createInt(e){return super.createInt(e).toString()}createInt32(e,r){return super.createInt32(e,r).toString()}createInt64(e,r,n,i){return super.createInt64(e,r,n,i).toString()}createInt32Neg(e,r){return super.createInt32Neg(e,r).toString()}createInt64Neg(e,r,n,i){return super.createInt64Neg(e,r,n,i).toString()}createTrue(){return"true"}createFalse(){return"false"}createFloat(e){const r=super.createFloat(e);return Ed.isNegativeZero(e)?"-0_1":`${r}_1`}createFloatSingle(e,r,n,i){return`${super.createFloatSingle(e,r,n,i)}_2`}createFloatDouble(e,r,n,i,s,c,u,l){return`${super.createFloatDouble(e,r,n,i,s,c,u,l)}_3`}createByteString(e,r){const n=e.join(", ");return r===-1?`(_ ${n})`:`h'${n}`}createByteStringFromHeap(e,r){return`h'${Vs.from(super.createByteStringFromHeap(e,r)).toString("hex")}'`}createInfinity(){return"Infinity_1"}createInfinityNeg(){return"-Infinity_1"}createNaN(){return"NaN_1"}createNaNNeg(){return"-NaN_1"}createNull(){return"null"}createUndefined(){return"undefined"}createSimpleUnassigned(e){return`simple(${e})`}createArray(e,r){const n=super.createArray(e,r);return r===-1?`[_ ${n.join(", ")}]`:`[${n.join(", ")}]`}createMap(e,r){const n=super.createMap(e),i=Array.from(n.keys()).reduce(xo(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createObject(e,r){const n=super.createObject(e),i=Object.keys(n).reduce(xo(n),"");return r===-1?`{_ ${i}}`:`{${i}}`}createUtf8String(e,r){const n=e.join(", ");return r===-1?`(_ ${n})`:`"${n}"`}createUtf8StringFromHeap(e,r){return`"${Vs.from(super.createUtf8StringFromHeap(e,r)).toString("utf8")}"`}static diagnose(e,r){return typeof e=="string"&&(e=Vs.from(e,r||"hex")),new Ka().decodeFirst(e)}}var Td=Ka;function xo(t){return(e,r)=>e?`${e}, ${r}: ${t[r]}`:`${r}: ${t[r]}`}const{Buffer:Ct}=qn,{URL:Sd}=Fu,ba=hs.BigNumber,qs=ps,He=De,_t=He.MT,Dn=He.NUMBYTES,Eo=He.SHIFT32,To=He.SYMS,Cr=He.TAG,Ad=He.MT.SIMPLE_FLOAT<<5|He.NUMBYTES.TWO,Nd=He.MT.SIMPLE_FLOAT<<5|He.NUMBYTES.FOUR,Bd=He.MT.SIMPLE_FLOAT<<5|He.NUMBYTES.EIGHT,Rd=He.MT.SIMPLE_FLOAT<<5|He.SIMPLE.TRUE,Od=He.MT.SIMPLE_FLOAT<<5|He.SIMPLE.FALSE,Ud=He.MT.SIMPLE_FLOAT<<5|He.SIMPLE.UNDEFINED,So=He.MT.SIMPLE_FLOAT<<5|He.SIMPLE.NULL,Fd=new ba("0x20000000000000"),Pd=Ct.from("f97e00","hex"),Id=Ct.from("f9fc00","hex"),kd=Ct.from("f97c00","hex");function Cd(t){return{}.toString.call(t).slice(8,-1)}class Wi{constructor(e){e=e||{},this.streaming=typeof e.stream=="function",this.onData=e.stream,this.semanticTypes=[[Sd,this._pushUrl],[ba,this._pushBigNumber]];const r=e.genTypes||[],n=r.length;for(let i=0;i<n;i++)this.addSemanticType(r[i][0],r[i][1]);this._reset()}addSemanticType(e,r){const n=this.semanticTypes.length;for(let i=0;i<n;i++)if(this.semanticTypes[i][0]===e){const c=this.semanticTypes[i][1];return this.semanticTypes[i][1]=r,c}return this.semanticTypes.push([e,r]),null}push(e){return e&&(this.result[this.offset]=e,this.resultMethod[this.offset]=0,this.resultLength[this.offset]=e.length,this.offset++,this.streaming&&this.onData(this.finalize())),!0}pushWrite(e,r,n){return this.result[this.offset]=e,this.resultMethod[this.offset]=r,this.resultLength[this.offset]=n,this.offset++,this.streaming&&this.onData(this.finalize()),!0}_pushUInt8(e){return this.pushWrite(e,1,1)}_pushUInt16BE(e){return this.pushWrite(e,2,2)}_pushUInt32BE(e){return this.pushWrite(e,3,4)}_pushDoubleBE(e){return this.pushWrite(e,4,8)}_pushNaN(){return this.push(Pd)}_pushInfinity(e){const r=e<0?Id:kd;return this.push(r)}_pushFloat(e){const r=Ct.allocUnsafe(2);if(qs.writeHalf(r,e)&&qs.parseHalf(r)===e)return this._pushUInt8(Ad)&&this.push(r);const n=Ct.allocUnsafe(4);return n.writeFloatBE(e,0),n.readFloatBE(0)===e?this._pushUInt8(Nd)&&this.push(n):this._pushUInt8(Bd)&&this._pushDoubleBE(e)}_pushInt(e,r,n){const i=r<<5;return e<24?this._pushUInt8(i|e):e<=255?this._pushUInt8(i|Dn.ONE)&&this._pushUInt8(e):e<=65535?this._pushUInt8(i|Dn.TWO)&&this._pushUInt16BE(e):e<=4294967295?this._pushUInt8(i|Dn.FOUR)&&this._pushUInt32BE(e):e<=Number.MAX_SAFE_INTEGER?this._pushUInt8(i|Dn.EIGHT)&&this._pushUInt32BE(Math.floor(e/Eo))&&this._pushUInt32BE(e%Eo):r===_t.NEG_INT?this._pushFloat(n):this._pushFloat(e)}_pushIntNum(e){return e<0?this._pushInt(-e-1,_t.NEG_INT,e):this._pushInt(e,_t.POS_INT)}_pushNumber(e){switch(!1){case e===e:return this._pushNaN(e);case isFinite(e):return this._pushInfinity(e);case e%1!==0:return this._pushIntNum(e);default:return this._pushFloat(e)}}_pushString(e){const r=Ct.byteLength(e,"utf8");return this._pushInt(r,_t.UTF8_STRING)&&this.pushWrite(e,5,r)}_pushBoolean(e){return this._pushUInt8(e?Rd:Od)}_pushUndefined(e){return this._pushUInt8(Ud)}_pushArray(e,r){const n=r.length;if(!e._pushInt(n,_t.ARRAY))return!1;for(let i=0;i<n;i++)if(!e.pushAny(r[i]))return!1;return!0}_pushTag(e){return this._pushInt(e,_t.TAG)}_pushDate(e,r){return e._pushTag(Cr.DATE_EPOCH)&&e.pushAny(Math.round(r/1e3))}_pushBuffer(e,r){return e._pushInt(r.length,_t.BYTE_STRING)&&e.push(r)}_pushNoFilter(e,r){return e._pushBuffer(e,r.slice())}_pushRegexp(e,r){return e._pushTag(Cr.REGEXP)&&e.pushAny(r.source)}_pushSet(e,r){if(!e._pushInt(r.size,_t.ARRAY))return!1;for(const n of r)if(!e.pushAny(n))return!1;return!0}_pushUrl(e,r){return e._pushTag(Cr.URI)&&e.pushAny(r.format())}_pushBigint(e){let r=Cr.POS_BIGINT;e.isNegative()&&(e=e.negated().minus(1),r=Cr.NEG_BIGINT);let n=e.toString(16);n.length%2&&(n="0"+n);const i=Ct.from(n,"hex");return this._pushTag(r)&&this._pushBuffer(this,i)}_pushBigNumber(e,r){if(r.isNaN())return e._pushNaN();if(!r.isFinite())return e._pushInfinity(r.isNegative()?-1/0:1/0);if(r.isInteger())return e._pushBigint(r);if(!(e._pushTag(Cr.DECIMAL_FRAC)&&e._pushInt(2,_t.ARRAY)))return!1;const n=r.decimalPlaces(),i=r.multipliedBy(new ba(10).pow(n));return e._pushIntNum(-n)?i.abs().isLessThan(Fd)?e._pushIntNum(i.toNumber()):e._pushBigint(i):!1}_pushMap(e,r){return e._pushInt(r.size,_t.MAP)?this._pushRawMap(r.size,Array.from(r)):!1}_pushObject(e){if(!e)return this._pushUInt8(So);for(var r=this.semanticTypes.length,n=0;n<r;n++)if(e instanceof this.semanticTypes[n][0])return this.semanticTypes[n][1].call(e,this,e);var i=e.encodeCBOR;if(typeof i=="function")return i.call(e,this);var s=Object.keys(e),c=s.length;return this._pushInt(c,_t.MAP)?this._pushRawMap(c,s.map(u=>[u,e[u]])):!1}_pushRawMap(e,r){r=r.map(function(i){return i[0]=Wi.encode(i[0]),i}).sort(qs.keySorter);for(var n=0;n<e;n++)if(!this.push(r[n][0])||!this.pushAny(r[n][1]))return!1;return!0}write(e){return this.pushAny(e)}pushAny(e){var r=Cd(e);switch(r){case"Number":return this._pushNumber(e);case"String":return this._pushString(e);case"Boolean":return this._pushBoolean(e);case"Object":return this._pushObject(e);case"Array":return this._pushArray(this,e);case"Uint8Array":return this._pushBuffer(this,Ct.isBuffer(e)?e:Ct.from(e));case"Null":return this._pushUInt8(So);case"Undefined":return this._pushUndefined(e);case"Map":return this._pushMap(this,e);case"Set":return this._pushSet(this,e);case"URL":return this._pushUrl(this,e);case"BigNumber":return this._pushBigNumber(this,e);case"Date":return this._pushDate(this,e);case"RegExp":return this._pushRegexp(this,e);case"Symbol":switch(e){case To.NULL:return this._pushObject(null);case To.UNDEFINED:return this._pushUndefined(void 0);default:throw new Error("Unknown symbol: "+e.toString())}default:throw new Error("Unknown type: "+typeof e+", "+(e?e.toString():""))}}finalize(){if(this.offset===0)return null;for(var e=this.result,r=this.resultLength,n=this.resultMethod,i=this.offset,s=0,c=0;c<i;c++)s+=r[c];var u=Ct.allocUnsafe(s),l=0,p=0;for(c=0;c<i;c++){switch(p=r[c],n[c]){case 0:e[c].copy(u,l);break;case 1:u.writeUInt8(e[c],l,!0);break;case 2:u.writeUInt16BE(e[c],l,!0);break;case 3:u.writeUInt32BE(e[c],l,!0);break;case 4:u.writeDoubleBE(e[c],l,!0);break;case 5:u.write(e[c],l,p,"utf8");break;default:throw new Error("unkown method")}l+=p}var b=u;return this._reset(),b}_reset(){this.result=[],this.resultMethod=[],this.resultLength=[],this.offset=0}static encode(e){const r=new Wi;if(!r.pushAny(e))throw new Error("Failed to encode input");return r.finalize()}}var Md=Wi;(function(t){t.Diagnose=Td,t.Decoder=Pu,t.Encoder=Md,t.Simple=Bu,t.Tagged=Ru,t.decodeAll=t.Decoder.decodeAll,t.decodeFirst=t.Decoder.decodeFirst,t.diagnose=t.Diagnose.diagnose,t.encode=t.Encoder.encode,t.decode=t.Decoder.decode,t.leveldb={decode:t.Decoder.decodeAll,encode:t.Encoder.encode,buffer:!0,name:"cbor"}})(Au);const Iu=Pl(Au);function At(t){return Nn(Ma.create().update(new Uint8Array(t)).digest())}function gi(t){if(t instanceof Iu.Tagged)return gi(t.value);if(typeof t=="string")return ku(t);if(typeof t=="number")return At(Ie(t));if(t instanceof ArrayBuffer||ArrayBuffer.isView(t))return At(t);if(Array.isArray(t)){const e=t.map(gi);return At(Nt(...e))}else{if(t&&typeof t=="object"&&t._isPrincipal)return At(t.toUint8Array());if(typeof t=="object"&&t!==null&&typeof t.toHash=="function")return gi(t.toHash());if(typeof t=="object")return Yi(t);if(typeof t=="bigint")return At(Ie(t))}throw Object.assign(new Error(`Attempt to hash a value of unsupported type: ${t}`),{value:t})}const ku=t=>{const e=new TextEncoder().encode(t);return At(e)};function Pn(t){return Yi(t)}function Yi(t){const n=Object.entries(t).filter(([,c])=>c!==void 0).map(([c,u])=>{const l=ku(c),p=gi(u);return[l,p]}).sort(([c],[u])=>Vc(c,u)),i=Nt(...n.map(c=>Nt(...c)));return At(i)}var $d=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r};const Gd=new TextEncoder().encode(`
ic-request`);class za{getPrincipal(){return this._principal||(this._principal=ye.selfAuthenticating(new Uint8Array(this.getPublicKey().toDer()))),this._principal}async transformRequest(e){const{body:r}=e,n=$d(e,["body"]),i=Pn(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_pubkey:this.getPublicKey().toDer(),sender_sig:await this.sign(Nt(Gd,i))}})}}class Zi{getPrincipal(){return ye.anonymous()}async transformRequest(e){return Object.assign(Object.assign({},e),{body:{content:e.body}})}}var ct={},sn={},Be={};Object.defineProperty(Be,"__esModule",{value:!0});const Vd=9007199254740992;function Lt(t,...e){const r=new Uint8Array(t.byteLength+e.reduce((i,s)=>i+s.byteLength,0));r.set(new Uint8Array(t),0);let n=t.byteLength;for(const i of e)r.set(new Uint8Array(i),n),n+=i.byteLength;return r.buffer}function Bt(t,e,r){r=r.replace(/[^0-9a-fA-F]/g,"");const n=2**(e-24);r=r.slice(-n*2).padStart(n*2,"0");const i=[(t<<5)+e].concat(r.match(/../g).map(s=>parseInt(s,16)));return new Uint8Array(i).buffer}function gs(t,e){if(e<24)return new Uint8Array([(t<<5)+e]).buffer;{const r=e<=255?24:e<=65535?25:e<=4294967295?26:27;return Bt(t,r,e.toString(16))}}function Cu(t){const e=[];for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n<128?e.push(n):n<2048?e.push(192|n>>6,128|n&63):n<55296||n>=57344?e.push(224|n>>12,128|n>>6&63,128|n&63):(r++,n=(n&1023)<<10|t.charCodeAt(r)&1023,e.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|n&63))}return Lt(new Uint8Array(gs(3,t.length)),new Uint8Array(e))}function qd(t,e){if(t==14277111)return Lt(new Uint8Array([217,217,247]),e);if(t<24)return Lt(new Uint8Array([192+t]),e);{const r=t<=255?24:t<=65535?25:t<=4294967295?26:27,n=2**(r-24),i=t.toString(16).slice(-n*2).padStart(n*2,"0"),s=[192+r].concat(i.match(/../g).map(c=>parseInt(c,16)));return new Uint8Array(s).buffer}}Be.tagged=qd;function Hn(t){return new Uint8Array(t).buffer}Be.raw=Hn;function Wa(t){if(isNaN(t))throw new RangeError("Invalid number.");t=Math.min(Math.max(0,t),23);const e=[0+t];return new Uint8Array(e).buffer}Be.uSmall=Wa;function Mu(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),255),t=t.toString(16),Bt(0,24,t)}Be.u8=Mu;function $u(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),65535),t=t.toString(16),Bt(0,25,t)}Be.u16=$u;function Gu(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),4294967295),t=t.toString(16),Bt(0,26,t)}Be.u32=Gu;function Ya(t,e){if(typeof t=="string"&&e==16){if(t.match(/[^0-9a-fA-F]/))throw new RangeError("Invalid number.");return Bt(0,27,t)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,t),Vd),t=t.toString(16),Bt(0,27,t)}Be.u64=Ya;function Vu(t){if(isNaN(t))throw new RangeError("Invalid number.");if(t===0)return Wa(0);t=Math.min(Math.max(0,-t),24)-1;const e=[32+t];return new Uint8Array(e).buffer}Be.iSmall=Vu;function qu(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),255),t=t.toString(16),Bt(1,24,t)}Be.i8=qu;function Hu(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),65535),t=t.toString(16),Bt(1,25,t)}Be.i16=Hu;function ju(t,e){if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),4294967295),t=t.toString(16),Bt(1,26,t)}Be.i32=ju;function Ku(t,e){if(typeof t=="string"&&e==16){if(t.startsWith("-")?t=t.slice(1):t="0",t.match(/[^0-9a-fA-F]/)||t.length>16)throw new RangeError("Invalid number.");let r=!1,n=t.split("").reduceRight((i,s)=>{if(r)return s+i;let c=parseInt(s,16)-1;return c>=0?(r=!0,c.toString(16)+i):"f"+i},"");return r?Bt(1,27,n):Ya(0)}if(t=parseInt(""+t,e),isNaN(t))throw new RangeError("Invalid number.");return t=Math.min(Math.max(0,-t-1),9007199254740992),t=t.toString(16),Bt(1,27,t)}Be.i64=Ku;function Hd(t){return t>=0?t<24?Wa(t):t<=255?Mu(t):t<=65535?$u(t):t<=4294967295?Gu(t):Ya(t):t>=-24?Vu(t):t>=-255?qu(t):t>=-65535?Hu(t):t>=-4294967295?ju(t):Ku(t)}Be.number=Hd;function jd(t){return Lt(gs(2,t.byteLength),t)}Be.bytes=jd;function Kd(t){return Cu(t)}Be.string=Kd;function zd(t){return Lt(gs(4,t.length),...t)}Be.array=zd;function Wd(t,e=!1){t instanceof Map||(t=new Map(Object.entries(t)));let r=Array.from(t.entries());return e&&(r=r.sort(([n],[i])=>n.localeCompare(i))),Lt(gs(5,t.size),...r.map(([n,i])=>Lt(Cu(n),i)))}Be.map=Wd;function Yd(t){const e=new Float32Array([t]);return Lt(new Uint8Array([250]),new Uint8Array(e.buffer))}Be.singleFloat=Yd;function Zd(t){const e=new Float64Array([t]);return Lt(new Uint8Array([251]),new Uint8Array(e.buffer))}Be.doubleFloat=Zd;function Xd(t){return t?zu():Wu()}Be.bool=Xd;function zu(){return Hn(new Uint8Array([245]))}Be.true_=zu;function Wu(){return Hn(new Uint8Array([244]))}Be.false_=Wu;function Jd(){return Hn(new Uint8Array([246]))}Be.null_=Jd;function Qd(){return Hn(new Uint8Array([247]))}Be.undefined_=Qd;var Ld=Dr&&Dr.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(sn,"__esModule",{value:!0});const xt=Ld(Be),Dd=[ArrayBuffer,Uint8Array,Uint16Array,Uint32Array,Int8Array,Int16Array,Int32Array,Float32Array,Float64Array];class Yu{constructor(e,r=!1){this._serializer=e,this._stable=r,this.name="jsonDefault",this.priority=-100}match(e){return["undefined","boolean","number","string","object"].indexOf(typeof e)!=-1}encode(e){switch(typeof e){case"undefined":return xt.undefined_();case"boolean":return xt.bool(e);case"number":return Math.floor(e)===e?xt.number(e):xt.doubleFloat(e);case"string":return xt.string(e);case"object":if(e===null)return xt.null_();if(Array.isArray(e))return xt.array(e.map(r=>this._serializer.serializeValue(r)));if(Dd.find(r=>e instanceof r))return xt.bytes(e.buffer);if(Object.getOwnPropertyNames(e).indexOf("toJSON")!==-1)return this.encode(e.toJSON());if(e instanceof Map){const r=new Map;for(const[n,i]of e.entries())r.set(n,this._serializer.serializeValue(i));return xt.map(r,this._stable)}else{const r=new Map;for(const[n,i]of Object.entries(e))r.set(n,this._serializer.serializeValue(i));return xt.map(r,this._stable)}default:throw new Error("Invalid value.")}}}sn.JsonDefaultCborEncoder=Yu;class Zu{constructor(){this.name="cborEncoder",this.priority=-90}match(e){return typeof e=="object"&&typeof e.toCBOR=="function"}encode(e){return e.toCBOR()}}sn.ToCborEncoder=Zu;class Xu{constructor(){this._encoders=new Set}static withDefaultEncoders(e=!1){const r=new this;return r.addEncoder(new Yu(r,e)),r.addEncoder(new Zu),r}removeEncoder(e){for(const r of this._encoders.values())r.name==e&&this._encoders.delete(r)}addEncoder(e){this._encoders.add(e)}getEncoderFor(e){let r=null;for(const n of this._encoders)(!r||n.priority>r.priority)&&n.match(e)&&(r=n);if(r===null)throw new Error("Could not find an encoder for value.");return r}serializeValue(e){return this.getEncoderFor(e).encode(e)}serialize(e){return this.serializeValue(e)}}sn.CborSerializer=Xu;class e0 extends Xu{serialize(e){return xt.raw(new Uint8Array([...new Uint8Array([217,217,247]),...new Uint8Array(super.serializeValue(e))]))}}sn.SelfDescribeCborSerializer=e0;(function(t){function e(i){for(var s in i)t.hasOwnProperty(s)||(t[s]=i[s])}var r=Dr&&Dr.__importStar||function(i){if(i&&i.__esModule)return i;var s={};if(i!=null)for(var c in i)Object.hasOwnProperty.call(i,c)&&(s[c]=i[c]);return s.default=i,s};Object.defineProperty(t,"__esModule",{value:!0}),e(sn);const n=r(Be);t.value=n})(ct);class t0{get name(){return"Principal"}get priority(){return 0}match(e){return e&&e._isPrincipal===!0}encode(e){return ct.value.bytes(e.toUint8Array())}}class r0{get name(){return"Buffer"}get priority(){return 1}match(e){return e instanceof ArrayBuffer||ArrayBuffer.isView(e)}encode(e){return ct.value.bytes(new Uint8Array(e))}}class n0{get name(){return"BigInt"}get priority(){return 1}match(e){return typeof e=="bigint"}encode(e){return e>BigInt(0)?ct.value.tagged(2,ct.value.bytes(Qt(e.toString(16)))):ct.value.tagged(3,ct.value.bytes(Qt((BigInt("-1")*e).toString(16))))}}const ys=ct.SelfDescribeCborSerializer.withDefaultEncoders(!0);ys.addEncoder(new t0);ys.addEncoder(new r0);ys.addEncoder(new n0);var ma;(function(t){t[t.Uint64LittleEndian=71]="Uint64LittleEndian",t[t.Semantic=55799]="Semantic"})(ma||(ma={}));function Hs(t){return ys.serialize(t)}function Ao(t){const e=t.byteLength;let r=BigInt(0);for(let n=0;n<e;n++)r=r*BigInt(256)+BigInt(t[n]);return r}class i0 extends Iu.Decoder{createByteString(e){return Nt(...e)}createByteStringFromHeap(e,r){return e===r?new ArrayBuffer(0):new Uint8Array(this._heap.slice(e,r))}}function Zt(t){const e=new Uint8Array(t),r=new i0({size:e.byteLength,tags:{2:n=>Ao(n),3:n=>-Ao(n),[ma.Semantic]:n=>n}});try{return r.decodeFirst(e)}catch(n){throw new Error(`Failed to decode CBOR: ${n}, input: ${Re(e)}`)}}const ei=()=>{if(typeof window<"u"&&window.crypto&&window.crypto.getRandomValues){const t=new Uint32Array(1);return window.crypto.getRandomValues(t),t[0]}if(typeof crypto<"u"&&crypto.getRandomValues){const t=new Uint32Array(1);return crypto.getRandomValues(t),t[0]}return typeof crypto<"u"&&crypto.randomInt?crypto.randomInt(0,4294967295):Math.floor(Math.random()*4294967295)};var _a;(function(t){t.Call="call"})(_a||(_a={}));function va(){const t=new ArrayBuffer(16),e=new DataView(t),r=ei(),n=ei(),i=ei(),s=ei();return e.setUint32(0,r),e.setUint32(4,n),e.setUint32(8,i),e.setUint32(12,s),t}const No=BigInt(1e6),s0=60*1e3;class ti{constructor(e){if(e<90*1e3){const u=BigInt(Date.now()+e)*No/BigInt(1e9);this._value=u*BigInt(1e9);return}const s=BigInt(Math.floor(Date.now()+e-s0))*No/BigInt(1e9)/BigInt(60)*BigInt(60)*BigInt(1e9);this._value=s}toCBOR(){return ct.value.u64(this._value.toString(16),16)}toHash(){return Ie(this._value)}}function Bo(t=va){return async e=>{const r=e.request.headers;e.request.headers=r,e.endpoint==="call"&&(e.body.nonce=t())}}function wn(t){const e=[];return t.forEach((r,n)=>{e.push([n,r])}),e}class js extends Pe{constructor(e,r){super(e),this.response=r,this.name=this.constructor.name,Object.setPrototypeOf(this,new.target.prototype)}}class a0 extends Pe{constructor(e,r,n,i,s,c){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=c,this.name="AgentCallError",Object.setPrototypeOf(this,new.target.prototype)}}class o0 extends Pe{constructor(e,r,n,i,s,c){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=c,this.name="AgentQueryError",Object.setPrototypeOf(this,new.target.prototype)}}class c0 extends Pe{constructor(e,r,n,i,s,c){super(e),this.response=r,this.requestId=n,this.senderPubkey=i,this.senderSig=s,this.ingressExpiry=c,this.name="AgentReadStateError",Object.setPrototypeOf(this,new.target.prototype)}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Za=BigInt(0),Xa=BigInt(1),u0=BigInt(2);function ws(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function br(t){if(!ws(t))throw new Error("Uint8Array expected")}function Bn(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const f0=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Pr(t){br(t);let e="";for(let r=0;r<t.length;r++)e+=f0[t[r]];return e}function Ju(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Za:BigInt("0x"+t)}const qt={_0:48,_9:57,A:65,F:70,a:97,f:102};function Ro(t){if(t>=qt._0&&t<=qt._9)return t-qt._0;if(t>=qt.A&&t<=qt.F)return t-(qt.A-10);if(t>=qt.a&&t<=qt.f)return t-(qt.a-10)}function Qu(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let i=0,s=0;i<r;i++,s+=2){const c=Ro(t.charCodeAt(s)),u=Ro(t.charCodeAt(s+1));if(c===void 0||u===void 0){const l=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+l+'" at index '+s)}n[i]=c*16+u}return n}function St(t){return Ju(Pr(t))}function Rn(t){return br(t),Ju(Pr(Uint8Array.from(t).reverse()))}function Xe(t,e){return Qu(t.toString(16).padStart(e*2,"0"))}function Xi(t,e){return Xe(t,e).reverse()}function it(t,e,r){let n;if(typeof e=="string")try{n=Qu(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(ws(e))n=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const i=n.length;if(typeof r=="number"&&i!==r)throw new Error(t+" of length "+r+" expected, got "+i);return n}function Ge(...t){let e=0;for(let n=0;n<t.length;n++){const i=t[n];br(i),e+=i.length}const r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){const s=t[n];r.set(s,i),i+=s.length}return r}function Ja(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}const Ks=t=>typeof t=="bigint"&&Za<=t;function Lu(t,e,r){return Ks(t)&&Ks(e)&&Ks(r)&&e<=t&&t<r}function lr(t,e,r,n){if(!Lu(e,r,n))throw new Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function On(t){let e;for(e=0;t>Za;t>>=Xa,e+=1);return e}function l0(t,e){return t>>BigInt(e)&Xa}const yi=t=>(u0<<BigInt(t-1))-Xa,d0={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||ws(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function jn(t,e,r={}){const n=(i,s,c)=>{const u=d0[s];if(typeof u!="function")throw new Error("invalid validator function");const l=t[i];if(!(c&&l===void 0)&&!u(l,t))throw new Error("param "+String(i)+" is invalid. Expected "+s+", got "+l)};for(const[i,s]of Object.entries(e))n(i,s,!1);for(const[i,s]of Object.entries(r))n(i,s,!0);return t}const Oo=()=>{throw new Error("not implemented")};function In(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(i!==void 0)return i;const s=t(r,...n);return e.set(r,s),s}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ye=BigInt(0),Oe=BigInt(1),dr=BigInt(2),h0=BigInt(3),xa=BigInt(4),Uo=BigInt(5),Fo=BigInt(8);function Fe(t,e){const r=t%e;return r>=Ye?r:e+r}function p0(t,e,r){if(e<Ye)throw new Error("invalid exponent, negatives unsupported");if(r<=Ye)throw new Error("invalid modulus");if(r===Oe)return Ye;let n=Oe;for(;e>Ye;)e&Oe&&(n=n*t%r),t=t*t%r,e>>=Oe;return n}function Ut(t,e,r){let n=t;for(;e-- >Ye;)n*=n,n%=r;return n}function Po(t,e){if(t===Ye)throw new Error("invert: expected non-zero number");if(e<=Ye)throw new Error("invert: expected positive modulus, got "+e);let r=Fe(t,e),n=e,i=Ye,s=Oe;for(;r!==Ye;){const u=n/r,l=n%r,p=i-s*u;n=r,r=l,i=s,s=p}if(n!==Oe)throw new Error("invert: does not exist");return Fe(i,e)}function g0(t){const e=(t-Oe)/dr;let r,n,i;for(r=t-Oe,n=0;r%dr===Ye;r/=dr,n++);for(i=dr;i<t&&p0(i,e,t)!==t-Oe;i++)if(i>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const c=(t+Oe)/xa;return function(l,p){const b=l.pow(p,c);if(!l.eql(l.sqr(b),p))throw new Error("Cannot find square root");return b}}const s=(r+Oe)/dr;return function(u,l){if(u.pow(l,e)===u.neg(u.ONE))throw new Error("Cannot find square root");let p=n,b=u.pow(u.mul(u.ONE,i),r),x=u.pow(l,s),_=u.pow(l,r);for(;!u.eql(_,u.ONE);){if(u.eql(_,u.ZERO))return u.ZERO;let v=1;for(let A=u.sqr(_);v<p&&!u.eql(A,u.ONE);v++)A=u.sqr(A);const d=u.pow(b,Oe<<BigInt(p-v-1));b=u.sqr(d),x=u.mul(x,d),_=u.mul(_,b),p=v}return x}}function y0(t){if(t%xa===h0){const e=(t+Oe)/xa;return function(n,i){const s=n.pow(i,e);if(!n.eql(n.sqr(s),i))throw new Error("Cannot find square root");return s}}if(t%Fo===Uo){const e=(t-Uo)/Fo;return function(n,i){const s=n.mul(i,dr),c=n.pow(s,e),u=n.mul(i,c),l=n.mul(n.mul(u,dr),c),p=n.mul(u,n.sub(l,n.ONE));if(!n.eql(n.sqr(p),i))throw new Error("Cannot find square root");return p}}return g0(t)}const w0=(t,e)=>(Fe(t,e)&Oe)===Oe,b0=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function Du(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=b0.reduce((n,i)=>(n[i]="function",n),e);return jn(t,r)}function wi(t,e,r){if(r<Ye)throw new Error("invalid exponent, negatives unsupported");if(r===Ye)return t.ONE;if(r===Oe)return e;let n=t.ONE,i=e;for(;r>Ye;)r&Oe&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Oe;return n}function bi(t,e){const r=new Array(e.length),n=e.reduce((s,c,u)=>t.is0(c)?s:(r[u]=s,t.mul(s,c)),t.ONE),i=t.inv(n);return e.reduceRight((s,c,u)=>t.is0(c)?s:(r[u]=t.mul(s,r[u]),t.mul(s,c)),i),r}function m0(t){const e=(t-Oe)/dr;return(r,n)=>r.pow(n,e)}function ef(t,e){const r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Kn(t,e,r=!1,n={}){if(t<=Ye)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:i,nByteLength:s}=ef(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let c;const u=Object.freeze({ORDER:t,isLE:r,BITS:i,BYTES:s,MASK:yi(i),ZERO:Ye,ONE:Oe,create:l=>Fe(l,t),isValid:l=>{if(typeof l!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof l);return Ye<=l&&l<t},is0:l=>l===Ye,isOdd:l=>(l&Oe)===Oe,neg:l=>Fe(-l,t),eql:(l,p)=>l===p,sqr:l=>Fe(l*l,t),add:(l,p)=>Fe(l+p,t),sub:(l,p)=>Fe(l-p,t),mul:(l,p)=>Fe(l*p,t),pow:(l,p)=>wi(u,l,p),div:(l,p)=>Fe(l*Po(p,t),t),sqrN:l=>l*l,addN:(l,p)=>l+p,subN:(l,p)=>l-p,mulN:(l,p)=>l*p,inv:l=>Po(l,t),sqrt:n.sqrt||(l=>(c||(c=y0(t)),c(u,l))),invertBatch:l=>bi(u,l),cmov:(l,p,b)=>b?p:l,toBytes:l=>r?Xi(l,s):Xe(l,s),fromBytes:l=>{if(l.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+l.length);return r?Rn(l):St(l)}});return Object.freeze(u)}function tf(t){if(typeof t!="bigint")throw new Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function rf(t){const e=tf(t);return e+Math.ceil(e/2)}function _0(t,e,r=!1){const n=t.length,i=tf(e),s=rf(e);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);const c=r?Rn(t):St(t),u=Fe(c,e-Oe)+Oe;return r?Xi(u,i):Xe(u,i)}const v0=St;function or(t,e){if(kn(t),kn(e),t<0||t>=1<<8*e)throw new Error("invalid I2OSP input: "+t);const r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=t&255,t>>>=8;return new Uint8Array(r)}function x0(t,e){const r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function kn(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function E0(t,e,r,n){br(t),br(e),kn(r),e.length>255&&(e=n(Ge(Ja("H2C-OVERSIZE-DST-"),e)));const{outputLen:i,blockLen:s}=n,c=Math.ceil(r/i);if(r>65535||c>255)throw new Error("expand_message_xmd: invalid lenInBytes");const u=Ge(e,or(e.length,1)),l=or(0,s),p=or(r,2),b=new Array(c),x=n(Ge(l,t,p,or(0,1),u));b[0]=n(Ge(x,or(1,1),u));for(let v=1;v<=c;v++){const d=[x0(x,b[v-1]),or(v+1,1),u];b[v]=n(Ge(...d))}return Ge(...b).slice(0,r)}function T0(t,e,r,n,i){if(br(t),br(e),kn(r),e.length>255){const s=Math.ceil(2*n/8);e=i.create({dkLen:s}).update(Ja("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(or(r,2)).update(e).update(or(e.length,1)).digest()}function Io(t,e,r){jn(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});const{p:n,k:i,m:s,hash:c,expand:u,DST:l}=r;br(t),kn(e);const p=typeof l=="string"?Ja(l):l,b=n.toString(2).length,x=Math.ceil((b+i)/8),_=e*s*x;let v;if(u==="xmd")v=E0(t,p,_,c);else if(u==="xof")v=T0(t,p,_,i,c);else if(u==="_internal_pass")v=t;else throw new Error('expand must be "xmd" or "xof"');const d=new Array(e);for(let A=0;A<e;A++){const S=new Array(s);for(let P=0;P<s;P++){const I=x*(P+A*s),R=v.subarray(I,I+x);S[P]=Fe(v0(R),n)}d[A]=S}return d}function nf(t,e){const r=e.map(n=>Array.from(n).reverse());return(n,i)=>{const[s,c,u,l]=r.map(p=>p.reduce((b,x)=>t.add(t.mul(b,n),x)));return n=t.div(s,c),i=t.mul(i,t.div(u,l)),{x:n,y:i}}}function ko(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){const s=Io(n,2,{...r,DST:r.DST,...i}),c=t.fromAffine(e(s[0])),u=t.fromAffine(e(s[1])),l=c.add(u).clearCofactor();return l.assertValidity(),l},encodeToCurve(n,i){const s=Io(n,1,{...r,DST:r.encodeDST,...i}),c=t.fromAffine(e(s[0])).clearCofactor();return c.assertValidity(),c},mapToCurve(n){if(!Array.isArray(n))throw new Error("mapToCurve: expected array of bigints");for(const s of n)if(typeof s!="bigint")throw new Error("mapToCurve: expected array of bigints");const i=t.fromAffine(e(n)).clearCofactor();return i.assertValidity(),i}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Co=BigInt(0),ri=BigInt(1);function zs(t,e){const r=e.negate();return t?r:e}function sf(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Ws(t,e){sf(t,e);const r=Math.ceil(e/t)+1,n=2**(t-1);return{windows:r,windowSize:n}}function S0(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,n)=>{if(!(r instanceof e))throw new Error("invalid point at index "+n)})}function A0(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,n)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+n)})}const Ys=new WeakMap,af=new WeakMap;function Zs(t){return af.get(t)||1}function of(t,e){return{constTimeNegate:zs,hasPrecomputes(r){return Zs(r)!==1},unsafeLadder(r,n,i=t.ZERO){let s=r;for(;n>Co;)n&ri&&(i=i.add(s)),s=s.double(),n>>=ri;return i},precomputeWindow(r,n){const{windows:i,windowSize:s}=Ws(n,e),c=[];let u=r,l=u;for(let p=0;p<i;p++){l=u,c.push(l);for(let b=1;b<s;b++)l=l.add(u),c.push(l);u=l.double()}return c},wNAF(r,n,i){const{windows:s,windowSize:c}=Ws(r,e);let u=t.ZERO,l=t.BASE;const p=BigInt(2**r-1),b=2**r,x=BigInt(r);for(let _=0;_<s;_++){const v=_*c;let d=Number(i&p);i>>=x,d>c&&(d-=b,i+=ri);const A=v,S=v+Math.abs(d)-1,P=_%2!==0,I=d<0;d===0?l=l.add(zs(P,n[A])):u=u.add(zs(I,n[S]))}return{p:u,f:l}},wNAFUnsafe(r,n,i,s=t.ZERO){const{windows:c,windowSize:u}=Ws(r,e),l=BigInt(2**r-1),p=2**r,b=BigInt(r);for(let x=0;x<c;x++){const _=x*u;if(i===Co)break;let v=Number(i&l);if(i>>=b,v>u&&(v-=p,i+=ri),v===0)continue;let d=n[_+Math.abs(v)-1];v<0&&(d=d.negate()),s=s.add(d)}return s},getPrecomputes(r,n,i){let s=Ys.get(n);return s||(s=this.precomputeWindow(n,r),r!==1&&Ys.set(n,i(s))),s},wNAFCached(r,n,i){const s=Zs(r);return this.wNAF(s,this.getPrecomputes(s,r,i),n)},wNAFCachedUnsafe(r,n,i,s){const c=Zs(r);return c===1?this.unsafeLadder(r,n,s):this.wNAFUnsafe(c,this.getPrecomputes(c,r,i),n,s)},setWindowSize(r,n){sf(n,e),af.set(r,n),Ys.delete(r)}}}function cf(t,e,r,n){if(S0(r,t),A0(n,e),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const i=t.ZERO,s=On(BigInt(r.length)),c=s>12?s-3:s>4?s-2:s?2:1,u=(1<<c)-1,l=new Array(u+1).fill(i),p=Math.floor((e.BITS-1)/c)*c;let b=i;for(let x=p;x>=0;x-=c){l.fill(i);for(let v=0;v<n.length;v++){const d=n[v],A=Number(d>>BigInt(x)&BigInt(u));l[A]=l[A].add(r[v])}let _=i;for(let v=l.length-1,d=i;v>0;v--)d=d.add(l[v]),_=_.add(d);if(b=b.add(_),x!==0)for(let v=0;v<c;v++)b=b.double()}return b}function uf(t){return Du(t.Fp),jn(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...ef(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */function N0(t){const e=uf(t);jn(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});const{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("invalid endomorphism, can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("invalid endomorphism, expected beta: bigint and splitScalar: function")}return Object.freeze({...e})}const Nr=BigInt(0),Ce=BigInt(1),tr=BigInt(2),Ji=BigInt(3),Mo=BigInt(4);function $o(t){const e=N0(t),{Fp:r}=e,n=Kn(e.n,e.nBitLength),i=e.toBytes||((A,S,P)=>{const I=S.toAffine();return Ge(Uint8Array.from([4]),r.toBytes(I.x),r.toBytes(I.y))}),s=e.fromBytes||(A=>{const S=A.subarray(1),P=r.fromBytes(S.subarray(0,r.BYTES)),I=r.fromBytes(S.subarray(r.BYTES,2*r.BYTES));return{x:P,y:I}});function c(A){const{a:S,b:P}=e,I=r.sqr(A),R=r.mul(I,A);return r.add(r.add(R,r.mul(A,S)),P)}if(!r.eql(r.sqr(e.Gy),c(e.Gx)))throw new Error("bad generator point: equation left != right");function u(A){return Lu(A,Ce,e.n)}function l(A){const{allowedPrivateKeyLengths:S,nByteLength:P,wrapPrivateKey:I,n:R}=e;if(S&&typeof A!="bigint"){if(ws(A)&&(A=Pr(A)),typeof A!="string"||!S.includes(A.length))throw new Error("invalid private key");A=A.padStart(P*2,"0")}let H;try{H=typeof A=="bigint"?A:St(it("private key",A,P))}catch{throw new Error("invalid private key, expected hex or "+P+" bytes, got "+typeof A)}return I&&(H=Fe(H,R)),lr("private key",H,Ce,R),H}function p(A){if(!(A instanceof _))throw new Error("ProjectivePoint expected")}const b=In((A,S)=>{const{px:P,py:I,pz:R}=A;if(r.eql(R,r.ONE))return{x:P,y:I};const H=A.is0();S==null&&(S=H?r.ONE:r.inv(R));const B=r.mul(P,S),j=r.mul(I,S),V=r.mul(R,S);if(H)return{x:r.ZERO,y:r.ZERO};if(!r.eql(V,r.ONE))throw new Error("invZ was invalid");return{x:B,y:j}}),x=In(A=>{if(A.is0()){if(e.allowInfinityPoint&&!r.is0(A.py))return;throw new Error("bad point: ZERO")}const{x:S,y:P}=A.toAffine();if(!r.isValid(S)||!r.isValid(P))throw new Error("bad point: x or y not FE");const I=r.sqr(P),R=c(S);if(!r.eql(I,R))throw new Error("bad point: equation left != right");if(!A.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});class _{constructor(S,P,I){if(this.px=S,this.py=P,this.pz=I,S==null||!r.isValid(S))throw new Error("x required");if(P==null||!r.isValid(P))throw new Error("y required");if(I==null||!r.isValid(I))throw new Error("z required");Object.freeze(this)}static fromAffine(S){const{x:P,y:I}=S||{};if(!S||!r.isValid(P)||!r.isValid(I))throw new Error("invalid affine point");if(S instanceof _)throw new Error("projective point not allowed");const R=H=>r.eql(H,r.ZERO);return R(P)&&R(I)?_.ZERO:new _(P,I,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(S){const P=r.invertBatch(S.map(I=>I.pz));return S.map((I,R)=>I.toAffine(P[R])).map(_.fromAffine)}static fromHex(S){const P=_.fromAffine(s(it("pointHex",S)));return P.assertValidity(),P}static fromPrivateKey(S){return _.BASE.multiply(l(S))}static msm(S,P){return cf(_,n,S,P)}_setWindowSize(S){d.setWindowSize(this,S)}assertValidity(){x(this)}hasEvenY(){const{y:S}=this.toAffine();if(r.isOdd)return!r.isOdd(S);throw new Error("Field doesn't support isOdd")}equals(S){p(S);const{px:P,py:I,pz:R}=this,{px:H,py:B,pz:j}=S,V=r.eql(r.mul(P,j),r.mul(H,R)),K=r.eql(r.mul(I,j),r.mul(B,R));return V&&K}negate(){return new _(this.px,r.neg(this.py),this.pz)}double(){const{a:S,b:P}=e,I=r.mul(P,Ji),{px:R,py:H,pz:B}=this;let j=r.ZERO,V=r.ZERO,K=r.ZERO,Y=r.mul(R,R),z=r.mul(H,H),ne=r.mul(B,B),D=r.mul(R,H);return D=r.add(D,D),K=r.mul(R,B),K=r.add(K,K),j=r.mul(S,K),V=r.mul(I,ne),V=r.add(j,V),j=r.sub(z,V),V=r.add(z,V),V=r.mul(j,V),j=r.mul(D,j),K=r.mul(I,K),ne=r.mul(S,ne),D=r.sub(Y,ne),D=r.mul(S,D),D=r.add(D,K),K=r.add(Y,Y),Y=r.add(K,Y),Y=r.add(Y,ne),Y=r.mul(Y,D),V=r.add(V,Y),ne=r.mul(H,B),ne=r.add(ne,ne),Y=r.mul(ne,D),j=r.sub(j,Y),K=r.mul(ne,z),K=r.add(K,K),K=r.add(K,K),new _(j,V,K)}add(S){p(S);const{px:P,py:I,pz:R}=this,{px:H,py:B,pz:j}=S;let V=r.ZERO,K=r.ZERO,Y=r.ZERO;const z=e.a,ne=r.mul(e.b,Ji);let D=r.mul(P,H),T=r.mul(I,B),U=r.mul(R,j),G=r.add(P,I),$=r.add(H,B);G=r.mul(G,$),$=r.add(D,T),G=r.sub(G,$),$=r.add(P,R);let M=r.add(H,j);return $=r.mul($,M),M=r.add(D,U),$=r.sub($,M),M=r.add(I,R),V=r.add(B,j),M=r.mul(M,V),V=r.add(T,U),M=r.sub(M,V),Y=r.mul(z,$),V=r.mul(ne,U),Y=r.add(V,Y),V=r.sub(T,Y),Y=r.add(T,Y),K=r.mul(V,Y),T=r.add(D,D),T=r.add(T,D),U=r.mul(z,U),$=r.mul(ne,$),T=r.add(T,U),U=r.sub(D,U),U=r.mul(z,U),$=r.add($,U),D=r.mul(T,$),K=r.add(K,D),D=r.mul(M,$),V=r.mul(G,V),V=r.sub(V,D),D=r.mul(G,T),Y=r.mul(M,Y),Y=r.add(Y,D),new _(V,K,Y)}subtract(S){return this.add(S.negate())}is0(){return this.equals(_.ZERO)}wNAF(S){return d.wNAFCached(this,S,_.normalizeZ)}multiplyUnsafe(S){const{endo:P,n:I}=e;lr("scalar",S,Nr,I);const R=_.ZERO;if(S===Nr)return R;if(this.is0()||S===Ce)return this;if(!P||d.hasPrecomputes(this))return d.wNAFCachedUnsafe(this,S,_.normalizeZ);let{k1neg:H,k1:B,k2neg:j,k2:V}=P.splitScalar(S),K=R,Y=R,z=this;for(;B>Nr||V>Nr;)B&Ce&&(K=K.add(z)),V&Ce&&(Y=Y.add(z)),z=z.double(),B>>=Ce,V>>=Ce;return H&&(K=K.negate()),j&&(Y=Y.negate()),Y=new _(r.mul(Y.px,P.beta),Y.py,Y.pz),K.add(Y)}multiply(S){const{endo:P,n:I}=e;lr("scalar",S,Ce,I);let R,H;if(P){const{k1neg:B,k1:j,k2neg:V,k2:K}=P.splitScalar(S);let{p:Y,f:z}=this.wNAF(j),{p:ne,f:D}=this.wNAF(K);Y=d.constTimeNegate(B,Y),ne=d.constTimeNegate(V,ne),ne=new _(r.mul(ne.px,P.beta),ne.py,ne.pz),R=Y.add(ne),H=z.add(D)}else{const{p:B,f:j}=this.wNAF(S);R=B,H=j}return _.normalizeZ([R,H])[0]}multiplyAndAddUnsafe(S,P,I){const R=_.BASE,H=(j,V)=>V===Nr||V===Ce||!j.equals(R)?j.multiplyUnsafe(V):j.multiply(V),B=H(this,P).add(H(S,I));return B.is0()?void 0:B}toAffine(S){return b(this,S)}isTorsionFree(){const{h:S,isTorsionFree:P}=e;if(S===Ce)return!0;if(P)return P(_,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){const{h:S,clearCofactor:P}=e;return S===Ce?this:P?P(_,this):this.multiplyUnsafe(e.h)}toRawBytes(S=!0){return Bn("isCompressed",S),this.assertValidity(),i(_,this,S)}toHex(S=!0){return Bn("isCompressed",S),Pr(this.toRawBytes(S))}}_.BASE=new _(e.Gx,e.Gy,r.ONE),_.ZERO=new _(r.ZERO,r.ONE,r.ZERO);const v=e.nBitLength,d=of(_,e.endo?Math.ceil(v/2):v);return{CURVE:e,ProjectivePoint:_,normPrivateKeyToScalar:l,weierstrassEquation:c,isWithinCurveOrder:u}}function B0(t,e){const r=t.ORDER;let n=Nr;for(let d=r-Ce;d%tr===Nr;d/=tr)n+=Ce;const i=n,s=tr<<i-Ce-Ce,c=s*tr,u=(r-Ce)/c,l=(u-Ce)/tr,p=c-Ce,b=s,x=t.pow(e,u),_=t.pow(e,(u+Ce)/tr);let v=(d,A)=>{let S=x,P=t.pow(A,p),I=t.sqr(P);I=t.mul(I,A);let R=t.mul(d,I);R=t.pow(R,l),R=t.mul(R,P),P=t.mul(R,A),I=t.mul(R,d);let H=t.mul(I,P);R=t.pow(H,b);let B=t.eql(R,t.ONE);P=t.mul(I,_),R=t.mul(H,S),I=t.cmov(P,I,B),H=t.cmov(R,H,B);for(let j=i;j>Ce;j--){let V=j-tr;V=tr<<V-Ce;let K=t.pow(H,V);const Y=t.eql(K,t.ONE);P=t.mul(I,S),S=t.mul(S,S),K=t.mul(H,S),I=t.cmov(P,I,Y),H=t.cmov(K,H,Y)}return{isValid:B,value:I}};if(t.ORDER%Mo===Ji){const d=(t.ORDER-Ji)/Mo,A=t.sqrt(t.neg(e));v=(S,P)=>{let I=t.sqr(P);const R=t.mul(S,P);I=t.mul(I,R);let H=t.pow(I,d);H=t.mul(H,R);const B=t.mul(H,A),j=t.mul(t.sqr(H),P),V=t.eql(j,S);let K=t.cmov(B,H,V);return{isValid:V,value:K}}}return v}function ff(t,e){if(Du(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");const r=B0(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,s,c,u,l,p,b,x;i=t.sqr(n),i=t.mul(i,e.Z),s=t.sqr(i),s=t.add(s,i),c=t.add(s,t.ONE),c=t.mul(c,e.B),u=t.cmov(e.Z,t.neg(s),!t.eql(s,t.ZERO)),u=t.mul(u,e.A),s=t.sqr(c),p=t.sqr(u),l=t.mul(p,e.A),s=t.add(s,l),s=t.mul(s,c),p=t.mul(p,u),l=t.mul(p,e.B),s=t.add(s,l),b=t.mul(i,c);const{isValid:_,value:v}=r(s,p);x=t.mul(i,n),x=t.mul(x,v),b=t.cmov(b,c,_),x=t.cmov(x,v,_);const d=t.isOdd(n)===t.isOdd(x);return x=t.cmov(t.neg(x),x,d),b=t.div(b,u),{x:b,y:x}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const R0=BigInt(0),ni=BigInt(1),Go=BigInt(2),Wr=BigInt(3);function O0(t){const e=[];for(;t>ni;t>>=ni)(t&ni)===R0?e.unshift(0):(t&Wr)===Wr?(e.unshift(-1),t+=ni):e.unshift(1);return e}function U0(t){const{Fp:e,Fr:r,Fp2:n,Fp6:i,Fp12:s}=t.fields,c=t.params.xNegative,u=t.params.twistType,l=$o({n:r.ORDER,...t.G1}),p=Object.assign(l,ko(l.ProjectivePoint,t.G1.mapToCurve,{...t.htfDefaults,...t.G1.htfDefaults})),b=$o({n:r.ORDER,...t.G2}),x=Object.assign(b,ko(b.ProjectivePoint,t.G2.mapToCurve,{...t.htfDefaults,...t.G2.htfDefaults}));let _;if(u==="multiplicative")_=(Z,g,L,ie,ae,X)=>s.mul014(ie,Z,n.mul(g,ae),n.mul(L,X));else if(u==="divisive")_=(Z,g,L,ie,ae,X)=>s.mul034(ie,n.mul(L,X),n.mul(g,ae),Z);else throw new Error("bls: unknown twist type");const v=n.div(n.ONE,n.mul(n.ONE,Go));function d(Z,g,L,ie){const ae=n.sqr(L),X=n.sqr(ie),te=n.mulByB(n.mul(X,Wr)),y=n.mul(te,Wr),m=n.sub(n.sub(n.sqr(n.add(L,ie)),X),ae),E=n.sub(te,ae),k=n.mul(n.sqr(g),Wr),F=n.neg(m);return Z.push([E,k,F]),g=n.mul(n.mul(n.mul(n.sub(ae,y),g),L),v),L=n.sub(n.sqr(n.mul(n.add(ae,y),v)),n.mul(n.sqr(te),Wr)),ie=n.mul(ae,m),{Rx:g,Ry:L,Rz:ie}}function A(Z,g,L,ie,ae,X){const te=n.sub(L,n.mul(X,ie)),y=n.sub(g,n.mul(ae,ie)),m=n.sub(n.mul(te,ae),n.mul(y,X)),E=n.neg(te),k=y;Z.push([m,E,k]);const F=n.sqr(y),C=n.mul(F,y),f=n.mul(F,g),a=n.add(n.sub(C,n.mul(f,Go)),n.mul(n.sqr(te),ie));return g=n.mul(y,a),L=n.sub(n.mul(n.sub(f,a),te),n.mul(C,L)),ie=n.mul(ie,C),{Rx:g,Ry:L,Rz:ie}}const S=O0(t.params.ateLoopSize),P=In(Z=>{const g=Z,{x:L,y:ie}=g.toAffine(),ae=L,X=ie,te=n.neg(ie);let y=ae,m=X,E=n.ONE;const k=[];for(const F of S){const C=[];({Rx:y,Ry:m,Rz:E}=d(C,y,m,E)),F&&({Rx:y,Ry:m,Rz:E}=A(C,y,m,E,ae,F===-1?te:X)),k.push(C)}if(t.postPrecompute){const F=k[k.length-1];t.postPrecompute(y,m,E,ae,X,A.bind(null,F))}return k});function I(Z,g=!1){let L=s.ONE;if(Z.length){const ie=Z[0][0].length;for(let ae=0;ae<ie;ae++){L=s.sqr(L);for(const[X,te,y]of Z)for(const[m,E,k]of X[ae])L=_(m,E,k,L,te,y)}}return c&&(L=s.conjugate(L)),g?s.finalExponentiate(L):L}function R(Z,g=!0){const L=[];p.ProjectivePoint.normalizeZ(Z.map(({g1:ie})=>ie)),x.ProjectivePoint.normalizeZ(Z.map(({g2:ie})=>ie));for(const{g1:ie,g2:ae}of Z){if(ie.equals(p.ProjectivePoint.ZERO)||ae.equals(x.ProjectivePoint.ZERO))throw new Error("pairing is not available for ZERO point");ie.assertValidity(),ae.assertValidity();const X=ie.toAffine();L.push([P(ae),X.x,X.y])}return I(L,g)}function H(Z,g,L=!0){return R([{g1:Z,g2:g}],L)}const B={randomPrivateKey:()=>{const Z=rf(r.ORDER);return _0(t.randomBytes(Z),r.ORDER)},calcPairingPrecomputes:P},{ShortSignature:j}=t.G1,{Signature:V}=t.G2;function K(Z){return Z instanceof p.ProjectivePoint?Z:p.ProjectivePoint.fromHex(Z)}function Y(Z,g){return Z instanceof p.ProjectivePoint?Z:p.hashToCurve(it("point",Z),g)}function z(Z){return Z instanceof x.ProjectivePoint?Z:V.fromHex(Z)}function ne(Z,g){return Z instanceof x.ProjectivePoint?Z:x.hashToCurve(it("point",Z),g)}function D(Z){return p.ProjectivePoint.fromPrivateKey(Z).toRawBytes(!0)}function T(Z){return x.ProjectivePoint.fromPrivateKey(Z).toRawBytes(!0)}function U(Z,g,L){const ie=ne(Z,L);ie.assertValidity();const ae=ie.multiply(p.normPrivateKeyToScalar(g));return Z instanceof x.ProjectivePoint?ae:V.toRawBytes(ae)}function G(Z,g,L){const ie=Y(Z,L);ie.assertValidity();const ae=ie.multiply(p.normPrivateKeyToScalar(g));return Z instanceof p.ProjectivePoint?ae:j.toRawBytes(ae)}function $(Z,g,L,ie){const ae=K(L),X=ne(g,ie),te=p.ProjectivePoint.BASE,y=z(Z),m=R([{g1:ae.negate(),g2:X},{g1:te,g2:y}]);return s.eql(m,s.ONE)}function M(Z,g,L,ie){const ae=z(L),X=Y(g,ie),te=x.ProjectivePoint.BASE,y=K(Z),m=R([{g1:X,g2:ae},{g1:y,g2:te.negate()}]);return s.eql(m,s.ONE)}function W(Z){if(!Array.isArray(Z)||Z.length===0)throw new Error("expected non-empty array")}function J(Z){W(Z);const L=Z.map(K).reduce((ie,ae)=>ie.add(ae),p.ProjectivePoint.ZERO);return Z[0]instanceof p.ProjectivePoint?(L.assertValidity(),L):L.toRawBytes(!0)}function oe(Z){W(Z);const L=Z.map(z).reduce((ie,ae)=>ie.add(ae),x.ProjectivePoint.ZERO);return Z[0]instanceof x.ProjectivePoint?(L.assertValidity(),L):V.toRawBytes(L)}function se(Z){W(Z);const L=Z.map(K).reduce((ie,ae)=>ie.add(ae),p.ProjectivePoint.ZERO);return Z[0]instanceof p.ProjectivePoint?(L.assertValidity(),L):j.toRawBytes(L)}function ue(Z,g,L,ie){if(W(g),L.length!==g.length)throw new Error("amount of public keys and messages should be equal");const ae=z(Z),X=g.map(E=>ne(E,ie)),te=L.map(K),y=new Map;for(let E=0;E<te.length;E++){const k=te[E],F=X[E];let C=y.get(F);C===void 0&&(C=[],y.set(F,C)),C.push(k)}const m=[];try{for(const[E,k]of y){const F=k.reduce((C,f)=>C.add(f));m.push({g1:F,g2:E})}return m.push({g1:p.ProjectivePoint.BASE.negate(),g2:ae}),s.eql(R(m),s.ONE)}catch{return!1}}return p.ProjectivePoint.BASE._setWindowSize(4),{getPublicKey:D,getPublicKeyForShortSignatures:T,sign:U,signShortSignature:G,verify:$,verifyBatch:ue,verifyShortSignature:M,aggregatePublicKeys:J,aggregateSignatures:oe,aggregateShortSignatures:se,millerLoopBatch:I,pairing:H,pairingBatch:R,G1:p,G2:x,Signature:V,ShortSignature:j,fields:{Fr:r,Fp:e,Fp2:n,Fp6:i,Fp12:s},params:{ateLoopSize:t.params.ateLoopSize,r:t.params.r,G1b:t.G1.b,G2b:t.G2.b},utils:B}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const F0=BigInt(0),Yr=BigInt(1),zt=BigInt(2),Vo=BigInt(3);function Xs(t,e,r,n,i=1,s){const c=BigInt(s===void 0?n:s),u=r**BigInt(n),l=[];for(let p=0;p<i;p++){const b=BigInt(p+1),x=[];for(let _=0,v=Yr;_<n;_++){const d=(b*v-b)/c%u;x.push(t.pow(e,d)),v*=r}l.push(x)}return l}function P0(t,e,r){const n=e.pow(r,(t.ORDER-Yr)/Vo),i=e.pow(r,(t.ORDER-Yr)/zt);function s(_,v){const d=e.mul(e.frobeniusMap(_,1),n),A=e.mul(e.frobeniusMap(v,1),i);return[d,A]}const c=e.pow(r,(t.ORDER**zt-Yr)/Vo),u=e.pow(r,(t.ORDER**zt-Yr)/zt);if(!e.eql(u,e.neg(e.ONE)))throw new Error("psiFrobenius: PSI2_Y!==-1");function l(_,v){return[e.mul(_,c),e.neg(v)]}const p=_=>(v,d)=>{const A=d.toAffine(),S=_(A.x,A.y);return v.fromAffine({x:S[0],y:S[1]})},b=p(s),x=p(l);return{psi:s,psi2:l,G2psi:b,G2psi2:x,PSI_X:n,PSI_Y:i,PSI2_X:c,PSI2_Y:u}}function I0(t){const{ORDER:e}=t,r=Kn(e),n=r.create(t.NONRESIDUE||BigInt(-1)),i=m0(e),s=r.div(r.ONE,zt),c=Xs(r,n,r.ORDER,2)[0],u=({c0:T,c1:U},{c0:G,c1:$})=>({c0:r.add(T,G),c1:r.add(U,$)}),l=({c0:T,c1:U},{c0:G,c1:$})=>({c0:r.sub(T,G),c1:r.sub(U,$)}),p=({c0:T,c1:U},G)=>{if(typeof G=="bigint")return{c0:r.mul(T,G),c1:r.mul(U,G)};const{c0:$,c1:M}=G;let W=r.mul(T,$),J=r.mul(U,M);const oe=r.sub(W,J),se=r.sub(r.mul(r.add(T,U),r.add($,M)),r.add(W,J));return{c0:oe,c1:se}},b=({c0:T,c1:U})=>{const G=r.add(T,U),$=r.sub(T,U),M=r.add(T,T);return{c0:r.mul(G,$),c1:r.mul(M,U)}},x=T=>{if(T.length!==2)throw new Error("invalid tuple");const U=T.map(G=>r.create(G));return{c0:U[0],c1:U[1]}},_=e*e,v=x(t.FP2_NONRESIDUE),d={ORDER:_,isLE:r.isLE,NONRESIDUE:v,BITS:On(_),BYTES:Math.ceil(On(_)/8),MASK:yi(On(_)),ZERO:{c0:r.ZERO,c1:r.ZERO},ONE:{c0:r.ONE,c1:r.ZERO},create:T=>T,isValid:({c0:T,c1:U})=>typeof T=="bigint"&&typeof U=="bigint",is0:({c0:T,c1:U})=>r.is0(T)&&r.is0(U),eql:({c0:T,c1:U},{c0:G,c1:$})=>r.eql(T,G)&&r.eql(U,$),neg:({c0:T,c1:U})=>({c0:r.neg(T),c1:r.neg(U)}),pow:(T,U)=>wi(d,T,U),invertBatch:T=>bi(d,T),add:u,sub:l,mul:p,sqr:b,addN:u,subN:l,mulN:p,sqrN:b,div:(T,U)=>d.mul(T,typeof U=="bigint"?r.inv(r.create(U)):d.inv(U)),inv:({c0:T,c1:U})=>{const G=r.inv(r.create(T*T+U*U));return{c0:r.mul(G,r.create(T)),c1:r.mul(G,r.create(-U))}},sqrt:T=>{if(t.Fp2sqrt)return t.Fp2sqrt(T);const{c0:U,c1:G}=T;if(r.is0(G))return r.eql(i(r,U),r.ONE)?d.create({c0:r.sqrt(U),c1:r.ZERO}):d.create({c0:r.ZERO,c1:r.sqrt(r.div(U,n))});const $=r.sqrt(r.sub(r.sqr(U),r.mul(r.sqr(G),n)));let M=r.mul(r.add($,U),s);const W=i(r,M);!r.is0(W)&&!r.eql(W,r.ONE)&&(M=r.sub(M,$));const J=r.sqrt(M),oe=d.create({c0:J,c1:r.div(r.mul(G,s),J)});if(!d.eql(d.sqr(oe),T))throw new Error("Cannot find square root");const se=oe,ue=d.neg(se),{re:Z,im:g}=d.reim(se),{re:L,im:ie}=d.reim(ue);return g>ie||g===ie&&Z>L?se:ue},isOdd:T=>{const{re:U,im:G}=d.reim(T),$=U%zt,M=U===F0,W=G%zt;return BigInt($||M&&W)==Yr},fromBytes(T){if(T.length!==d.BYTES)throw new Error("fromBytes invalid length="+T.length);return{c0:r.fromBytes(T.subarray(0,r.BYTES)),c1:r.fromBytes(T.subarray(r.BYTES))}},toBytes:({c0:T,c1:U})=>Ge(r.toBytes(T),r.toBytes(U)),cmov:({c0:T,c1:U},{c0:G,c1:$},M)=>({c0:r.cmov(T,G,M),c1:r.cmov(U,$,M)}),reim:({c0:T,c1:U})=>({re:T,im:U}),mulByNonresidue:({c0:T,c1:U})=>d.mul({c0:T,c1:U},v),mulByB:t.Fp2mulByB,fromBigTuple:x,frobeniusMap:({c0:T,c1:U},G)=>({c0:T,c1:r.mul(U,c[G%2])})},A=({c0:T,c1:U,c2:G},{c0:$,c1:M,c2:W})=>({c0:d.add(T,$),c1:d.add(U,M),c2:d.add(G,W)}),S=({c0:T,c1:U,c2:G},{c0:$,c1:M,c2:W})=>({c0:d.sub(T,$),c1:d.sub(U,M),c2:d.sub(G,W)}),P=({c0:T,c1:U,c2:G},$)=>{if(typeof $=="bigint")return{c0:d.mul(T,$),c1:d.mul(U,$),c2:d.mul(G,$)};const{c0:M,c1:W,c2:J}=$,oe=d.mul(T,M),se=d.mul(U,W),ue=d.mul(G,J);return{c0:d.add(oe,d.mulByNonresidue(d.sub(d.mul(d.add(U,G),d.add(W,J)),d.add(se,ue)))),c1:d.add(d.sub(d.mul(d.add(T,U),d.add(M,W)),d.add(oe,se)),d.mulByNonresidue(ue)),c2:d.sub(d.add(se,d.mul(d.add(T,G),d.add(M,J))),d.add(oe,ue))}},I=({c0:T,c1:U,c2:G})=>{let $=d.sqr(T),M=d.mul(d.mul(T,U),zt),W=d.mul(d.mul(U,G),zt),J=d.sqr(G);return{c0:d.add(d.mulByNonresidue(W),$),c1:d.add(d.mulByNonresidue(J),M),c2:d.sub(d.sub(d.add(d.add(M,d.sqr(d.add(d.sub(T,U),G))),W),$),J)}},[R,H]=Xs(d,v,r.ORDER,6,2,3),B={ORDER:d.ORDER,isLE:d.isLE,BITS:3*d.BITS,BYTES:3*d.BYTES,MASK:yi(3*d.BITS),ZERO:{c0:d.ZERO,c1:d.ZERO,c2:d.ZERO},ONE:{c0:d.ONE,c1:d.ZERO,c2:d.ZERO},create:T=>T,isValid:({c0:T,c1:U,c2:G})=>d.isValid(T)&&d.isValid(U)&&d.isValid(G),is0:({c0:T,c1:U,c2:G})=>d.is0(T)&&d.is0(U)&&d.is0(G),neg:({c0:T,c1:U,c2:G})=>({c0:d.neg(T),c1:d.neg(U),c2:d.neg(G)}),eql:({c0:T,c1:U,c2:G},{c0:$,c1:M,c2:W})=>d.eql(T,$)&&d.eql(U,M)&&d.eql(G,W),sqrt:Oo,div:(T,U)=>B.mul(T,typeof U=="bigint"?r.inv(r.create(U)):B.inv(U)),pow:(T,U)=>wi(B,T,U),invertBatch:T=>bi(B,T),add:A,sub:S,mul:P,sqr:I,addN:A,subN:S,mulN:P,sqrN:I,inv:({c0:T,c1:U,c2:G})=>{let $=d.sub(d.sqr(T),d.mulByNonresidue(d.mul(G,U))),M=d.sub(d.mulByNonresidue(d.sqr(G)),d.mul(T,U)),W=d.sub(d.sqr(U),d.mul(T,G)),J=d.inv(d.add(d.mulByNonresidue(d.add(d.mul(G,M),d.mul(U,W))),d.mul(T,$)));return{c0:d.mul(J,$),c1:d.mul(J,M),c2:d.mul(J,W)}},fromBytes:T=>{if(T.length!==B.BYTES)throw new Error("fromBytes invalid length="+T.length);return{c0:d.fromBytes(T.subarray(0,d.BYTES)),c1:d.fromBytes(T.subarray(d.BYTES,2*d.BYTES)),c2:d.fromBytes(T.subarray(2*d.BYTES))}},toBytes:({c0:T,c1:U,c2:G})=>Ge(d.toBytes(T),d.toBytes(U),d.toBytes(G)),cmov:({c0:T,c1:U,c2:G},{c0:$,c1:M,c2:W},J)=>({c0:d.cmov(T,$,J),c1:d.cmov(U,M,J),c2:d.cmov(G,W,J)}),fromBigSix:T=>{if(!Array.isArray(T)||T.length!==6)throw new Error("invalid Fp6 usage");return{c0:d.fromBigTuple(T.slice(0,2)),c1:d.fromBigTuple(T.slice(2,4)),c2:d.fromBigTuple(T.slice(4,6))}},frobeniusMap:({c0:T,c1:U,c2:G},$)=>({c0:d.frobeniusMap(T,$),c1:d.mul(d.frobeniusMap(U,$),R[$%6]),c2:d.mul(d.frobeniusMap(G,$),H[$%6])}),mulByFp2:({c0:T,c1:U,c2:G},$)=>({c0:d.mul(T,$),c1:d.mul(U,$),c2:d.mul(G,$)}),mulByNonresidue:({c0:T,c1:U,c2:G})=>({c0:d.mulByNonresidue(G),c1:T,c2:U}),mul1:({c0:T,c1:U,c2:G},$)=>({c0:d.mulByNonresidue(d.mul(G,$)),c1:d.mul(T,$),c2:d.mul(U,$)}),mul01({c0:T,c1:U,c2:G},$,M){let W=d.mul(T,$),J=d.mul(U,M);return{c0:d.add(d.mulByNonresidue(d.sub(d.mul(d.add(U,G),M),J)),W),c1:d.sub(d.sub(d.mul(d.add($,M),d.add(T,U)),W),J),c2:d.add(d.sub(d.mul(d.add(T,G),$),W),J)}}},j=Xs(d,v,r.ORDER,12,1,6)[0],V=({c0:T,c1:U},{c0:G,c1:$})=>({c0:B.add(T,G),c1:B.add(U,$)}),K=({c0:T,c1:U},{c0:G,c1:$})=>({c0:B.sub(T,G),c1:B.sub(U,$)}),Y=({c0:T,c1:U},G)=>{if(typeof G=="bigint")return{c0:B.mul(T,G),c1:B.mul(U,G)};let{c0:$,c1:M}=G,W=B.mul(T,$),J=B.mul(U,M);return{c0:B.add(W,B.mulByNonresidue(J)),c1:B.sub(B.mul(B.add(T,U),B.add($,M)),B.add(W,J))}},z=({c0:T,c1:U})=>{let G=B.mul(T,U);return{c0:B.sub(B.sub(B.mul(B.add(B.mulByNonresidue(U),T),B.add(T,U)),G),B.mulByNonresidue(G)),c1:B.add(G,G)}};function ne(T,U){const G=d.sqr(T),$=d.sqr(U);return{first:d.add(d.mulByNonresidue($),G),second:d.sub(d.sub(d.sqr(d.add(T,U)),G),$)}}const D={ORDER:d.ORDER,isLE:B.isLE,BITS:2*d.BITS,BYTES:2*d.BYTES,MASK:yi(2*d.BITS),ZERO:{c0:B.ZERO,c1:B.ZERO},ONE:{c0:B.ONE,c1:B.ZERO},create:T=>T,isValid:({c0:T,c1:U})=>B.isValid(T)&&B.isValid(U),is0:({c0:T,c1:U})=>B.is0(T)&&B.is0(U),neg:({c0:T,c1:U})=>({c0:B.neg(T),c1:B.neg(U)}),eql:({c0:T,c1:U},{c0:G,c1:$})=>B.eql(T,G)&&B.eql(U,$),sqrt:Oo,inv:({c0:T,c1:U})=>{let G=B.inv(B.sub(B.sqr(T),B.mulByNonresidue(B.sqr(U))));return{c0:B.mul(T,G),c1:B.neg(B.mul(U,G))}},div:(T,U)=>D.mul(T,typeof U=="bigint"?r.inv(r.create(U)):D.inv(U)),pow:(T,U)=>wi(D,T,U),invertBatch:T=>bi(D,T),add:V,sub:K,mul:Y,sqr:z,addN:V,subN:K,mulN:Y,sqrN:z,fromBytes:T=>{if(T.length!==D.BYTES)throw new Error("fromBytes invalid length="+T.length);return{c0:B.fromBytes(T.subarray(0,B.BYTES)),c1:B.fromBytes(T.subarray(B.BYTES))}},toBytes:({c0:T,c1:U})=>Ge(B.toBytes(T),B.toBytes(U)),cmov:({c0:T,c1:U},{c0:G,c1:$},M)=>({c0:B.cmov(T,G,M),c1:B.cmov(U,$,M)}),fromBigTwelve:T=>({c0:B.fromBigSix(T.slice(0,6)),c1:B.fromBigSix(T.slice(6,12))}),frobeniusMap(T,U){const{c0:G,c1:$,c2:M}=B.frobeniusMap(T.c1,U),W=j[U%12];return{c0:B.frobeniusMap(T.c0,U),c1:B.create({c0:d.mul(G,W),c1:d.mul($,W),c2:d.mul(M,W)})}},mulByFp2:({c0:T,c1:U},G)=>({c0:B.mulByFp2(T,G),c1:B.mulByFp2(U,G)}),conjugate:({c0:T,c1:U})=>({c0:T,c1:B.neg(U)}),mul014:({c0:T,c1:U},G,$,M)=>{let W=B.mul01(T,G,$),J=B.mul1(U,M);return{c0:B.add(B.mulByNonresidue(J),W),c1:B.sub(B.sub(B.mul01(B.add(U,T),G,d.add($,M)),W),J)}},mul034:({c0:T,c1:U},G,$,M)=>{const W=B.create({c0:d.mul(T.c0,G),c1:d.mul(T.c1,G),c2:d.mul(T.c2,G)}),J=B.mul01(U,$,M),oe=B.mul01(B.add(T,U),d.add(G,$),M);return{c0:B.add(B.mulByNonresidue(J),W),c1:B.sub(oe,B.add(W,J))}},_cyclotomicSquare:t.Fp12cyclotomicSquare,_cyclotomicExp:t.Fp12cyclotomicExp,finalExponentiate:t.Fp12finalExponentiate};return{Fp:r,Fp2:d,Fp6:B,Fp4Square:ne,Fp12:D}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const nt=BigInt(0),Qi=BigInt(1),ze=BigInt(2),ii=BigInt(3),Un=BigInt(4),cr=BigInt("0xd201000000010000"),k0=On(cr),{Fp:fe,Fp2:le,Fp6:Ea,Fp4Square:Js,Fp12:me}=I0({ORDER:BigInt("0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab"),FP2_NONRESIDUE:[Qi,Qi],Fp2mulByB:({c0:t,c1:e})=>{const r=fe.mul(t,Un),n=fe.mul(e,Un);return{c0:fe.sub(r,n),c1:fe.add(r,n)}},Fp12cyclotomicSquare:({c0:t,c1:e})=>{const{c0:r,c1:n,c2:i}=t,{c0:s,c1:c,c2:u}=e,{first:l,second:p}=Js(r,c),{first:b,second:x}=Js(s,i),{first:_,second:v}=Js(n,u),d=le.mulByNonresidue(v);return{c0:Ea.create({c0:le.add(le.mul(le.sub(l,r),ze),l),c1:le.add(le.mul(le.sub(b,n),ze),b),c2:le.add(le.mul(le.sub(_,i),ze),_)}),c1:Ea.create({c0:le.add(le.mul(le.add(d,s),ze),d),c1:le.add(le.mul(le.add(p,c),ze),p),c2:le.add(le.mul(le.add(x,u),ze),x)})}},Fp12cyclotomicExp(t,e){let r=me.ONE;for(let n=k0-1;n>=0;n--)r=me._cyclotomicSquare(r),l0(e,n)&&(r=me.mul(r,t));return r},Fp12finalExponentiate:t=>{const e=cr,r=me.div(me.frobeniusMap(t,6),t),n=me.mul(me.frobeniusMap(r,2),r),i=me.conjugate(me._cyclotomicExp(n,e)),s=me.mul(me.conjugate(me._cyclotomicSquare(n)),i),c=me.conjugate(me._cyclotomicExp(s,e)),u=me.conjugate(me._cyclotomicExp(c,e)),l=me.mul(me.conjugate(me._cyclotomicExp(u,e)),me._cyclotomicSquare(i)),p=me.conjugate(me._cyclotomicExp(l,e)),b=me.frobeniusMap(me.mul(i,u),2),x=me.frobeniusMap(me.mul(c,n),3),_=me.frobeniusMap(me.mul(l,me.conjugate(n)),1),v=me.mul(me.mul(p,me.conjugate(s)),n);return me.mul(me.mul(me.mul(b,x),_),v)}}),qo=Kn(BigInt("0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001")),C0=nf(le,[[["0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97d6"],["0x0","0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71a"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71e","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38d"],["0x171d6541fa38ccfaed6dea691f5fb614cb14b4e7f4e810aa22d6108f142b85757098e38d0f671c7188e2aaaaaaaa5ed1","0x0"]],[["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa63"],["0xc","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa9f"],["0x1","0x0"]],[["0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706","0x1530477c7ab4113b59a4c18b076d11930f7da5d4a07f649bf54439d87d27e500fc8c25ebf8c92f6812cfc71c71c6d706"],["0x0","0x5c759507e8e333ebb5b7a9a47d7ed8532c52d39fd3a042a88b58423c50ae15d5c2638e343d9c71c6238aaaaaaaa97be"],["0x11560bf17baa99bc32126fced787c88f984f87adf7ae0c7f9a208c6b4f20a4181472aaa9cb8d555526a9ffffffffc71c","0x8ab05f8bdd54cde190937e76bc3e447cc27c3d6fbd7063fcd104635a790520c0a395554e5c6aaaa9354ffffffffe38f"],["0x124c9ad43b6cf79bfbf7043de3811ad0761b0f37a1e26286b0e977c69aa274524e79097a56dc4bd9e1b371c71c718b10","0x0"]],[["0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa8fb"],["0x0","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffa9d3"],["0x12","0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaa99"],["0x1","0x0"]]].map(t=>t.map(e=>le.fromBigTuple(e.map(BigInt))))),M0=nf(fe,[["0x11a05f2b1e833340b809101dd99815856b303e88a2d7005ff2627b56cdb4e2c85610c2d5f2e62d6eaeac1662734649b7","0x17294ed3e943ab2f0588bab22147a81c7c17e75b2f6a8417f565e33c70d1e86b4838f2a6f318c356e834eef1b3cb83bb","0xd54005db97678ec1d1048c5d10a9a1bce032473295983e56878e501ec68e25c958c3e3d2a09729fe0179f9dac9edcb0","0x1778e7166fcc6db74e0609d307e55412d7f5e4656a8dbf25f1b33289f1b330835336e25ce3107193c5b388641d9b6861","0xe99726a3199f4436642b4b3e4118e5499db995a1257fb3f086eeb65982fac18985a286f301e77c451154ce9ac8895d9","0x1630c3250d7313ff01d1201bf7a74ab5db3cb17dd952799b9ed3ab9097e68f90a0870d2dcae73d19cd13c1c66f652983","0xd6ed6553fe44d296a3726c38ae652bfb11586264f0f8ce19008e218f9c86b2a8da25128c1052ecaddd7f225a139ed84","0x17b81e7701abdbe2e8743884d1117e53356de5ab275b4db1a682c62ef0f2753339b7c8f8c8f475af9ccb5618e3f0c88e","0x80d3cf1f9a78fc47b90b33563be990dc43b756ce79f5574a2c596c928c5d1de4fa295f296b74e956d71986a8497e317","0x169b1f8e1bcfa7c42e0c37515d138f22dd2ecb803a0c5c99676314baf4bb1b7fa3190b2edc0327797f241067be390c9e","0x10321da079ce07e272d8ec09d2565b0dfa7dccdde6787f96d50af36003b14866f69b771f8c285decca67df3f1605fb7b","0x6e08c248e260e70bd1e962381edee3d31d79d7e22c837bc23c0bf1bc24c6b68c24b1b80b64d391fa9c8ba2e8ba2d229"],["0x8ca8d548cff19ae18b2e62f4bd3fa6f01d5ef4ba35b48ba9c9588617fc8ac62b558d681be343df8993cf9fa40d21b1c","0x12561a5deb559c4348b4711298e536367041e8ca0cf0800c0126c2588c48bf5713daa8846cb026e9e5c8276ec82b3bff","0xb2962fe57a3225e8137e629bff2991f6f89416f5a718cd1fca64e00b11aceacd6a3d0967c94fedcfcc239ba5cb83e19","0x3425581a58ae2fec83aafef7c40eb545b08243f16b1655154cca8abc28d6fd04976d5243eecf5c4130de8938dc62cd8","0x13a8e162022914a80a6f1d5f43e7a07dffdfc759a12062bb8d6b44e833b306da9bd29ba81f35781d539d395b3532a21e","0xe7355f8e4e667b955390f7f0506c6e9395735e9ce9cad4d0a43bcef24b8982f7400d24bc4228f11c02df9a29f6304a5","0x772caacf16936190f3e0c63e0596721570f5799af53a1894e2e073062aede9cea73b3538f0de06cec2574496ee84a3a","0x14a7ac2a9d64a8b230b3f5b074cf01996e7f63c21bca68a81996e1cdf9822c580fa5b9489d11e2d311f7d99bbdcc5a5e","0xa10ecf6ada54f825e920b3dafc7a3cce07f8d1d7161366b74100da67f39883503826692abba43704776ec3a79a1d641","0x95fc13ab9e92ad4476d6e3eb3a56680f682b4ee96f7d03776df533978f31c1593174e4b4b7865002d6384d168ecdd0a","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"],["0x90d97c81ba24ee0259d1f094980dcfa11ad138e48a869522b52af6c956543d3cd0c7aee9b3ba3c2be9845719707bb33","0x134996a104ee5811d51036d776fb46831223e96c254f383d0f906343eb67ad34d6c56711962fa8bfe097e75a2e41c696","0xcc786baa966e66f4a384c86a3b49942552e2d658a31ce2c344be4b91400da7d26d521628b00523b8dfe240c72de1f6","0x1f86376e8981c217898751ad8746757d42aa7b90eeb791c09e4a3ec03251cf9de405aba9ec61deca6355c77b0e5f4cb","0x8cc03fdefe0ff135caf4fe2a21529c4195536fbe3ce50b879833fd221351adc2ee7f8dc099040a841b6daecf2e8fedb","0x16603fca40634b6a2211e11db8f0a6a074a7d0d4afadb7bd76505c3d3ad5544e203f6326c95a807299b23ab13633a5f0","0x4ab0b9bcfac1bbcb2c977d027796b3ce75bb8ca2be184cb5231413c4d634f3747a87ac2460f415ec961f8855fe9d6f2","0x987c8d5333ab86fde9926bd2ca6c674170a05bfe3bdd81ffd038da6c26c842642f64550fedfe935a15e4ca31870fb29","0x9fc4018bd96684be88c9e221e4da1bb8f3abd16679dc26c1e8b6e6a1f20cabe69d65201c78607a360370e577bdba587","0xe1bba7a1186bdb5223abde7ada14a23c42a0ca7915af6fe06985e7ed1e4d43b9b3f7055dd4eba6f2bafaaebca731c30","0x19713e47937cd1be0dfd0b8f1d43fb93cd2fcbcb6caf493fd1183e416389e61031bf3a5cce3fbafce813711ad011c132","0x18b46a908f36f6deb918c143fed2edcc523559b8aaf0c2462e6bfe7f911f643249d9cdf41b44d606ce07c8a4d0074d8e","0xb182cac101b9399d155096004f53f447aa7b12a3426b08ec02710e807b4633f06c851c1919211f20d4c04f00b971ef8","0x245a394ad1eca9b72fc00ae7be315dc757b3b080d4c158013e6632d3c40659cc6cf90ad1c232a6442d9d3f5db980133","0x5c129645e44cf1102a159f748c4a3fc5e673d81d7e86568d9ab0f5d396a7ce46ba1049b6579afb7866b1e715475224b","0x15e6be4e990f03ce4ea50b3b42df2eb5cb181d8f84965a3957add4fa95af01b2b665027efec01c7704b456be69c8b604"],["0x16112c4c3a9c98b252181140fad0eae9601a6de578980be6eec3232b5be72e7a07f3688ef60c206d01479253b03663c1","0x1962d75c2381201e1a0cbd6c43c348b885c84ff731c4d59ca4a10356f453e01f78a4260763529e3532f6102c2e49a03d","0x58df3306640da276faaae7d6e8eb15778c4855551ae7f310c35a5dd279cd2eca6757cd636f96f891e2538b53dbf67f2","0x16b7d288798e5395f20d23bf89edb4d1d115c5dbddbcd30e123da489e726af41727364f2c28297ada8d26d98445f5416","0xbe0e079545f43e4b00cc912f8228ddcc6d19c9f0f69bbb0542eda0fc9dec916a20b15dc0fd2ededda39142311a5001d","0x8d9e5297186db2d9fb266eaac783182b70152c65550d881c5ecd87b6f0f5a6449f38db9dfa9cce202c6477faaf9b7ac","0x166007c08a99db2fc3ba8734ace9824b5eecfdfa8d0cf8ef5dd365bc400a0051d5fa9c01a58b1fb93d1a1399126a775c","0x16a3ef08be3ea7ea03bcddfabba6ff6ee5a4375efa1f4fd7feb34fd206357132b920f5b00801dee460ee415a15812ed9","0x1866c8ed336c61231a1be54fd1d74cc4f9fb0ce4c6af5920abc5750c4bf39b4852cfe2f7bb9248836b233d9d55535d4a","0x167a55cda70a6e1cea820597d94a84903216f763e13d87bb5308592e7ea7d4fbc7385ea3d529b35e346ef48bb8913f55","0x4d2f259eea405bd48f010a01ad2911d9c6dd039bb61a6290e591b36e636a5c871a5c29f4f83060400f8b49cba8f6aa8","0xaccbb67481d033ff5852c1e48c50c477f94ff8aefce42d28c0f9a88cea7913516f968986f7ebbea9684b529e2561092","0xad6b9514c767fe3c3613144b45f1496543346d98adf02267d5ceef9a00d9b8693000763e3b90ac11e99b138573345cc","0x2660400eb2e4f3b628bdd0d53cd76f2bf565b94e72927c1cb748df27942480e420517bd8714cc80d1fadc1326ed06f7","0xe0fa1d816ddc03e6b24255e0d7819c171c40f65e273b853324efcd6356caa205ca2f570f13497804415473a1d634b8f","0x000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),$0=ff(le,{A:le.create({c0:fe.create(nt),c1:fe.create(BigInt(240))}),B:le.create({c0:fe.create(BigInt(1012)),c1:fe.create(BigInt(1012))}),Z:le.create({c0:fe.create(BigInt(-2)),c1:fe.create(BigInt(-1))})}),G0=ff(fe,{A:fe.create(BigInt("0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aefd881ac98936f8da0e0f97f5cf428082d584c1d")),B:fe.create(BigInt("0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14fcef35ef55a23215a316ceaa5d1cc48e98e172be0")),Z:fe.create(BigInt(11))}),{G2psi:Ho,G2psi2:V0}=P0(fe,le,le.div(le.ONE,le.NONRESIDUE)),Qs=Object.freeze({DST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",encodeDST:"BLS_SIG_BLS12381G2_XMD:SHA-256_SSWU_RO_NUL_",p:fe.ORDER,m:2,k:128,expand:"xmd",hash:Ma}),Li=Cn(fe.toBytes(nt),{infinity:!0,compressed:!0});function si(t){t=t.slice();const e=t[0]&224,r=!!(e>>7&1),n=!!(e>>6&1),i=!!(e>>5&1);return t[0]&=31,{compressed:r,infinity:n,sort:i,value:t}}function Cn(t,e){if(t[0]&224)throw new Error("setMask: non-empty mask");return e.compressed&&(t[0]|=128),e.infinity&&(t[0]|=64),e.sort&&(t[0]|=32),t}function jo(t){t.assertValidity();const e=t.equals(ht.G1.ProjectivePoint.ZERO),{x:r,y:n}=t.toAffine();if(e)return Li.slice();const i=fe.ORDER,s=!!(n*ze/i);return Cn(Xe(r,fe.BYTES),{compressed:!0,sort:s})}function Ko(t){t.assertValidity();const e=fe.BYTES;if(t.equals(ht.G2.ProjectivePoint.ZERO))return Ge(Li,Xe(nt,e));const{x:r,y:n}=t.toAffine(),{re:i,im:s}=le.reim(r),{re:c,im:u}=le.reim(n),p=!!((u>nt?u*ze:c*ze)/fe.ORDER&Qi),b=i;return Ge(Cn(Xe(s,e),{sort:p,compressed:!0}),Xe(b,e))}const ht=U0({fields:{Fp:fe,Fp2:le,Fp6:Ea,Fp12:me,Fr:qo},G1:{Fp:fe,h:BigInt("0x396c8c005555e1568c00aaab0000aaab"),Gx:BigInt("0x17f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586c55e83ff97a1aeffb3af00adb22c6bb"),Gy:BigInt("0x08b3f481e3aaa0f1a09e30ed741d8ae4fcf5e095d5d00af600db18cb2c04b3edd03cc744a2888ae40caa232946c5e7e1"),a:fe.ZERO,b:Un,htfDefaults:{...Qs,m:1,DST:"BLS_SIG_BLS12381G1_XMD:SHA-256_SSWU_RO_NUL_"},wrapPrivateKey:!0,allowInfinityPoint:!0,isTorsionFree:(t,e)=>{const r=BigInt("0x5f19672fdf76ce51ba69c6076a0f77eaddb3a93be6f89688de17d813620a00022e01fffffffefffe"),n=new t(fe.mul(e.px,r),e.py,e.pz);return e.multiplyUnsafe(cr).negate().multiplyUnsafe(cr).equals(n)},clearCofactor:(t,e)=>e.multiplyUnsafe(cr).add(e),mapToCurve:t=>{const{x:e,y:r}=G0(fe.create(t[0]));return M0(e,r)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=si(t);if(i.length===48&&e){const s=fe.ORDER,c=St(i),u=fe.create(c&fe.MASK);if(r){if(u!==nt)throw new Error("G1: non-empty compressed point at infinity");return{x:nt,y:nt}}const l=fe.add(fe.pow(u,ii),fe.create(ht.params.G1b));let p=fe.sqrt(l);if(!p)throw new Error("invalid compressed G1 point");return p*ze/s!==BigInt(n)&&(p=fe.neg(p)),{x:fe.create(u),y:fe.create(p)}}else if(i.length===96&&!e){const s=St(i.subarray(0,fe.BYTES)),c=St(i.subarray(fe.BYTES));if(r){if(s!==nt||c!==nt)throw new Error("G1: non-empty point at infinity");return ht.G1.ProjectivePoint.ZERO.toAffine()}return{x:fe.create(s),y:fe.create(c)}}else throw new Error("invalid point G1, expected 48/96 bytes")},toBytes:(t,e,r)=>{const n=e.equals(t.ZERO),{x:i,y:s}=e.toAffine();if(r){if(n)return Li.slice();const c=fe.ORDER,u=!!(s*ze/c);return Cn(Xe(i,fe.BYTES),{compressed:!0,sort:u})}else return n?Ge(new Uint8Array([64]),new Uint8Array(2*fe.BYTES-1)):Ge(Xe(i,fe.BYTES),Xe(s,fe.BYTES))},ShortSignature:{fromHex(t){const{infinity:e,sort:r,value:n}=si(it("signatureHex",t,48)),i=fe.ORDER,s=St(n);if(e)return ht.G1.ProjectivePoint.ZERO;const c=fe.create(s&fe.MASK),u=fe.add(fe.pow(c,ii),fe.create(ht.params.G1b));let l=fe.sqrt(u);if(!l)throw new Error("invalid compressed G1 point");const p=BigInt(r);l*ze/i!==p&&(l=fe.neg(l));const b=ht.G1.ProjectivePoint.fromAffine({x:c,y:l});return b.assertValidity(),b},toRawBytes(t){return jo(t)},toHex(t){return Pr(jo(t))}}},G2:{Fp:le,h:BigInt("0x5d543a95414e7f1091d50792876a202cd91de4547085abaa68a205b2e5a7ddfa628f1cb4d9e82ef21537e293a6691ae1616ec6e786f0c70cf1c38e31c7238e5"),Gx:le.fromBigTuple([BigInt("0x024aa2b2f08f0a91260805272dc51051c6e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"),BigInt("0x13e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f5049334cf11213945d57e5ac7d055d042b7e")]),Gy:le.fromBigTuple([BigInt("0x0ce5d527727d6e118cc9cdc6da2e351aadfd9baa8cbdd3a76d429a695160d12c923ac9cc3baca289e193548608b82801"),BigInt("0x0606c4a02ea734cc32acd2b02bc28b99cb3e287e85a763af267492ab572e99ab3f370d275cec1da1aaa9075ff05f79be")]),a:le.ZERO,b:le.fromBigTuple([Un,Un]),hEff:BigInt("0xbc69f08f2ee75b3584c6a0ea91b352888e2a8e9145ad7689986ff031508ffe1329c2f178731db956d82bf015d1212b02ec0ec69d7477c1ae954cbc06689f6a359894c0adebbf6b4e8020005aaa95551"),htfDefaults:{...Qs},wrapPrivateKey:!0,allowInfinityPoint:!0,mapToCurve:t=>{const{x:e,y:r}=$0(le.fromBigTuple(t));return C0(e,r)},isTorsionFree:(t,e)=>e.multiplyUnsafe(cr).negate().equals(Ho(t,e)),clearCofactor:(t,e)=>{const r=cr;let n=e.multiplyUnsafe(r).negate(),i=Ho(t,e),s=e.double();return s=V0(t,s),s=s.subtract(i),i=n.add(i),i=i.multiplyUnsafe(r).negate(),s=s.add(i),s=s.subtract(n),s.subtract(e)},fromBytes:t=>{const{compressed:e,infinity:r,sort:n,value:i}=si(t);if(!e&&!r&&n||!e&&r&&n||n&&r&&e)throw new Error("invalid encoding flag: "+(t[0]&224));const s=fe.BYTES,c=(u,l,p)=>St(u.slice(l,p));if(i.length===96&&e){const u=ht.params.G2b,l=fe.ORDER;if(r){if(i.reduce((A,S)=>A!==0?S+1:S,0)>0)throw new Error("invalid compressed G2 point");return{x:le.ZERO,y:le.ZERO}}const p=c(i,0,s),b=c(i,s,2*s),x=le.create({c0:fe.create(b),c1:fe.create(p)}),_=le.add(le.pow(x,ii),u);let v=le.sqrt(_);const d=v.c1===nt?v.c0*ze/l:v.c1*ze/l?Qi:nt;return v=n&&d>0?v:le.neg(v),{x,y:v}}else if(i.length===192&&!e){if(r){if(i.reduce((x,_)=>x!==0?_+1:_,0)>0)throw new Error("invalid uncompressed G2 point");return{x:le.ZERO,y:le.ZERO}}const u=c(i,0,s),l=c(i,s,2*s),p=c(i,2*s,3*s),b=c(i,3*s,4*s);return{x:le.fromBigTuple([l,u]),y:le.fromBigTuple([b,p])}}else throw new Error("invalid point G2, expected 96/192 bytes")},toBytes:(t,e,r)=>{const{BYTES:n,ORDER:i}=fe,s=e.equals(t.ZERO),{x:c,y:u}=e.toAffine();if(r){if(s)return Ge(Li,Xe(nt,n));const l=!!(u.c1===nt?u.c0*ze/i:u.c1*ze/i);return Ge(Cn(Xe(c.c1,n),{compressed:!0,sort:l}),Xe(c.c0,n))}else{if(s)return Ge(new Uint8Array([64]),new Uint8Array(4*n-1));const{re:l,im:p}=le.reim(c),{re:b,im:x}=le.reim(u);return Ge(Xe(p,n),Xe(l,n),Xe(x,n),Xe(b,n))}},Signature:{fromHex(t){const{infinity:e,sort:r,value:n}=si(it("signatureHex",t)),i=fe.ORDER,s=n.length/2;if(s!==48&&s!==96)throw new Error("invalid compressed signature length, must be 96 or 192");const c=St(n.slice(0,s)),u=St(n.slice(s));if(e)return ht.G2.ProjectivePoint.ZERO;const l=fe.create(c&fe.MASK),p=fe.create(u),b=le.create({c0:p,c1:l}),x=le.add(le.pow(b,ii),ht.params.G2b);let _=le.sqrt(x);if(!_)throw new Error("Failed to find a square root");const{re:v,im:d}=le.reim(_),A=BigInt(r),S=d>nt&&d*ze/i!==A,P=d===nt&&v*ze/i!==A;(S||P)&&(_=le.neg(_));const I=ht.G2.ProjectivePoint.fromAffine({x:b,y:_});return I.assertValidity(),I},toRawBytes(t){return Ko(t)},toHex(t){return Pr(Ko(t))}}},params:{ateLoopSize:cr,r:qo.ORDER,xNegative:!0,twistType:"multiplicative"},htfDefaults:Qs,hash:Ma,randomBytes:Mc});function q0(t,e,r){const n=typeof t=="string"?t:Re(t),i=typeof e=="string"?e:Re(e),s=typeof r=="string"?r:Re(r);return ht.verifyShortSignature(i,s,n)}const lf=t=>Ke(new nn(t)),Qa=t=>{const e=lf(t);return new Date(Number(e)/1e6)};var H0=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},j0=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},mi;class Mt extends Pe{constructor(e){super(`Invalid certificate: ${e}`)}}var dt;(function(t){t[t.Empty=0]="Empty",t[t.Fork=1]="Fork",t[t.Labeled=2]="Labeled",t[t.Leaf=3]="Leaf",t[t.Pruned=4]="Pruned"})(dt||(dt={}));function K0(t,e){const r=new Uint8Array(t),n=new Uint8Array(e);for(let i=0;i<r.length;i++)if(r[i]>n[i])return!0;return!1}class Rr{constructor(e,r,n,i,s=5,c=!1){this._rootKey=r,this._canisterId=n,this._blsVerify=i,this._maxAgeInMinutes=s,mi.set(this,!1),H0(this,mi,c,"f"),this.cert=Zt(new Uint8Array(e))}static async create(e){const r=Rr.createUnverified(e);return await r.verify(),r}static createUnverified(e){let r=e.blsVerify;return r||(r=q0),new Rr(e.certificate,e.rootKey,e.canisterId,r,e.maxAgeInMinutes,e.disableTimeVerification)}lookup(e){return rn(e,this.cert.tree)}lookup_label(e){return this.lookup([e])}async verify(){const e=await _i(this.cert.tree),r=await this._checkDelegationAndGetKey(this.cert.delegation),n=this.cert.signature,i=W0(r),s=Nt(bn("ic-state-root"),e);let c=!1;const u=yt(this.lookup(["time"]));if(!u)throw new Mt("Certificate does not contain a time");if(!j0(this,mi,"f")){const p=this._maxAgeInMinutes*60*1e3,b=Date.now(),x=b-p,_=b+3e5,v=Qa(u);if(v.getTime()<x)throw new Mt(`Certificate is signed more than ${this._maxAgeInMinutes} minutes in the past. Certificate time: `+v.toISOString()+" Current time: "+new Date(b).toISOString());if(v.getTime()>_)throw new Mt("Certificate is signed more than 5 minutes in the future. Certificate time: "+v.toISOString()+" Current time: "+new Date(b).toISOString())}try{c=await this._blsVerify(new Uint8Array(i),new Uint8Array(n),new Uint8Array(s))}catch{c=!1}if(!c)throw new Mt("Signature verification failed")}async _checkDelegationAndGetKey(e){if(!e)return this._rootKey;const r=await Rr.createUnverified({certificate:e.certificate,rootKey:this._rootKey,canisterId:this._canisterId,blsVerify:this._blsVerify,maxAgeInMinutes:1/0});if(r.cert.delegation)throw new Mt("Delegation certificates cannot be nested");if(await r.verify(),this._canisterId.toString()!==Gh&&!df({canisterId:this._canisterId,subnetId:ye.fromUint8Array(new Uint8Array(e.subnet_id)),tree:r.cert.tree}))throw new Mt(`Canister ${this._canisterId} not in range of delegations for subnet 0x${Re(e.subnet_id)}`);const n=yt(r.lookup(["subnet",e.subnet_id,"public_key"]));if(!n)throw new Error(`Could not find subnet key for subnet 0x${Re(e.subnet_id)}`);return n}}mi=new WeakMap;const gn=Qt("308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100"),z0=96;function W0(t){const e=gn.byteLength+z0;if(t.byteLength!==e)throw new TypeError(`BLS DER-encoded public key must be ${e} bytes long`);const r=t.slice(0,gn.byteLength);if(!Gn(r,gn))throw new TypeError(`BLS DER-encoded public key is invalid. Expect the following prefix: ${gn}, but get ${r}`);return t.slice(gn.byteLength)}function yt(t){if(t.status===Ve.Found){if(t.value instanceof ArrayBuffer)return t.value;if(t.value instanceof Uint8Array)return t.value.buffer}}async function _i(t){switch(t[0]){case dt.Empty:return At(bn("ic-hashtree-empty"));case dt.Pruned:return t[1];case dt.Leaf:return At(Nt(bn("ic-hashtree-leaf"),t[1]));case dt.Labeled:return At(Nt(bn("ic-hashtree-labeled"),t[1],await _i(t[2])));case dt.Fork:return At(Nt(bn("ic-hashtree-fork"),await _i(t[1]),await _i(t[2])));default:throw new Error("unreachable")}}function bn(t){const e=new Uint8Array([t.length]),r=new TextEncoder().encode(t);return Nt(e,r)}var Ve;(function(t){t.Unknown="unknown",t.Absent="absent",t.Found="found"})(Ve||(Ve={}));var Wt;(function(t){t.Less="less",t.Greater="greater"})(Wt||(Wt={}));function rn(t,e){if(t.length===0)switch(e[0]){case dt.Leaf:{if(!e[1])throw new Error("Invalid tree structure for leaf");return e[1]instanceof ArrayBuffer?{status:Ve.Found,value:e[1]}:e[1]instanceof Uint8Array?{status:Ve.Found,value:e[1].buffer}:{status:Ve.Found,value:e[1]}}default:return{status:Ve.Found,value:e}}const r=typeof t[0]=="string"?new TextEncoder().encode(t[0]):t[0],n=vi(r,e);switch(n.status){case Ve.Found:return rn(t.slice(1),n.value);case Wt.Greater:case Wt.Less:return{status:Ve.Absent};default:return n}}function Ta(t){switch(t[0]){case dt.Empty:return[];case dt.Fork:return Ta(t[1]).concat(Ta(t[2]));default:return[t]}}function vi(t,e){switch(e[0]){case dt.Labeled:return K0(t,e[1])?{status:Wt.Greater}:Gn(t,e[1])?{status:Ve.Found,value:e[2]}:{status:Wt.Less};case dt.Fork:const r=vi(t,e[1]);switch(r.status){case Wt.Greater:{const n=vi(t,e[2]);return n.status===Wt.Less?{status:Ve.Absent}:n}case Ve.Unknown:{let n=vi(t,e[2]);return n.status===Wt.Less?{status:Ve.Unknown}:n}default:return r}case dt.Pruned:return{status:Ve.Unknown};default:return{status:Ve.Absent}}}function df(t){const{canisterId:e,subnetId:r,tree:n}=t,i=rn(["subnet",r.toUint8Array(),"canister_ranges"],n);if(i.status!==Ve.Found||!(i.value instanceof ArrayBuffer))throw new Error(`Could not find canister ranges for subnet ${r}`);return Zt(i.value).map(l=>[ye.fromUint8Array(l[0]),ye.fromUint8Array(l[1])]).some(l=>l[0].ltEq(e)&&l[1].gtEq(e))}class Y0{constructor(e,r,n){this.key=e,this.path=r,this.decodeStrategy=n}}const hf=async t=>{const{agent:e,paths:r}=t,n=ye.from(t.canisterId),i=[...new Set(r)],s=i.map(l=>Sa(l,n)),c=new Map,u=i.map((l,p)=>(async()=>{var b;try{const x=await e.readState(n,{paths:[s[p]]});if(e.rootKey==null)throw new Error("Agent is missing root key");const _=await Rr.create({certificate:x.certificate,rootKey:e.rootKey,canisterId:n,disableTimeVerification:!0}),v=(S,P)=>{if(P==="subnet"){if(e.rootKey==null)throw new Error("Agent is missing root key");const I=pf(x.certificate,n,e.rootKey);return{path:P,data:I}}else return{path:P,data:yt(S.lookup(Sa(P,n)))}},{path:d,data:A}=v(_,i[p]);if(!A)console.warn(`Expected to find result for path ${d}, but instead found nothing.`),typeof d=="string"?c.set(d,null):c.set(d.key,null);else switch(d){case"time":{c.set(d,Qa(A));break}case"controllers":{c.set(d,X0(A));break}case"module_hash":{c.set(d,zo(A));break}case"subnet":{c.set(d,A);break}case"candid":{c.set(d,new TextDecoder().decode(A));break}default:if(typeof d!="string"&&"key"in d&&"path"in d)switch(d.decodeStrategy){case"raw":c.set(d.key,A);break;case"leb128":{c.set(d.key,lf(A));break}case"cbor":{c.set(d.key,gf(A));break}case"hex":{c.set(d.key,zo(A));break}case"utf-8":c.set(d.key,Z0(A))}}}catch(x){if(!((b=x?.message)===null||b===void 0)&&b.includes("Invalid certificate"))throw new Pe(x.message);typeof l!="string"&&"key"in l&&"path"in l?c.set(l.key,null):c.set(l,null),console.group(),console.warn(`Expected to find result for path ${l}, but instead found nothing.`),console.warn(x),console.groupEnd()}})());return await Promise.all(u),c},pf=(t,e,r)=>{if(!e._isPrincipal)throw new Error("Invalid canisterId");const n=Zt(new Uint8Array(t)),i=n.tree;let s=n.delegation,c;if(s&&s.subnet_id?c=ye.fromUint8Array(new Uint8Array(s.subnet_id)):!s&&typeof r<"u"?(c=ye.selfAuthenticating(new Uint8Array(r)),s={subnet_id:c.toUint8Array(),certificate:new ArrayBuffer(0)}):(c=ye.selfAuthenticating(ye.fromText("tdb26-jop6k-aogll-7ltgs-eruif-6kk7m-qpktf-gdiqx-mxtrf-vb5e6-eqe").toUint8Array()),s={subnet_id:c.toUint8Array(),certificate:new ArrayBuffer(0)}),!df({canisterId:e,subnetId:c,tree:i}))throw new Error("Canister not in range");const l=rn(["subnet",s.subnet_id,"node"],i);if(l.status!==Ve.Found)throw new Error("Node not found");if(l.value instanceof ArrayBuffer)throw new Error("Invalid node tree");const p=Ta(l.value),b=new Map;return p.forEach(x=>{const _=ye.from(new Uint8Array(x[1])).toText(),v=rn(["public_key"],x[2]);if(v.status!==Ve.Found)throw new Error("Public key not found");const d=v.value;if(d.byteLength!==44)throw new Error("Invalid public key length");b.set(_,d)}),{subnetId:ye.fromUint8Array(new Uint8Array(s.subnet_id)).toText(),nodeKeys:b}},Sa=(t,e)=>{const r=new TextEncoder,n=s=>new DataView(r.encode(s).buffer).buffer,i=new DataView(e.toUint8Array().buffer).buffer;switch(t){case"time":return[n("time")];case"controllers":return[n("canister"),i,n("controllers")];case"module_hash":return[n("canister"),i,n("module_hash")];case"subnet":return[n("subnet")];case"candid":return[n("canister"),i,n("metadata"),n("candid:service")];default:if("key"in t&&"path"in t)if(typeof t.path=="string"||t.path instanceof ArrayBuffer){const s=t.path,c=typeof s=="string"?n(s):s;return[n("canister"),i,n("metadata"),c]}else return t.path}throw new Error(`An unexpeected error was encountered while encoding your path for canister status. Please ensure that your path, ${t} was formatted correctly.`)},zo=t=>Re(t),gf=t=>Zt(t),Z0=t=>new TextDecoder().decode(t),X0=t=>gf(t).map(r=>ye.fromUint8Array(new Uint8Array(r))),J0=Object.freeze(Object.defineProperty({__proto__:null,CustomPath:Y0,encodePath:Sa,fetchNodeKeys:pf,request:hf},Symbol.toStringTag,{value:"Module"})),ai=BigInt(2**32-1),Aa=BigInt(32);function yf(t,e=!1){return e?{h:Number(t&ai),l:Number(t>>Aa&ai)}:{h:Number(t>>Aa&ai)|0,l:Number(t&ai)|0}}function Q0(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){const{h:s,l:c}=yf(t[i],e);[r[i],n[i]]=[s,c]}return[r,n]}const L0=(t,e)=>BigInt(t>>>0)<<Aa|BigInt(e>>>0),D0=(t,e,r)=>t>>>r,eh=(t,e,r)=>t<<32-r|e>>>r,th=(t,e,r)=>t>>>r|e<<32-r,rh=(t,e,r)=>t<<32-r|e>>>r,nh=(t,e,r)=>t<<64-r|e>>>r-32,ih=(t,e,r)=>t>>>r-32|e<<64-r,sh=(t,e)=>e,ah=(t,e)=>t,oh=(t,e,r)=>t<<r|e>>>32-r,ch=(t,e,r)=>e<<r|t>>>32-r,uh=(t,e,r)=>e<<r-32|t>>>64-r,fh=(t,e,r)=>t<<r-32|e>>>64-r;function lh(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}const dh=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),hh=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,ph=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),gh=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,yh=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),wh=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,ge={fromBig:yf,split:Q0,toBig:L0,shrSH:D0,shrSL:eh,rotrSH:th,rotrSL:rh,rotrBH:nh,rotrBL:ih,rotr32H:sh,rotr32L:ah,rotlSH:oh,rotlSL:ch,rotlBH:uh,rotlBL:fh,add:lh,add3L:dh,add3H:hh,add4L:ph,add4H:gh,add5H:wh,add5L:yh},[bh,mh]=ge.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),rr=new Uint32Array(80),nr=new Uint32Array(80);class _h extends $c{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:n,Bl:i,Ch:s,Cl:c,Dh:u,Dl:l,Eh:p,El:b,Fh:x,Fl:_,Gh:v,Gl:d,Hh:A,Hl:S}=this;return[e,r,n,i,s,c,u,l,p,b,x,_,v,d,A,S]}set(e,r,n,i,s,c,u,l,p,b,x,_,v,d,A,S){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=s|0,this.Cl=c|0,this.Dh=u|0,this.Dl=l|0,this.Eh=p|0,this.El=b|0,this.Fh=x|0,this.Fl=_|0,this.Gh=v|0,this.Gl=d|0,this.Hh=A|0,this.Hl=S|0}process(e,r){for(let R=0;R<16;R++,r+=4)rr[R]=e.getUint32(r),nr[R]=e.getUint32(r+=4);for(let R=16;R<80;R++){const H=rr[R-15]|0,B=nr[R-15]|0,j=ge.rotrSH(H,B,1)^ge.rotrSH(H,B,8)^ge.shrSH(H,B,7),V=ge.rotrSL(H,B,1)^ge.rotrSL(H,B,8)^ge.shrSL(H,B,7),K=rr[R-2]|0,Y=nr[R-2]|0,z=ge.rotrSH(K,Y,19)^ge.rotrBH(K,Y,61)^ge.shrSH(K,Y,6),ne=ge.rotrSL(K,Y,19)^ge.rotrBL(K,Y,61)^ge.shrSL(K,Y,6),D=ge.add4L(V,ne,nr[R-7],nr[R-16]),T=ge.add4H(D,j,z,rr[R-7],rr[R-16]);rr[R]=T|0,nr[R]=D|0}let{Ah:n,Al:i,Bh:s,Bl:c,Ch:u,Cl:l,Dh:p,Dl:b,Eh:x,El:_,Fh:v,Fl:d,Gh:A,Gl:S,Hh:P,Hl:I}=this;for(let R=0;R<80;R++){const H=ge.rotrSH(x,_,14)^ge.rotrSH(x,_,18)^ge.rotrBH(x,_,41),B=ge.rotrSL(x,_,14)^ge.rotrSL(x,_,18)^ge.rotrBL(x,_,41),j=x&v^~x&A,V=_&d^~_&S,K=ge.add5L(I,B,V,mh[R],nr[R]),Y=ge.add5H(K,P,H,j,bh[R],rr[R]),z=K|0,ne=ge.rotrSH(n,i,28)^ge.rotrBH(n,i,34)^ge.rotrBH(n,i,39),D=ge.rotrSL(n,i,28)^ge.rotrBL(n,i,34)^ge.rotrBL(n,i,39),T=n&s^n&u^s&u,U=i&c^i&l^c&l;P=A|0,I=S|0,A=v|0,S=d|0,v=x|0,d=_|0,{h:x,l:_}=ge.add(p|0,b|0,Y|0,z|0),p=u|0,b=l|0,u=s|0,l=c|0,s=n|0,c=i|0;const G=ge.add3L(z,D,U);n=ge.add3H(G,Y,ne,T),i=G|0}({h:n,l:i}=ge.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:s,l:c}=ge.add(this.Bh|0,this.Bl|0,s|0,c|0),{h:u,l}=ge.add(this.Ch|0,this.Cl|0,u|0,l|0),{h:p,l:b}=ge.add(this.Dh|0,this.Dl|0,p|0,b|0),{h:x,l:_}=ge.add(this.Eh|0,this.El|0,x|0,_|0),{h:v,l:d}=ge.add(this.Fh|0,this.Fl|0,v|0,d|0),{h:A,l:S}=ge.add(this.Gh|0,this.Gl|0,A|0,S|0),{h:P,l:I}=ge.add(this.Hh|0,this.Hl|0,P|0,I|0),this.set(n,i,s,c,u,l,p,b,x,_,v,d,A,S,P,I)}roundClean(){rr.fill(0),nr.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const vh=Ca(()=>new _h);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const vt=BigInt(0),ot=BigInt(1),oi=BigInt(2),xh=BigInt(8),Eh={zip215:!0};function Th(t){const e=uf(t);return jn(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function Sh(t){const e=Th(t),{Fp:r,n,prehash:i,hash:s,randomBytes:c,nByteLength:u,h:l}=e,p=oi<<BigInt(u*8)-ot,b=r.create,x=Kn(e.n,e.nBitLength),_=e.uvRatio||(($,M)=>{try{return{isValid:!0,value:r.sqrt($*r.inv(M))}}catch{return{isValid:!1,value:vt}}}),v=e.adjustScalarBytes||($=>$),d=e.domain||(($,M,W)=>{if(Bn("phflag",W),M.length||W)throw new Error("Contexts/pre-hash are not supported");return $});function A($,M){lr("coordinate "+$,M,vt,p)}function S($){if(!($ instanceof R))throw new Error("ExtendedPoint expected")}const P=In(($,M)=>{const{ex:W,ey:J,ez:oe}=$,se=$.is0();M==null&&(M=se?xh:r.inv(oe));const ue=b(W*M),Z=b(J*M),g=b(oe*M);if(se)return{x:vt,y:ot};if(g!==ot)throw new Error("invZ was invalid");return{x:ue,y:Z}}),I=In($=>{const{a:M,d:W}=e;if($.is0())throw new Error("bad point: ZERO");const{ex:J,ey:oe,ez:se,et:ue}=$,Z=b(J*J),g=b(oe*oe),L=b(se*se),ie=b(L*L),ae=b(Z*M),X=b(L*b(ae+g)),te=b(ie+b(W*b(Z*g)));if(X!==te)throw new Error("bad point: equation left != right (1)");const y=b(J*oe),m=b(se*ue);if(y!==m)throw new Error("bad point: equation left != right (2)");return!0});class R{constructor(M,W,J,oe){this.ex=M,this.ey=W,this.ez=J,this.et=oe,A("x",M),A("y",W),A("z",J),A("t",oe),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(M){if(M instanceof R)throw new Error("extended point not allowed");const{x:W,y:J}=M||{};return A("x",W),A("y",J),new R(W,J,ot,b(W*J))}static normalizeZ(M){const W=r.invertBatch(M.map(J=>J.ez));return M.map((J,oe)=>J.toAffine(W[oe])).map(R.fromAffine)}static msm(M,W){return cf(R,x,M,W)}_setWindowSize(M){j.setWindowSize(this,M)}assertValidity(){I(this)}equals(M){S(M);const{ex:W,ey:J,ez:oe}=this,{ex:se,ey:ue,ez:Z}=M,g=b(W*Z),L=b(se*oe),ie=b(J*Z),ae=b(ue*oe);return g===L&&ie===ae}is0(){return this.equals(R.ZERO)}negate(){return new R(b(-this.ex),this.ey,this.ez,b(-this.et))}double(){const{a:M}=e,{ex:W,ey:J,ez:oe}=this,se=b(W*W),ue=b(J*J),Z=b(oi*b(oe*oe)),g=b(M*se),L=W+J,ie=b(b(L*L)-se-ue),ae=g+ue,X=ae-Z,te=g-ue,y=b(ie*X),m=b(ae*te),E=b(ie*te),k=b(X*ae);return new R(y,m,k,E)}add(M){S(M);const{a:W,d:J}=e,{ex:oe,ey:se,ez:ue,et:Z}=this,{ex:g,ey:L,ez:ie,et:ae}=M;if(W===BigInt(-1)){const w=b((se-oe)*(L+g)),N=b((se+oe)*(L-g)),q=b(N-w);if(q===vt)return this.double();const Q=b(ue*oi*ae),ce=b(Z*oi*ie),de=ce+Q,he=N+w,ee=ce-Q,pe=b(de*q),Ne=b(he*ee),et=b(de*ee),bt=b(q*he);return new R(pe,Ne,bt,et)}const X=b(oe*g),te=b(se*L),y=b(Z*J*ae),m=b(ue*ie),E=b((oe+se)*(g+L)-X-te),k=m-y,F=m+y,C=b(te-W*X),f=b(E*k),a=b(F*C),o=b(E*C),h=b(k*F);return new R(f,a,h,o)}subtract(M){return this.add(M.negate())}wNAF(M){return j.wNAFCached(this,M,R.normalizeZ)}multiply(M){const W=M;lr("scalar",W,ot,n);const{p:J,f:oe}=this.wNAF(W);return R.normalizeZ([J,oe])[0]}multiplyUnsafe(M,W=R.ZERO){const J=M;return lr("scalar",J,vt,n),J===vt?B:this.is0()||J===ot?this:j.wNAFCachedUnsafe(this,J,R.normalizeZ,W)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return j.unsafeLadder(this,n).is0()}toAffine(M){return P(this,M)}clearCofactor(){const{h:M}=e;return M===ot?this:this.multiplyUnsafe(M)}static fromHex(M,W=!1){const{d:J,a:oe}=e,se=r.BYTES;M=it("pointHex",M,se),Bn("zip215",W);const ue=M.slice(),Z=M[se-1];ue[se-1]=Z&-129;const g=Rn(ue),L=W?p:r.ORDER;lr("pointHex.y",g,vt,L);const ie=b(g*g),ae=b(ie-ot),X=b(J*ie-oe);let{isValid:te,value:y}=_(ae,X);if(!te)throw new Error("Point.fromHex: invalid y coordinate");const m=(y&ot)===ot,E=(Z&128)!==0;if(!W&&y===vt&&E)throw new Error("Point.fromHex: x=0 and x_0=1");return E!==m&&(y=b(-y)),R.fromAffine({x:y,y:g})}static fromPrivateKey(M){return Y(M).point}toRawBytes(){const{x:M,y:W}=this.toAffine(),J=Xi(W,r.BYTES);return J[J.length-1]|=M&ot?128:0,J}toHex(){return Pr(this.toRawBytes())}}R.BASE=new R(e.Gx,e.Gy,ot,b(e.Gx*e.Gy)),R.ZERO=new R(vt,ot,ot,vt);const{BASE:H,ZERO:B}=R,j=of(R,u*8);function V($){return Fe($,n)}function K($){return V(Rn($))}function Y($){const M=r.BYTES;$=it("private key",$,M);const W=it("hashed private key",s($),2*M),J=v(W.slice(0,M)),oe=W.slice(M,2*M),se=K(J),ue=H.multiply(se),Z=ue.toRawBytes();return{head:J,prefix:oe,scalar:se,point:ue,pointBytes:Z}}function z($){return Y($).pointBytes}function ne($=new Uint8Array,...M){const W=Ge(...M);return K(s(d(W,it("context",$),!!i)))}function D($,M,W={}){$=it("message",$),i&&($=i($));const{prefix:J,scalar:oe,pointBytes:se}=Y(M),ue=ne(W.context,J,$),Z=H.multiply(ue).toRawBytes(),g=ne(W.context,Z,se,$),L=V(ue+g*oe);lr("signature.s",L,vt,n);const ie=Ge(Z,Xi(L,r.BYTES));return it("result",ie,r.BYTES*2)}const T=Eh;function U($,M,W,J=T){const{context:oe,zip215:se}=J,ue=r.BYTES;$=it("signature",$,2*ue),M=it("message",M),W=it("publicKey",W,ue),se!==void 0&&Bn("zip215",se),i&&(M=i(M));const Z=Rn($.slice(ue,2*ue));let g,L,ie;try{g=R.fromHex(W,se),L=R.fromHex($.slice(0,ue),se),ie=H.multiplyUnsafe(Z)}catch{return!1}if(!se&&g.isSmallOrder())return!1;const ae=ne(oe,L.toRawBytes(),g.toRawBytes(),M);return L.add(g.multiplyUnsafe(ae)).subtract(ie).clearCofactor().equals(R.ZERO)}return H._setWindowSize(8),{CURVE:e,getPublicKey:z,sign:D,verify:U,ExtendedPoint:R,utils:{getExtendedPublicKey:Y,randomPrivateKey:()=>c(r.BYTES),precompute($=8,M=R.BASE){return M._setWindowSize($),M.multiply(BigInt(3)),M}}}}/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const La=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Wo=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const Ah=BigInt(1),Yo=BigInt(2);BigInt(3);const Nh=BigInt(5),Bh=BigInt(8);function Rh(t){const e=BigInt(10),r=BigInt(20),n=BigInt(40),i=BigInt(80),s=La,u=t*t%s*t%s,l=Ut(u,Yo,s)*u%s,p=Ut(l,Ah,s)*t%s,b=Ut(p,Nh,s)*p%s,x=Ut(b,e,s)*b%s,_=Ut(x,r,s)*x%s,v=Ut(_,n,s)*_%s,d=Ut(v,i,s)*v%s,A=Ut(d,i,s)*v%s,S=Ut(A,e,s)*b%s;return{pow_p_5_8:Ut(S,Yo,s)*t%s,b2:u}}function Oh(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function Uh(t,e){const r=La,n=Fe(e*e*e,r),i=Fe(n*n*e,r),s=Rh(t*i).pow_p_5_8;let c=Fe(t*n*s,r);const u=Fe(e*c*c,r),l=c,p=Fe(c*Wo,r),b=u===t,x=u===Fe(-t,r),_=u===Fe(-t*Wo,r);return b&&(c=l),(x||_)&&(c=p),w0(c,r)&&(c=Fe(-c,r)),{isValid:b||x,value:c}}const Fh=Kn(La,void 0,!0),Ph={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Fh,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:Bh,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:vh,randomBytes:Mc,adjustScalarBytes:Oh,uvRatio:Uh},Gr=Sh(Ph);var Zo=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},rt=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Qe,mn,wf,bf;class Ih{constructor(e={}){Qe.set(this,void 0),mn.set(this,void 0),this[wf]=this.entries.bind(this),this[bf]="ExpirableMap";const{source:r=[],expirationTime:n=10*60*1e3}=e,i=Date.now();Zo(this,Qe,new Map([...r].map(([s,c])=>[s,{value:c,timestamp:i}])),"f"),Zo(this,mn,n,"f")}prune(){const e=Date.now();for(const[r,n]of rt(this,Qe,"f").entries())e-n.timestamp>rt(this,mn,"f")&&rt(this,Qe,"f").delete(r);return this}set(e,r){this.prune();const n={value:r,timestamp:Date.now()};return rt(this,Qe,"f").set(e,n),this}get(e){const r=rt(this,Qe,"f").get(e);if(r!==void 0){if(Date.now()-r.timestamp>rt(this,mn,"f")){rt(this,Qe,"f").delete(e);return}return r.value}}clear(){rt(this,Qe,"f").clear()}entries(){const e=rt(this,Qe,"f").entries();return function*(){for(const[n,i]of e)yield[n,i.value]}()}values(){const e=rt(this,Qe,"f").values();return function*(){for(const n of e)yield n.value}()}keys(){return rt(this,Qe,"f").keys()}forEach(e,r){for(const[n,i]of rt(this,Qe,"f").entries())e.call(r,i.value,n,this)}has(e){return rt(this,Qe,"f").has(e)}delete(e){return rt(this,Qe,"f").delete(e)}get size(){return rt(this,Qe,"f").size}}Qe=new WeakMap,mn=new WeakMap,wf=Symbol.iterator,bf=Symbol.toStringTag;const Xo=t=>{if(t<=127)return 1;if(t<=255)return 2;if(t<=65535)return 3;if(t<=16777215)return 4;throw new Error("Length too long (> 4 bytes)")},Jo=(t,e,r)=>{if(r<=127)return t[e]=r,1;if(r<=255)return t[e]=129,t[e+1]=r,2;if(r<=65535)return t[e]=130,t[e+1]=r>>8,t[e+2]=r,3;if(r<=16777215)return t[e]=131,t[e+1]=r>>16,t[e+2]=r>>8,t[e+3]=r,4;throw new Error("Length too long (> 4 bytes)")},Na=(t,e)=>{if(t[e]<128)return 1;if(t[e]===128)throw new Error("Invalid length 0");if(t[e]===129)return 2;if(t[e]===130)return 3;if(t[e]===131)return 4;throw new Error("Length too long (> 4 bytes)")},kh=(t,e)=>{const r=Na(t,e);if(r===1)return t[e];if(r===2)return t[e+1];if(r===3)return(t[e+1]<<8)+t[e+2];if(r===4)return(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];throw new Error("Length too long (> 4 bytes)")};Uint8Array.from([48,12,6,10,43,6,1,4,1,131,184,67,1,1]);const Di=Uint8Array.from([48,5,6,3,43,101,112]);Uint8Array.from([48,16,6,7,42,134,72,206,61,2,1,6,5,43,129,4,0,10]);function mf(t,e){const r=2+Xo(t.byteLength+1),n=e.byteLength+r+t.byteLength;let i=0;const s=new Uint8Array(1+Xo(n)+n);return s[i++]=48,i+=Jo(s,i,n),s.set(e,i),i+=e.byteLength,s[i++]=3,i+=Jo(s,i,t.byteLength+1),s[i++]=0,s.set(new Uint8Array(t),i),s}const _f=(t,e)=>{let r=0;const n=(u,l)=>{if(i[r++]!==u)throw new Error("Expected: "+l)},i=new Uint8Array(t);if(n(48,"sequence"),r+=Na(i,r),!Gn(i.slice(r,r+e.byteLength),e))throw new Error("Not the expected OID.");r+=e.byteLength,n(3,"bit string");const s=kh(i,r)-1;r+=Na(i,r),n(0,"0 padding");const c=i.slice(r);if(s!==c.length)throw new Error(`DER payload mismatch: Expected length ${s} actual length ${c.length}`);return c};var Qo=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Lo=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},xi,Ei;let vf=class _n{constructor(e){if(xi.set(this,void 0),Ei.set(this,void 0),e.byteLength!==_n.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");Qo(this,xi,e,"f"),Qo(this,Ei,_n.derEncode(e),"f")}static from(e){return this.fromDer(e.toDer())}static fromRaw(e){return new _n(e)}static fromDer(e){return new _n(this.derDecode(e))}static derEncode(e){return mf(e,Di).buffer}static derDecode(e){const r=_f(e,Di);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return Lo(this,xi,"f")}get derKey(){return Lo(this,Ei,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}};xi=new WeakMap,Ei=new WeakMap;vf.RAW_KEY_LENGTH=32;class Ch{constructor(){this.observers=[]}subscribe(e){this.observers.push(e)}unsubscribe(e){this.observers=this.observers.filter(r=>r!==e)}notify(e,...r){this.observers.forEach(n=>n(e,...r))}}class Mh extends Ch{constructor(){super()}print(e,...r){this.notify({message:e,level:"info"},...r)}warn(e,...r){this.notify({message:e,level:"warn"},...r)}error(e,r,...n){this.notify({message:e,level:"error",error:r},...n)}}var Ft=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Je=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},It,Ti,Si,Ai,Ni,Bi,Ri,Oi,Vr;const xf=.5,Ef=1.5,Tf=500,Sf=6e4,Af=9e5,Nf=10;class bs{constructor(e=bs.default){It.set(this,void 0),Ti.set(this,void 0),Si.set(this,void 0),Ai.set(this,void 0),Ni.set(this,void 0),Bi.set(this,void 0),Ri.set(this,void 0),Oi.set(this,void 0),Vr.set(this,0);const{initialInterval:r=Tf,randomizationFactor:n=xf,multiplier:i=Ef,maxInterval:s=Sf,maxElapsedTime:c=Af,maxIterations:u=Nf,date:l=Date}=e;Ft(this,It,r,"f"),Ft(this,Ti,n,"f"),Ft(this,Si,i,"f"),Ft(this,Ai,s,"f"),Ft(this,Oi,l,"f"),Ft(this,Ni,l.now(),"f"),Ft(this,Bi,c,"f"),Ft(this,Ri,u,"f")}get ellapsedTimeInMsec(){return Je(this,Oi,"f").now()-Je(this,Ni,"f")}get currentInterval(){return Je(this,It,"f")}get count(){return Je(this,Vr,"f")}get randomValueFromInterval(){const e=Je(this,Ti,"f")*Je(this,It,"f"),r=Je(this,It,"f")-e,n=Je(this,It,"f")+e;return Math.random()*(n-r)+r}incrementCurrentInterval(){var e;return Ft(this,It,Math.min(Je(this,It,"f")*Je(this,Si,"f"),Je(this,Ai,"f")),"f"),Ft(this,Vr,(e=Je(this,Vr,"f"),e++,e),"f"),Je(this,It,"f")}next(){return this.ellapsedTimeInMsec>=Je(this,Bi,"f")||Je(this,Vr,"f")>=Je(this,Ri,"f")?null:(this.incrementCurrentInterval(),this.randomValueFromInterval)}}It=new WeakMap,Ti=new WeakMap,Si=new WeakMap,Ai=new WeakMap,Ni=new WeakMap,Bi=new WeakMap,Ri=new WeakMap,Oi=new WeakMap,Vr=new WeakMap;bs.default={initialInterval:Tf,randomizationFactor:xf,multiplier:Ef,maxInterval:Sf,maxElapsedTime:Af,maxIterations:Nf,date:Date};var Ze=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},re=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Le,xr,Qr,kt,Ht,Zr,vn,qr,Et,Tt,Er,Tr,xn,Hr,jr,Sr,Br,Bf,Ui,Fi,Ar,jt;(function(t){t.Received="received",t.Processing="processing",t.Replied="replied",t.Rejected="rejected",t.Unknown="unknown",t.Done="done"})(jt||(jt={}));const ci=60*1e3,$h="308182301d060d2b0601040182dc7c0503010201060c2b0601040182dc7c05030201036100814c0e6ec71fab583b08bd81373c255c3c371b2e84863c98a4f1e08b74235d14fb5d9c0cd546d9685f913a0c0b2cc5341583bf4b4392e467db96d65b9bb4cb717112f8472e0d5a4d14505ffd7484b01291091c5f87b98883463f98091a0baaae",Gh="aaaaa-aa",Vh="ic0.app",qh=".ic0.app",Hh="icp0.io",jh=".icp0.io",Kh="icp-api.io",zh=".icp-api.io";class Ls extends Pe{constructor(e){super(e),this.message=e}}class ui extends Pe{constructor(e){super(e),this.message=e}}function Wh(){let t;if(typeof window<"u")if(window.fetch)t=window.fetch.bind(window);else throw new Ls("Fetch implementation was not available. You appear to be in a browser context, but window.fetch was not present.");else if(typeof global<"u")if(global.fetch)t=global.fetch.bind(global);else throw new Ls("Fetch implementation was not available. You appear to be in a Node.js context, but global.fetch was not available.");else typeof self<"u"&&self.fetch&&(t=self.fetch.bind(self));if(t)return t;throw new Ls("Fetch implementation was not available. Please provide fetch to the HttpAgent constructor, or ensure it is available in the window or global context.")}function Yh(t){let e;if(t!==void 0)!t.match(/^[a-z]+:/)&&typeof window<"u"?e=new URL(window.location.protocol+"//"+t):e=new URL(t);else{const r=["ic0.app","icp0.io","127.0.0.1","localhost"],n=[".github.dev",".gitpod.io"],i=typeof window<"u"?window.location:void 0,s=i?.hostname;let c;s&&typeof s=="string"&&(n.some(u=>s.endsWith(u))?c=s:c=r.find(u=>s.endsWith(u))),i&&c?e=new URL(`${i.protocol}//${c}${i.port?":"+i.port:""}`):e=new URL("https://icp-api.io")}return e.toString()}class pr{constructor(e={}){var r,n;Le.add(this),xr.set(this,null),Qr.set(this,!1),kt.set(this,void 0),Ht.set(this,void 0),Zr.set(this,void 0),vn.set(this,void 0),qr.set(this,0),Et.set(this,void 0),Tt.set(this,void 0),Er.set(this,void 0),Tr.set(this,void 0),this._isAgent=!0,this.config={},xn.set(this,0),this.log=new Mh,Hr.set(this,[]),jr.set(this,[]),Sr.set(this,new Ih({expirationTime:5*60*1e3})),Br.set(this,!0),Fi.set(this,(c,u)=>{if(re(this,Br,"f")===!1)return c;if(!u)throw new Mt("Invalid signature from replica signed query: no matching node key found.");const{status:l,signatures:p=[],requestId:b}=c,x=new TextEncoder().encode("\vic-response");for(const _ of p){const{timestamp:v,identity:d}=_,A=ye.fromUint8Array(d).toText();let S;if(l==="replied"){const{reply:B}=c;S=Yi({status:l,reply:B,timestamp:BigInt(v),request_id:b})}else if(l==="rejected"){const{reject_code:B,reject_message:j,error_code:V}=c;S=Yi({status:l,reject_code:B,reject_message:j,error_code:V,timestamp:BigInt(v),request_id:b})}else throw new Error(`Unknown status: ${l}`);const P=Nt(x,new Uint8Array(S)),I=u?.nodeKeys.get(A);if(!I)throw new Mt("Invalid signature from replica signed query: no matching node key found.");const R=vf.fromDer(I).rawKey;if(Gr.verify(_.signature,new Uint8Array(P),new Uint8Array(R)))return c;throw new Mt(`Invalid signature from replica ${A} signed query.`)}return c}),this.config=e,Ze(this,Ht,e.fetch||Wh()||fetch.bind(global),"f"),Ze(this,Zr,e.fetchOptions,"f"),Ze(this,vn,e.callOptions,"f"),Ze(this,Qr,(r=e.shouldFetchRootKey)!==null&&r!==void 0?r:!1,"f"),e.rootKey?this.rootKey=e.rootKey:re(this,Qr,"f")?this.rootKey=null:this.rootKey=Qt($h);const i=Yh(e.host);this.host=new URL(i),e.verifyQuerySignatures!==void 0&&Ze(this,Br,e.verifyQuerySignatures,"f"),Ze(this,Tt,(n=e.retryTimes)!==null&&n!==void 0?n:3,"f");const s=()=>new bs({maxIterations:re(this,Tt,"f")});if(Ze(this,Er,e.backoffStrategy||s,"f"),this.host.hostname.endsWith(qh)?this.host.hostname=Vh:this.host.hostname.endsWith(jh)?this.host.hostname=Hh:this.host.hostname.endsWith(zh)&&(this.host.hostname=Kh),e.credentials){const{name:c,password:u}=e.credentials;Ze(this,Et,`${c}${u?":"+u:""}`,"f")}if(Ze(this,kt,Promise.resolve(e.identity||new Zi),"f"),e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes>5)throw new Pe(`The maximum ingress expiry time is 5 minutes. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);if(e.ingressExpiryInMinutes&&e.ingressExpiryInMinutes<=0)throw new Pe(`Ingress expiry time must be greater than 0. Provided ingress expiry time is ${e.ingressExpiryInMinutes} minutes.`);Ze(this,Tr,e.ingressExpiryInMinutes||5,"f"),this.addTransform("update",Bo(va)),e.useQueryNonces&&this.addTransform("query",Bo(va)),e.logToConsole&&this.log.subscribe(c=>{c.level==="error"?console.error(c.message):c.level==="warn"?console.warn(c.message):console.log(c.message)})}get waterMark(){return re(this,xn,"f")}static createSync(e={}){return new this(Object.assign({},e))}static async create(e={shouldFetchRootKey:!1}){const r=pr.createSync(e),n=[r.syncTime()];return r.host.toString()!=="https://icp-api.io"&&e.shouldFetchRootKey&&n.push(r.fetchRootKey()),await Promise.all(n),r}static async from(e){var r;try{return"config"in e?await pr.create(e.config):await pr.create({fetch:e._fetch,fetchOptions:e._fetchOptions,callOptions:e._callOptions,host:e._host.toString(),identity:(r=e._identity)!==null&&r!==void 0?r:void 0})}catch{throw new Pe("Failed to create agent from provided agent")}}isLocal(){const e=this.host.hostname;return e==="127.0.0.1"||e.endsWith("127.0.0.1")}addTransform(e,r,n=r.priority||0){if(e==="update"){const i=re(this,jr,"f").findIndex(s=>(s.priority||0)<n);re(this,jr,"f").splice(i>=0?i:re(this,jr,"f").length,0,Object.assign(r,{priority:n}))}else if(e==="query"){const i=re(this,Hr,"f").findIndex(s=>(s.priority||0)<n);re(this,Hr,"f").splice(i>=0?i:re(this,Hr,"f").length,0,Object.assign(r,{priority:n}))}}async getPrincipal(){if(!re(this,kt,"f"))throw new ui("This identity has expired due this application's security policy. Please refresh your authentication.");return(await re(this,kt,"f")).getPrincipal()}async call(e,r,n){var i,s;await re(this,Le,"m",Ar).call(this);const c=(i=r.callSync)!==null&&i!==void 0?i:!0,u=await(n!==void 0?await n:await re(this,kt,"f"));if(!u)throw new ui("This identity has expired due this application's security policy. Please refresh your authentication.");const l=ye.from(e),p=r.effectiveCanisterId?ye.from(r.effectiveCanisterId):l,b=u.getPrincipal()||ye.anonymous();let x=new ti(re(this,Tr,"f")*ci);Math.abs(re(this,qr,"f"))>1e3*30&&(x=new ti(re(this,Tr,"f")*ci+re(this,qr,"f")));const _={request_type:_a.Call,canister_id:l,method_name:r.methodName,arg:r.arg,sender:b,ingress_expiry:x};let v=await this._transform({request:{body:null,method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},re(this,Et,"f")?{Authorization:"Basic "+btoa(re(this,Et,"f"))}:{})},endpoint:"call",body:_});const d=v.body.nonce?A(v.body.nonce):void 0;_.nonce=d;function A(R){return new Uint8Array(R)}v=await u.transformRequest(v);const S=Hs(v.body),P=re(this,Er,"f").call(this),I=Pn(_);try{const R=()=>(this.log.print(`fetching "/api/v3/canister/${p.toText()}/call" with request:`,v),re(this,Ht,"f").call(this,""+new URL(`/api/v3/canister/${p.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},re(this,vn,"f")),v.request),{body:S}))),H=()=>(this.log.print(`fetching "/api/v2/canister/${p.toText()}/call" with request:`,v),re(this,Ht,"f").call(this,""+new URL(`/api/v2/canister/${p.toText()}/call`,this.host),Object.assign(Object.assign(Object.assign({},re(this,vn,"f")),v.request),{body:S}))),j=await re(this,Le,"m",Ui).call(this,{request:c?R:H,backoff:P,tries:0}),V=await j.arrayBuffer(),K=j.status===200&&V.byteLength>0?Zt(V):null;if(K&&"certificate"in K){const Y=await this.parseTimeFromResponse({certificate:K.certificate});Ze(this,xn,Y,"f")}return{requestId:I,response:{ok:j.ok,status:j.status,statusText:j.statusText,body:K,headers:wn(j.headers)},requestDetails:_}}catch(R){if(R.message.includes("v3 api not supported."))return this.log.warn("v3 api not supported. Fall back to v2"),this.call(e,Object.assign(Object.assign({},r),{callSync:!1}),n);const H=`Error while making call: ${(s=R.message)!==null&&s!==void 0?s:String(R)}`,B=new a0(H,R,Re(I),Re(v.body.sender_pubkey),Re(v.body.sender_sig),String(v.body.content.ingress_expiry._value));throw this.log.error(H,B),B}}async query(e,r,n){var i,s,c,u;await re(this,Le,"m",Ar).call(this);const l=re(this,Er,"f").call(this),p=r.effectiveCanisterId?ye.from(r.effectiveCanisterId):ye.from(e);this.log.print(`ecid ${p.toString()}`),this.log.print(`canisterId ${e.toString()}`);let b,x;const _=await(n!==void 0?n:re(this,kt,"f"));if(!_)throw new ui("This identity has expired due this application's security policy. Please refresh your authentication.");const v=ye.from(e),d=_?.getPrincipal()||ye.anonymous(),A={request_type:"query",canister_id:v,method_name:r.methodName,arg:r.arg,sender:d,ingress_expiry:new ti(re(this,Tr,"f")*ci)},S=Pn(A);b=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},re(this,Et,"f")?{Authorization:"Basic "+btoa(re(this,Et,"f"))}:{})},endpoint:"read",body:A}),b=await _?.transformRequest(b);const P=Hs(b.body),I={canister:v.toText(),ecid:p,transformedRequest:b,body:P,requestId:S,backoff:l,tries:0},R=async()=>({requestDetails:A,query:await re(this,Le,"m",Bf).call(this,I)}),H=async()=>{if(!re(this,Br,"f"))return;const B=re(this,Sr,"f").get(p.toString());return B||(await this.fetchSubnetKeys(p.toString()),re(this,Sr,"f").get(p.toString()))};try{const[B,j]=await Promise.all([R(),H()]);x=B;const{requestDetails:V,query:K}=x,Y=Object.assign(Object.assign({},K),{requestDetails:V});if(this.log.print("Query response:",Y),!re(this,Br,"f"))return Y;try{return re(this,Fi,"f").call(this,Y,j)}catch{this.log.warn("Query response verification failed. Retrying with fresh subnet keys."),re(this,Sr,"f").delete(e.toString()),await this.fetchSubnetKeys(p.toString());const ne=re(this,Sr,"f").get(e.toString());if(!ne)throw new Mt("Invalid signature from replica signed query: no matching node key found.");return re(this,Fi,"f").call(this,Y,ne)}}catch(B){const j=`Error while making call: ${(i=B.message)!==null&&i!==void 0?i:String(B)}`,V=new o0(j,B,String(S),Re((s=b?.body)===null||s===void 0?void 0:s.sender_pubkey),Re((c=b?.body)===null||c===void 0?void 0:c.sender_sig),String((u=b?.body)===null||u===void 0?void 0:u.content.ingress_expiry._value));throw this.log.error(j,V),V}}async createReadStateRequest(e,r){await re(this,Le,"m",Ar).call(this);const n=await(r!==void 0?await r:await re(this,kt,"f"));if(!n)throw new ui("This identity has expired due this application's security policy. Please refresh your authentication.");const i=n?.getPrincipal()||ye.anonymous(),s=await this._transform({request:{method:"POST",headers:Object.assign({"Content-Type":"application/cbor"},re(this,Et,"f")?{Authorization:"Basic "+btoa(re(this,Et,"f"))}:{})},endpoint:"read_state",body:{request_type:"read_state",paths:e.paths,sender:i,ingress_expiry:new ti(re(this,Tr,"f")*ci)}});return n?.transformRequest(s)}async readState(e,r,n,i){var s,c,u,l;function p(A){for(const S of A.paths){const[P,I]=S,R=new TextEncoder().encode("request_status");if(Gn(P,R))return I}}const b=p(r);await re(this,Le,"m",Ar).call(this);const x=typeof e=="string"?ye.fromText(e):e,_=i??await this.createReadStateRequest(r,n),v=Hs(_.body);this.log.print(`fetching "/api/v2/canister/${x}/read_state" with request:`,_);const d=re(this,Er,"f").call(this);try{const A=await re(this,Le,"m",Ui).call(this,{request:()=>re(this,Ht,"f").call(this,""+new URL(`/api/v2/canister/${x.toString()}/read_state`,this.host),Object.assign(Object.assign(Object.assign({},re(this,Zr,"f")),_.request),{body:v})),backoff:d,tries:0});if(!A.ok)throw new Error(`Server returned an error:
  Code: ${A.status} (${A.statusText})
  Body: ${await A.text()}
`);const S=Zt(await A.arrayBuffer());this.log.print("Read state response:",S);const P=await this.parseTimeFromResponse(S);return P>0&&(this.log.print("Read state response time:",P),Ze(this,xn,P,"f")),S}catch(A){const S=`Caught exception while attempting to read state: ${(s=A.message)!==null&&s!==void 0?s:String(A)}`,P=new c0(S,A,String(b),Re((c=_?.body)===null||c===void 0?void 0:c.sender_pubkey),Re((u=_?.body)===null||u===void 0?void 0:u.sender_sig),String((l=_?.body)===null||l===void 0?void 0:l.content.ingress_expiry._value));throw this.log.error(S,P),P}}async parseTimeFromResponse(e){let r;if(e.certificate){const n=Zt(e.certificate);if(n&&"tree"in n)r=n.tree;else throw new Error("Could not decode time from response");const i=rn(["time"],r);if(i.status!==Ve.Found)throw new Error("Time was not found in the response or was not in its expected format.");if(!(i.value instanceof ArrayBuffer)&&!ArrayBuffer.isView(i))throw new Error("Time was not found in the response or was not in its expected format.");const s=Qa($a(i.value));return this.log.print("Time from response:",s),this.log.print("Time from response in milliseconds:",Number(s)),Number(s)}else this.log.warn("No certificate found in response");return 0}async syncTime(e){await re(this,Le,"m",Ar).call(this);const r=await Ac(()=>Promise.resolve().then(()=>J0),void 0,import.meta.url),n=Date.now();try{e||this.log.print("Syncing time with the IC. No canisterId provided, so falling back to ryjl3-tyaaa-aaaaa-aaaba-cai");const i=pr.createSync({identity:new Zi,host:this.host.toString(),fetch:re(this,Ht,"f"),retryTimes:0}),c=(await r.request({canisterId:e??ye.from("ryjl3-tyaaa-aaaaa-aaaba-cai"),agent:i,paths:["time"]})).get("time");c&&(Ze(this,qr,Number(c)-Number(n),"f"),this.log.notify({message:`Syncing time: offset of ${re(this,qr,"f")}`,level:"info"}))}catch(i){this.log.error("Caught exception while attempting to sync time",i)}}async status(){const e=re(this,Et,"f")?{Authorization:"Basic "+btoa(re(this,Et,"f"))}:{};this.log.print('fetching "/api/v2/status"');const r=re(this,Er,"f").call(this),n=await re(this,Le,"m",Ui).call(this,{backoff:r,request:()=>re(this,Ht,"f").call(this,""+new URL("/api/v2/status",this.host),Object.assign({headers:e},re(this,Zr,"f"))),tries:0});return Zt(await n.arrayBuffer())}async fetchRootKey(){let e;return re(this,xr,"f")?e=await re(this,xr,"f"):(Ze(this,xr,new Promise((r,n)=>{this.status().then(i=>{const s=i.root_key;this.rootKey=s,r(s)}).catch(n)}),"f"),e=await re(this,xr,"f")),Ze(this,xr,null,"f"),e}invalidateIdentity(){Ze(this,kt,null,"f")}replaceIdentity(e){Ze(this,kt,Promise.resolve(e),"f")}async fetchSubnetKeys(e){await re(this,Le,"m",Ar).call(this);const r=ye.from(e),i=(await hf({canisterId:r,paths:["subnet"],agent:this})).get("subnet");if(i&&typeof i=="object"&&"nodeKeys"in i)return re(this,Sr,"f").set(r.toText(),i),i}_transform(e){let r=Promise.resolve(e);if(e.endpoint==="call")for(const n of re(this,jr,"f"))r=r.then(i=>n(i).then(s=>s||i));else for(const n of re(this,Hr,"f"))r=r.then(i=>n(i).then(s=>s||i));return r}}xr=new WeakMap,Qr=new WeakMap,kt=new WeakMap,Ht=new WeakMap,Zr=new WeakMap,vn=new WeakMap,qr=new WeakMap,Et=new WeakMap,Tt=new WeakMap,Er=new WeakMap,Tr=new WeakMap,xn=new WeakMap,Hr=new WeakMap,jr=new WeakMap,Sr=new WeakMap,Br=new WeakMap,Fi=new WeakMap,Le=new WeakSet,Bf=async function t(e){var r,n;const{ecid:i,transformedRequest:s,body:c,requestId:u,backoff:l,tries:p}=e,b=p===0?0:l.next();if(this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with tries:`,{tries:p,backoff:l,delay:b}),b===null)throw new Pe(`Timestamp failed to pass the watermark after retrying the configured ${re(this,Tt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);b>0&&await new Promise(d=>setTimeout(d,b));let x;try{this.log.print(`fetching "/api/v2/canister/${i.toString()}/query" with request:`,s);const d=await re(this,Ht,"f").call(this,""+new URL(`/api/v2/canister/${i.toString()}/query`,this.host),Object.assign(Object.assign(Object.assign({},re(this,Zr,"f")),s.request),{body:c}));if(d.status===200){const A=Zt(await d.arrayBuffer());x=Object.assign(Object.assign({},A),{httpDetails:{ok:d.ok,status:d.status,statusText:d.statusText,headers:wn(d.headers)},requestId:u})}else throw new js(`Gateway returned an error:
  Code: ${d.status} (${d.statusText})
  Body: ${await d.text()}
`,{ok:d.ok,status:d.status,statusText:d.statusText,headers:wn(d.headers)})}catch(d){if(p<re(this,Tt,"f"))return this.log.warn(`Caught exception while attempting to make query:
  ${d}
  Retrying query.`),await re(this,Le,"m",t).call(this,Object.assign(Object.assign({},e),{tries:p+1}));throw d}const _=(n=(r=x.signatures)===null||r===void 0?void 0:r[0])===null||n===void 0?void 0:n.timestamp;if(!re(this,Br,"f"))return x;if(!_)throw new Error("Timestamp not found in query response. This suggests a malformed or malicious response.");const v=Number(BigInt(_)/BigInt(1e6));if(this.log.print("watermark and timestamp",{waterMark:this.waterMark,timestamp:v}),Number(this.waterMark)>v){const d=new Pe("Timestamp is below the watermark. Retrying query.");if(this.log.error("Timestamp is below",d,{timestamp:_,waterMark:this.waterMark}),p<re(this,Tt,"f"))return await re(this,Le,"m",t).call(this,Object.assign(Object.assign({},e),{tries:p+1}));throw new Pe(`Timestamp failed to pass the watermark after retrying the configured ${re(this,Tt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`)}return x},Ui=async function t(e){const{request:r,backoff:n,tries:i}=e,s=i===0?0:n.next();if(s===null)throw new Pe(`Timestamp failed to pass the watermark after retrying the configured ${re(this,Tt,"f")} times. We cannot guarantee the integrity of the response since it could be a replay attack.`);s>0&&await new Promise(p=>setTimeout(p,s));let c;try{c=await r()}catch(p){if(re(this,Tt,"f")>i)return this.log.warn(`Caught exception while attempting to make request:
  ${p}
  Retrying request.`),await re(this,Le,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw p}if(c.ok)return c;const u=await c.clone().text(),l=`Server returned an error:
  Code: ${c.status} (${c.statusText})
  Body: ${u}
`;if(c.status===404&&c.url.includes("api/v3"))throw new js("v3 api not supported. Fall back to v2",{ok:c.ok,status:c.status,statusText:c.statusText,headers:wn(c.headers)});if(i<re(this,Tt,"f"))return await re(this,Le,"m",t).call(this,{request:r,backoff:n,tries:i+1});throw new js(l,{ok:c.ok,status:c.status,statusText:c.statusText,headers:wn(c.headers)})},Ar=async function(){if(!this.rootKey)if(this.rootKey===null&&re(this,Qr,"f"))await this.fetchRootKey();else throw new Pe(`Invalid root key detected. The root key for this agent is ${this.rootKey} and the shouldFetchRootKey value is set to ${re(this,Qr,"f")}. The root key should only be unknown if you are in local development. Otherwise you should avoid fetching and use the default IC Root Key or the known root key of your environment.`)};var Do;(function(t){t.Error="err",t.GetPrincipal="gp",t.GetPrincipalResponse="gpr",t.Query="q",t.QueryResponse="qr",t.Call="c",t.CallResponse="cr",t.ReadState="rs",t.ReadStateResponse="rsr",t.Status="s",t.StatusResponse="sr"})(Do||(Do={}));function ec(){const t=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.ic.agent:global.ic.agent:window.ic.agent;if(!t)throw new Error("No Agent could be found.");return t}const Zh=5*60*1e3;function Rf(){return Dh(Jh(Xh(),1e3),Lh(1e3,1.2),Qh(Zh))}function Xh(){let t=!0;return async()=>t?(t=!1,!0):!1}function Jh(t,e){return async(r,n,i)=>{if(await t(r,n,i))return new Promise(s=>setTimeout(s,e))}}function Qh(t){const e=Date.now()+t;return async(r,n,i)=>{if(Date.now()>e)throw new Error(`Request timed out after ${t} msec:
  Request ID: ${Re(n)}
  Request status: ${i}
`)}}function Lh(t,e){let r=t;return()=>new Promise(n=>setTimeout(()=>{r*=e,n()},r))}function Dh(...t){return async(e,r,n)=>{for(const i of t)await i(e,r,n)}}async function Of(t,e,r,n=Rf(),i,s){var c;const u=[new TextEncoder().encode("request_status"),r],l=i??await((c=t.createReadStateRequest)===null||c===void 0?void 0:c.call(t,{paths:[u]})),p=await t.readState(e,{paths:[u]},void 0,l);if(t.rootKey==null)throw new Error("Agent root key not initialized before polling");const b=await Rr.create({certificate:p.certificate,rootKey:t.rootKey,canisterId:e,blsVerify:s}),x=yt(b.lookup([...u,new TextEncoder().encode("status")]));let _;switch(typeof x>"u"?_=jt.Unknown:_=new TextDecoder().decode(x),_){case jt.Replied:return{reply:yt(b.lookup([...u,"reply"])),certificate:b};case jt.Received:case jt.Unknown:case jt.Processing:return await n(e,r,_),Of(t,e,r,n,l,s);case jt.Rejected:{const v=new Uint8Array(yt(b.lookup([...u,"reject_code"])))[0],d=new TextDecoder().decode(yt(b.lookup([...u,"reject_message"])));throw new Error(`Call was rejected:
  Request ID: ${Re(r)}
  Reject code: ${v}
  Reject text: ${d}
`)}case jt.Done:throw new Error(`Call was marked as done but we never saw the reply:
  Request ID: ${Re(r)}
`)}throw new Error("unreachable")}const ep=({IDL:t})=>{const e=t.Variant({mainnet:t.Null,testnet:t.Null}),r=t.Text,n=t.Record({network:e,address:r,min_confirmations:t.Opt(t.Nat32)}),i=t.Nat64,s=i,c=t.Nat32,u=t.Record({start_height:c,end_height:t.Opt(c),network:e}),l=t.Vec(t.Nat8),p=t.Record({tip_height:c,block_headers:t.Vec(l)}),b=t.Record({network:e}),x=t.Nat64,_=t.Vec(x),v=t.Record({network:e,filter:t.Opt(t.Variant({page:t.Vec(t.Nat8),min_confirmations:t.Nat32})),address:r}),d=t.Vec(t.Nat8),A=t.Record({txid:t.Vec(t.Nat8),vout:t.Nat32}),S=t.Record({height:t.Nat32,value:i,outpoint:A}),P=t.Record({next_page:t.Opt(t.Vec(t.Nat8)),tip_height:c,tip_block_hash:d,utxos:t.Vec(S)}),I=t.Record({transaction:t.Vec(t.Nat8),network:e}),R=t.Principal,H=t.Record({canister_id:R,num_requested_changes:t.Opt(t.Nat64)}),B=t.Variant({from_user:t.Record({user_id:t.Principal}),from_canister:t.Record({canister_version:t.Opt(t.Nat64),canister_id:t.Principal})}),j=t.Vec(t.Nat8),V=t.Variant({creation:t.Record({controllers:t.Vec(t.Principal)}),code_deployment:t.Record({mode:t.Variant({reinstall:t.Null,upgrade:t.Null,install:t.Null}),module_hash:t.Vec(t.Nat8)}),load_snapshot:t.Record({canister_version:t.Nat64,taken_at_timestamp:t.Nat64,snapshot_id:j}),controllers_change:t.Record({controllers:t.Vec(t.Principal)}),code_uninstall:t.Null}),K=t.Record({timestamp_nanos:t.Nat64,canister_version:t.Nat64,origin:B,details:V}),Y=t.Record({controllers:t.Vec(t.Principal),module_hash:t.Opt(t.Vec(t.Nat8)),recent_changes:t.Vec(K),total_num_changes:t.Nat64}),z=t.Record({canister_id:R}),ne=t.Variant({controllers:t.Null,public:t.Null,allowed_viewers:t.Vec(t.Principal)}),D=t.Record({freezing_threshold:t.Nat,controllers:t.Vec(t.Principal),reserved_cycles_limit:t.Nat,log_visibility:ne,wasm_memory_limit:t.Nat,memory_allocation:t.Nat,compute_allocation:t.Nat}),T=t.Record({status:t.Variant({stopped:t.Null,stopping:t.Null,running:t.Null}),memory_size:t.Nat,cycles:t.Nat,settings:D,query_stats:t.Record({response_payload_bytes_total:t.Nat,num_instructions_total:t.Nat,num_calls_total:t.Nat,request_payload_bytes_total:t.Nat}),idle_cycles_burned_per_day:t.Nat,module_hash:t.Opt(t.Vec(t.Nat8)),reserved_cycles:t.Nat}),U=t.Record({canister_id:R}),G=t.Record({freezing_threshold:t.Opt(t.Nat),controllers:t.Opt(t.Vec(t.Principal)),reserved_cycles_limit:t.Opt(t.Nat),log_visibility:t.Opt(ne),wasm_memory_limit:t.Opt(t.Nat),memory_allocation:t.Opt(t.Nat),compute_allocation:t.Opt(t.Nat)}),$=t.Record({settings:t.Opt(G),sender_canister_version:t.Opt(t.Nat64)}),M=t.Record({canister_id:R}),W=t.Record({canister_id:R}),J=t.Record({canister_id:R,snapshot_id:j}),oe=t.Record({canister_id:R}),se=t.Variant({secp256k1:t.Null}),ue=t.Record({key_id:t.Record({name:t.Text,curve:se}),canister_id:t.Opt(R),derivation_path:t.Vec(t.Vec(t.Nat8))}),Z=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),g=t.Record({canister_id:R}),L=t.Record({idx:t.Nat64,timestamp_nanos:t.Nat64,content:t.Vec(t.Nat8)}),ie=t.Record({canister_log_records:t.Vec(L)}),ae=t.Record({value:t.Text,name:t.Text}),X=t.Record({status:t.Nat,body:t.Vec(t.Nat8),headers:t.Vec(ae)}),te=t.Record({url:t.Text,method:t.Variant({get:t.Null,head:t.Null,post:t.Null}),max_response_bytes:t.Opt(t.Nat64),body:t.Opt(t.Vec(t.Nat8)),transform:t.Opt(t.Record({function:t.Func([t.Record({context:t.Vec(t.Nat8),response:X})],[X],["query"]),context:t.Vec(t.Nat8)})),headers:t.Vec(ae)}),y=t.Variant({reinstall:t.Null,upgrade:t.Opt(t.Record({wasm_memory_persistence:t.Opt(t.Variant({keep:t.Null,replace:t.Null})),skip_pre_upgrade:t.Opt(t.Bool)})),install:t.Null}),m=t.Record({hash:t.Vec(t.Nat8)}),E=t.Record({arg:t.Vec(t.Nat8),wasm_module_hash:t.Vec(t.Nat8),mode:y,chunk_hashes_list:t.Vec(m),target_canister:R,store_canister:t.Opt(R),sender_canister_version:t.Opt(t.Nat64)}),k=t.Vec(t.Nat8),F=t.Record({arg:t.Vec(t.Nat8),wasm_module:k,mode:y,canister_id:R,sender_canister_version:t.Opt(t.Nat64)}),C=t.Record({canister_id:R}),f=t.Record({id:j,total_size:t.Nat64,taken_at_timestamp:t.Nat64}),a=t.Vec(f),o=t.Record({canister_id:R,sender_canister_version:t.Opt(t.Nat64),snapshot_id:j}),h=t.Record({start_at_timestamp_nanos:t.Nat64,subnet_id:t.Principal}),w=t.Record({num_block_failures_total:t.Nat64,node_id:t.Principal,num_blocks_proposed_total:t.Nat64}),N=t.Vec(t.Record({timestamp_nanos:t.Nat64,node_metrics:t.Vec(w)})),q=t.Record({settings:t.Opt(G),specified_id:t.Opt(R),amount:t.Opt(t.Nat),sender_canister_version:t.Opt(t.Nat64)}),Q=t.Record({canister_id:R}),ce=t.Record({canister_id:R,amount:t.Nat}),de=t.Vec(t.Nat8),he=t.Variant({ed25519:t.Null,bip340secp256k1:t.Null}),ee=t.Record({key_id:t.Record({algorithm:he,name:t.Text}),canister_id:t.Opt(R),derivation_path:t.Vec(t.Vec(t.Nat8))}),pe=t.Record({public_key:t.Vec(t.Nat8),chain_code:t.Vec(t.Nat8)}),Ne=t.Record({key_id:t.Record({name:t.Text,curve:se}),derivation_path:t.Vec(t.Vec(t.Nat8)),message_hash:t.Vec(t.Nat8)}),et=t.Record({signature:t.Vec(t.Nat8)}),bt=t.Variant({bip341:t.Record({merkle_root_hash:t.Vec(t.Nat8)})}),Vt=t.Record({aux:t.Opt(bt),key_id:t.Record({algorithm:he,name:t.Text}),derivation_path:t.Vec(t.Vec(t.Nat8)),message:t.Vec(t.Nat8)}),we=t.Record({signature:t.Vec(t.Nat8)}),mt=t.Record({canister_id:R}),je=t.Record({canister_id:R}),ke=t.Record({canister_id:R}),Te=t.Vec(m),an=t.Record({subnet_id:t.Principal}),Se=t.Record({replica_version:t.Text}),on=t.Record({replace_snapshot:t.Opt(j),canister_id:R}),cn=f,un=t.Record({canister_id:R,sender_canister_version:t.Opt(t.Nat64)}),fn=t.Record({canister_id:t.Principal,settings:G,sender_canister_version:t.Opt(t.Nat64)}),ln=t.Record({chunk:t.Vec(t.Nat8),canister_id:t.Principal}),Rt=m;return t.Service({bitcoin_get_balance:t.Func([n],[s],[]),bitcoin_get_block_headers:t.Func([u],[p],[]),bitcoin_get_current_fee_percentiles:t.Func([b],[_],[]),bitcoin_get_utxos:t.Func([v],[P],[]),bitcoin_send_transaction:t.Func([I],[],[]),canister_info:t.Func([H],[Y],[]),canister_status:t.Func([z],[T],[]),clear_chunk_store:t.Func([U],[],[]),create_canister:t.Func([$],[M],[]),delete_canister:t.Func([W],[],[]),delete_canister_snapshot:t.Func([J],[],[]),deposit_cycles:t.Func([oe],[],[]),ecdsa_public_key:t.Func([ue],[Z],[]),fetch_canister_logs:t.Func([g],[ie],["query"]),http_request:t.Func([te],[X],[]),install_chunked_code:t.Func([E],[],[]),install_code:t.Func([F],[],[]),list_canister_snapshots:t.Func([C],[a],[]),load_canister_snapshot:t.Func([o],[],[]),node_metrics_history:t.Func([h],[N],[]),provisional_create_canister_with_cycles:t.Func([q],[Q],[]),provisional_top_up_canister:t.Func([ce],[],[]),raw_rand:t.Func([],[de],[]),schnorr_public_key:t.Func([ee],[pe],[]),sign_with_ecdsa:t.Func([Ne],[et],[]),sign_with_schnorr:t.Func([Vt],[we],[]),start_canister:t.Func([mt],[],[]),stop_canister:t.Func([je],[],[]),stored_chunks:t.Func([ke],[Te],[]),subnet_info:t.Func([an],[Se],[]),take_canister_snapshot:t.Func([on],[cn],[]),uninstall_code:t.Func([un],[],[]),update_settings:t.Func([fn],[],[]),upload_chunk:t.Func([ln],[Rt],[])})};class Uf extends Pe{constructor(e,r,n,i){super(["Call failed:",`  Canister: ${e.toText()}`,`  Method: ${r} (${n})`,...Object.getOwnPropertyNames(i).map(s=>`  "${s}": ${JSON.stringify(i[s])}`)].join(`
`)),this.canisterId=e,this.methodName=r,this.type=n,this.props=i}}class tp extends Uf{constructor(e,r,n){var i;super(e,r,"query",{Status:n.status,Code:(i=fa[n.reject_code])!==null&&i!==void 0?i:`Unknown Code "${n.reject_code}"`,Message:n.reject_message}),this.result=n}}class tc extends Uf{constructor(e,r,n,i,s,c,u){super(e,r,"update",Object.assign({"Request ID":Re(n)},i.body?Object.assign(Object.assign({},u?{"Error code":u}:{}),{"Reject code":String(s),"Reject message":c}):{"HTTP status code":i.status.toString(),"HTTP status text":i.statusText})),this.requestId=n,this.response=i,this.reject_code=s,this.reject_message=c,this.error_code=u}}const pt=Symbol.for("ic-agent-metadata");class zn{constructor(e){this[pt]=Object.freeze(e)}static agentOf(e){return e[pt].config.agent}static interfaceOf(e){return e[pt].service}static canisterIdOf(e){return ye.from(e[pt].config.canisterId)}static async install(e,r){const n=e.mode===void 0?{install:null}:e.mode,i=e.arg?[...new Uint8Array(e.arg)]:[],s=[...new Uint8Array(e.module)],c=typeof r.canisterId=="string"?ye.fromText(r.canisterId):r.canisterId;await rc(r).install_code({mode:n,arg:i,wasm_module:s,canister_id:c,sender_canister_version:[]})}static async createCanister(e,r){function n(s){return[{controllers:s.controllers?[s.controllers]:[],compute_allocation:s.compute_allocation?[s.compute_allocation]:[],freezing_threshold:s.freezing_threshold?[s.freezing_threshold]:[],memory_allocation:s.memory_allocation?[s.memory_allocation]:[],reserved_cycles_limit:[],log_visibility:[],wasm_memory_limit:[]}]}const{canister_id:i}=await rc(e||{}).provisional_create_canister_with_cycles({amount:[],settings:n(r||{}),specified_id:[],sender_canister_version:[]});return i}static async createAndInstallCanister(e,r,n){const i=await this.createCanister(n);return await this.install(Object.assign({},r),Object.assign(Object.assign({},n),{canisterId:i})),this.createActor(e,Object.assign(Object.assign({},n),{canisterId:i}))}static createActorClass(e,r){const n=e({IDL:ud});class i extends zn{constructor(c){if(!c.canisterId)throw new Pe(`Canister ID is required, but received ${typeof c.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);const u=typeof c.canisterId=="string"?ye.fromText(c.canisterId):c.canisterId;super({config:Object.assign(Object.assign(Object.assign({},Ff),c),{canisterId:u}),service:n});for(const[l,p]of n._fields)r?.httpDetails&&p.annotations.push(Ba),r?.certificate&&p.annotations.push(Pf),this[l]=rp(this,l,p,c.blsVerify)}}return i}static createActor(e,r){if(!r.canisterId)throw new Pe(`Canister ID is required, but received ${typeof r.canisterId} instead. If you are using automatically generated declarations, this may be because your application is not setting the canister ID in process.env correctly.`);return new(this.createActorClass(e))(r)}static createActorWithHttpDetails(e,r){return new(this.createActorClass(e,{httpDetails:!0}))(r)}static createActorWithExtendedDetails(e,r,n={httpDetails:!0,certificate:!0}){return new(this.createActorClass(e,n))(r)}}function Mr(t,e){const r=Dc(t,_l.Buffer.from(e));switch(r.length){case 0:return;case 1:return r[0];default:return r}}const Ff={pollingStrategyFactory:Rf},Ba="http-details",Pf="certificate";function rp(t,e,r,n){let i;r.annotations.includes("query")||r.annotations.includes("composite_query")?i=async(c,...u)=>{var l,p;c=Object.assign(Object.assign({},c),(p=(l=t[pt].config).queryTransform)===null||p===void 0?void 0:p.call(l,e,u,Object.assign(Object.assign({},t[pt].config),c)));const b=c.agent||t[pt].config.agent||ec(),x=ye.from(c.canisterId||t[pt].config.canisterId),_=da(r.argTypes,u),v=await b.query(x,{methodName:e,arg:_,effectiveCanisterId:c.effectiveCanisterId}),d=Object.assign(Object.assign({},v.httpDetails),{requestDetails:v.requestDetails});switch(v.status){case"rejected":throw new tp(x,e,v);case"replied":return r.annotations.includes(Ba)?{httpDetails:d,result:Mr(r.retTypes,v.reply.arg)}:Mr(r.retTypes,v.reply.arg)}}:i=async(c,...u)=>{var l,p;c=Object.assign(Object.assign({},c),(p=(l=t[pt].config).callTransform)===null||p===void 0?void 0:p.call(l,e,u,Object.assign(Object.assign({},t[pt].config),c)));const b=c.agent||t[pt].config.agent||ec(),{canisterId:x,effectiveCanisterId:_,pollingStrategyFactory:v}=Object.assign(Object.assign(Object.assign({},Ff),t[pt].config),c),d=ye.from(x),A=_!==void 0?ye.from(_):d,S=da(r.argTypes,u),{requestId:P,response:I,requestDetails:R}=await b.call(d,{methodName:e,arg:S,effectiveCanisterId:A});let H,B;if(I.body&&I.body.certificate){if(b.rootKey==null)throw new Error("Agent is missing root key");const Y=I.body.certificate;B=await Rr.create({certificate:Ki(Y),rootKey:b.rootKey,canisterId:ye.from(x),blsVerify:n});const z=[new TextEncoder().encode("request_status"),P];switch(new TextDecoder().decode(yt(B.lookup([...z,"status"])))){case"replied":H=yt(B.lookup([...z,"reply"]));break;case"rejected":{const D=new Uint8Array(yt(B.lookup([...z,"reject_code"])))[0],T=new TextDecoder().decode(yt(B.lookup([...z,"reject_message"]))),U=yt(B.lookup([...z,"error_code"])),G=U?new TextDecoder().decode(U):void 0;throw new tc(d,e,P,I,D,T,G)}}}else if(I.body&&"reject_message"in I.body){const{reject_code:Y,reject_message:z,error_code:ne}=I.body;throw new tc(d,e,P,I,Y,z,ne)}if(I.status===202){const Y=v(),z=await Of(b,A,P,Y,n);B=z.certificate,H=z.reply}const j=r.annotations.includes(Ba),V=r.annotations.includes(Pf),K=Object.assign(Object.assign({},I),{requestDetails:R});if(H!==void 0)return j&&V?{httpDetails:K,certificate:B,result:Mr(r.retTypes,H)}:V?{certificate:B,result:Mr(r.retTypes,H)}:j?{httpDetails:K,result:Mr(r.retTypes,H)}:Mr(r.retTypes,H);if(r.retTypes.length===0)return j?{httpDetails:I,result:void 0}:void 0;throw new Error(`Call was returned undefined, but type [${r.retTypes.join(",")}].`)};const s=(...c)=>i({},...c);return s.withOptions=c=>(...u)=>i(c,...u),s}function rc(t){function e(r,n){if(t.effectiveCanisterId)return{effectiveCanisterId:ye.from(t.effectiveCanisterId)};const i=n[0];let s=ye.fromHex("");return i&&typeof i=="object"&&i.target_canister&&r==="install_chunked_code"&&(s=ye.from(i.target_canister)),i&&typeof i=="object"&&i.canister_id&&(s=ye.from(i.canister_id)),{effectiveCanisterId:s}}return zn.createActor(ep,Object.assign(Object.assign(Object.assign({},t),{canisterId:ye.fromHex("")}),{callTransform:e,queryTransform:e}))}var es=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ur=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Pi,Ii,Kr,zr;function nc(t){return t!==null&&typeof t=="object"}class Xt{constructor(e){if(Pi.set(this,void 0),Ii.set(this,void 0),e.byteLength!==Xt.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");es(this,Pi,e,"f"),es(this,Ii,Xt.derEncode(e),"f")}static from(e){if(typeof e=="string"){const r=Qt(e);return this.fromRaw(r)}else if(nc(e)){const r=e;if(nc(r)&&Object.hasOwnProperty.call(r,"__derEncodedPublicKey__"))return this.fromDer(r);if(ArrayBuffer.isView(r)){const n=r;return this.fromRaw($a(n.buffer))}else{if(r instanceof ArrayBuffer)return this.fromRaw(r);if("rawKey"in r)return this.fromRaw(r.rawKey);if("derKey"in r)return this.fromDer(r.derKey);if("toDer"in r)return this.fromDer(r.toDer())}}throw new Error("Cannot construct Ed25519PublicKey from the provided key.")}static fromRaw(e){return new Xt(e)}static fromDer(e){return new Xt(this.derDecode(e))}static derEncode(e){const r=mf(e,Di).buffer;return r.__derEncodedPublicKey__=void 0,r}static derDecode(e){const r=_f(e,Di);if(r.length!==this.RAW_KEY_LENGTH)throw new Error("An Ed25519 public key must be exactly 32bytes long");return r}get rawKey(){return ur(this,Pi,"f")}get derKey(){return ur(this,Ii,"f")}toDer(){return this.derKey}toRaw(){return this.rawKey}}Pi=new WeakMap,Ii=new WeakMap;Xt.RAW_KEY_LENGTH=32;class gr extends za{constructor(e,r){super(),Kr.set(this,void 0),zr.set(this,void 0),es(this,Kr,Xt.from(e),"f"),es(this,zr,new Uint8Array(r),"f")}static generate(e){if(e&&e.length!==32)throw new Error("Ed25519 Seed needs to be 32 bytes long.");e||(e=Gr.utils.randomPrivateKey()),Gn(e,new Uint8Array(new Array(32).fill(0)))&&console.warn("Seed is all zeros. This is not a secure seed. Please provide a seed with sufficient entropy if this is a production environment.");const r=new Uint8Array(32);for(let i=0;i<32;i++)r[i]=new Uint8Array(e)[i];const n=Gr.getPublicKey(r);return gr.fromKeyPair(n,r)}static fromParsedJson(e){const[r,n]=e;return new gr(Xt.fromDer(Qt(r)),Qt(n))}static fromJSON(e){const r=JSON.parse(e);if(Array.isArray(r)){if(typeof r[0]=="string"&&typeof r[1]=="string")return this.fromParsedJson([r[0],r[1]]);throw new Error("Deserialization error: JSON must have at least 2 items.")}throw new Error(`Deserialization error: Invalid JSON type for string: ${JSON.stringify(e)}`)}static fromKeyPair(e,r){return new gr(Xt.fromRaw(e),r)}static fromSecretKey(e){const r=Gr.getPublicKey(new Uint8Array(e));return gr.fromKeyPair(r,e)}toJSON(){return[Re(ur(this,Kr,"f").toDer()),Re(ur(this,zr,"f"))]}getKeyPair(){return{secretKey:ur(this,zr,"f"),publicKey:ur(this,Kr,"f")}}getPublicKey(){return ur(this,Kr,"f")}async sign(e){const r=new Uint8Array(e),n=Nn(Gr.sign(r,ur(this,zr,"f").slice(0,32)));return Object.defineProperty(n,"__signature__",{enumerable:!1,value:void 0}),n}static verify(e,r,n){const[i,s,c]=[e,r,n].map(u=>(typeof u=="string"&&(u=Qt(u)),u instanceof Uint8Array&&(u=u.buffer),new Uint8Array(u)));return Gr.verify(s,i,c)}}Kr=new WeakMap,zr=new WeakMap;class Da extends Error{constructor(e){super(e),this.message=e,Object.setPrototypeOf(this,Da.prototype)}}function ic(t){if(typeof global<"u"&&global.crypto&&global.crypto.subtle)return global.crypto.subtle;if(t)return t;if(typeof crypto<"u"&&crypto.subtle)return crypto.subtle;throw new Da("Global crypto was not available and none was provided. Please inlcude a SubtleCrypto implementation. See https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto")}class ts extends za{constructor(e,r,n){super(),this._keyPair=e,this._derKey=r,this._subtleCrypto=n}static async generate(e){const{extractable:r=!1,keyUsages:n=["sign","verify"],subtleCrypto:i}=e??{},s=ic(i),c=await s.generateKey({name:"ECDSA",namedCurve:"P-256"},r,n),u=await s.exportKey("spki",c.publicKey);return new this(c,u,s)}static async fromKeyPair(e,r){const n=ic(r),i=await n.exportKey("spki",e.publicKey);return new ts(e,i,n)}getKeyPair(){return this._keyPair}getPublicKey(){const e=this._derKey,r=Object.create(this._keyPair.publicKey);return r.toDer=function(){return e},r}async sign(e){const r={name:"ECDSA",hash:{name:"SHA-256"}};return await this._subtleCrypto.sign(r,this._keyPair.privateKey,e)}}var np=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},yn=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},sr;class ip{constructor(e){sr.set(this,void 0),np(this,sr,e,"f")}get rawKey(){return yn(this,sr,"f").rawKey}get derKey(){return yn(this,sr,"f").derKey}toDer(){return yn(this,sr,"f").toDer()}getPublicKey(){return yn(this,sr,"f")}getPrincipal(){return ye.from(yn(this,sr,"f").rawKey)}transformRequest(){return Promise.reject("Not implemented. You are attempting to use a partial identity to sign calls, but this identity only has access to the public key.To sign calls, use a DelegationIdentity instead.")}}sr=new WeakMap;var sp=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},ap=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},op=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},ki;const cp=new TextEncoder().encode("ic-request-auth-delegation"),up=new TextEncoder().encode(`
ic-request`);function Ds(t){if(typeof t!="string"||t.length<64)throw new Error("Invalid public key.");return Qt(t)}class eo{constructor(e,r,n){this.pubkey=e,this.expiration=r,this.targets=n}toCBOR(){return ct.value.map(Object.assign({pubkey:ct.value.bytes(this.pubkey),expiration:ct.value.u64(this.expiration.toString(16),16)},this.targets&&{targets:ct.value.array(this.targets.map(e=>ct.value.bytes(e.toUint8Array())))}))}toJSON(){return Object.assign({expiration:this.expiration.toString(16),pubkey:Re(this.pubkey)},this.targets&&{targets:this.targets.map(e=>e.toHex())})}}async function fp(t,e,r,n){const i=new eo(e.toDer(),BigInt(+r)*BigInt(1e6),n),s=new Uint8Array([...cp,...new Uint8Array(Pn(Object.assign({},i)))]),c=await t.sign(s);return{delegation:i,signature:c}}class rs{constructor(e,r){this.delegations=e,this.publicKey=r}static async create(e,r,n=new Date(Date.now()+15*60*1e3),i={}){var s,c;const u=await fp(e,r,n,i.targets);return new rs([...((s=i.previous)===null||s===void 0?void 0:s.delegations)||[],u],((c=i.previous)===null||c===void 0?void 0:c.publicKey)||e.getPublicKey().toDer())}static fromJSON(e){const{publicKey:r,delegations:n}=typeof e=="string"?JSON.parse(e):e;if(!Array.isArray(n))throw new Error("Invalid delegations.");const i=n.map(s=>{const{delegation:c,signature:u}=s,{pubkey:l,expiration:p,targets:b}=c;if(b!==void 0&&!Array.isArray(b))throw new Error("Invalid targets.");return{delegation:new eo(Ds(l),BigInt("0x"+p),b&&b.map(x=>{if(typeof x!="string")throw new Error("Invalid target.");return ye.fromHex(x)})),signature:Ds(u)}});return new this(i,Ds(r))}static fromDelegations(e,r){return new this(e,r)}toJSON(){return{delegations:this.delegations.map(e=>{const{delegation:r,signature:n}=e,{targets:i}=r;return{delegation:Object.assign({expiration:r.expiration.toString(16),pubkey:Re(r.pubkey)},i&&{targets:i.map(s=>s.toHex())}),signature:Re(n)}}),publicKey:Re(this.publicKey)}}}class sc extends za{constructor(e,r){super(),this._inner=e,this._delegation=r}static fromDelegation(e,r){return new this(e,r)}getDelegation(){return this._delegation}getPublicKey(){return{derKey:this._delegation.publicKey,toDer:()=>this._delegation.publicKey}}sign(e){return this._inner.sign(e)}async transformRequest(e){const{body:r}=e,n=op(e,["body"]),i=await Pn(r);return Object.assign(Object.assign({},n),{body:{content:r,sender_sig:await this.sign(new Uint8Array([...up,...new Uint8Array(i)])),sender_delegation:this._delegation.delegations,sender_pubkey:this._delegation.publicKey}})}}class ns extends ip{constructor(e,r){super(e),ki.set(this,void 0),sp(this,ki,r,"f")}get delegation(){return ap(this,ki,"f")}static fromDelegation(e,r){return new ns(e,r)}}ki=new WeakMap;function lp(t,e){for(const{delegation:n}of t.delegations)if(+new Date(Number(n.expiration/BigInt(1e6)))<=+Date.now())return!1;const r=[];for(const n of r){const i=n.toText();for(const{delegation:s}of t.delegations){if(s.targets===void 0)continue;let c=!0;for(const u of s.targets)if(u.toText()===i){c=!1;break}if(c)return!1}}return!0}var ac;(function(t){t[t.ECDSA_WITH_SHA256=-7]="ECDSA_WITH_SHA256"})(ac||(ac={}));const oc=["mousedown","mousemove","keydown","touchstart","wheel"];class cc{constructor(e={}){var r;this.callbacks=[],this.idleTimeout=10*60*1e3,this.timeoutID=void 0;const{onIdle:n,idleTimeout:i=10*60*1e3}=e||{};this.callbacks=n?[n]:[],this.idleTimeout=i;const s=this._resetTimer.bind(this);window.addEventListener("load",s,!0),oc.forEach(function(u){document.addEventListener(u,s,!0)});const c=(u,l)=>{let p;return(...b)=>{const x=this,_=function(){p=void 0,u.apply(x,b)};clearTimeout(p),p=window.setTimeout(_,l)}};if(e?.captureScroll){const u=c(s,(r=e?.scrollDebounce)!==null&&r!==void 0?r:100);window.addEventListener("scroll",u,!0)}s()}static create(e={}){return new this(e)}registerCallback(e){this.callbacks.push(e)}exit(){clearTimeout(this.timeoutID),window.removeEventListener("load",this._resetTimer,!0);const e=this._resetTimer.bind(this);oc.forEach(function(r){document.removeEventListener(r,e,!0)}),this.callbacks.forEach(r=>r())}_resetTimer(){const e=this.exit.bind(this);window.clearTimeout(this.timeoutID),this.timeoutID=window.setTimeout(e,this.idleTimeout)}}const dp=(t,e)=>e.some(r=>t instanceof r);let uc,fc;function hp(){return uc||(uc=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function pp(){return fc||(fc=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const If=new WeakMap,Ra=new WeakMap,kf=new WeakMap,ea=new WeakMap,to=new WeakMap;function gp(t){const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",c)},s=()=>{r(wr(t.result)),i()},c=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",c)});return e.then(r=>{r instanceof IDBCursor&&If.set(r,t)}).catch(()=>{}),to.set(e,t),e}function yp(t){if(Ra.has(t))return;const e=new Promise((r,n)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",c),t.removeEventListener("abort",c)},s=()=>{r(),i()},c=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",c),t.addEventListener("abort",c)});Ra.set(t,e)}let Oa={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Ra.get(t);if(e==="objectStoreNames")return t.objectStoreNames||kf.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return wr(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function wp(t){Oa=t(Oa)}function bp(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const n=t.call(ta(this),e,...r);return kf.set(n,e.sort?e.sort():[e]),wr(n)}:pp().includes(t)?function(...e){return t.apply(ta(this),e),wr(If.get(this))}:function(...e){return wr(t.apply(ta(this),e))}}function mp(t){return typeof t=="function"?bp(t):(t instanceof IDBTransaction&&yp(t),dp(t,hp())?new Proxy(t,Oa):t)}function wr(t){if(t instanceof IDBRequest)return gp(t);if(ea.has(t))return ea.get(t);const e=mp(t);return e!==t&&(ea.set(t,e),to.set(e,t)),e}const ta=t=>to.get(t);function _p(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){const c=indexedDB.open(t,e),u=wr(c);return n&&c.addEventListener("upgradeneeded",l=>{n(wr(c.result),l.oldVersion,l.newVersion,wr(c.transaction),l)}),r&&c.addEventListener("blocked",l=>r(l.oldVersion,l.newVersion,l)),u.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),u}const vp=["get","getKey","getAll","getAllKeys","count"],xp=["put","add","delete","clear"],ra=new Map;function lc(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ra.get(e))return ra.get(e);const r=e.replace(/FromIndex$/,""),n=e!==r,i=xp.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||vp.includes(r)))return;const s=async function(c,...u){const l=this.transaction(c,i?"readwrite":"readonly");let p=l.store;return n&&(p=p.index(u.shift())),(await Promise.all([p[r](...u),i&&l.done]))[0]};return ra.set(e,s),s}wp(t=>({...t,get:(e,r,n)=>lc(e,r)||t.get(e,r,n),has:(e,r)=>!!lc(e,r)||t.has(e,r)}));const Cf="auth-client-db",Mf="ic-keyval",Ep=async(t=Cf,e=Mf,r)=>($f&&(localStorage!=null&&localStorage.getItem(hr))&&(localStorage.removeItem(hr),localStorage.removeItem(fr)),await _p(t,r,{upgrade:n=>{n.objectStoreNames.contains(e)&&n.clear(e),n.createObjectStore(e)}}));async function Tp(t,e,r){return await t.get(e,r)}async function Sp(t,e,r,n){return await t.put(e,n,r)}async function Ap(t,e,r){return await t.delete(e,r)}class ro{constructor(e,r){this._db=e,this._storeName=r}static async create(e){const{dbName:r=Cf,storeName:n=Mf,version:i=Op}=e??{},s=await Ep(r,n,i);return new ro(s,n)}async set(e,r){return await Sp(this._db,this._storeName,e,r)}async get(e){var r;return(r=await Tp(this._db,this._storeName,e))!==null&&r!==void 0?r:null}async remove(e){return await Ap(this._db,this._storeName,e)}}var Np=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},Bp=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Ci;const fr="identity",hr="delegation",Rp="iv",Op=1,$f=typeof window<"u";class Up{constructor(e="ic-",r){this.prefix=e,this._localStorage=r}get(e){return Promise.resolve(this._getLocalStorage().getItem(this.prefix+e))}set(e,r){return this._getLocalStorage().setItem(this.prefix+e,r),Promise.resolve()}remove(e){return this._getLocalStorage().removeItem(this.prefix+e),Promise.resolve()}_getLocalStorage(){if(this._localStorage)return this._localStorage;const e=typeof window>"u"?typeof global>"u"?typeof self>"u"?void 0:self.localStorage:global.localStorage:window.localStorage;if(!e)throw new Error("Could not find local storage.");return e}}class Fp{constructor(e){Ci.set(this,void 0),Np(this,Ci,e??{},"f")}get _db(){return new Promise(e=>{if(this.initializedDb){e(this.initializedDb);return}ro.create(Bp(this,Ci,"f")).then(r=>{this.initializedDb=r,e(r)})})}async get(e){return await(await this._db).get(e)}async set(e,r){await(await this._db).set(e,r)}async remove(e){await(await this._db).remove(e)}}Ci=new WeakMap;const Pp="https://identity.ic0.app",Ip="#authorize",na="ECDSA",ia="Ed25519",kp=500,Cp="UserInterrupt";class Mp{constructor(e,r,n,i,s,c,u,l){this._identity=e,this._key=r,this._chain=n,this._storage=i,this.idleManager=s,this._createOptions=c,this._idpWindow=u,this._eventHandler=l,this._registerDefaultIdleCallback()}static async create(e={}){var r,n,i;const s=(r=e.storage)!==null&&r!==void 0?r:new Fp,c=(n=e.keyType)!==null&&n!==void 0?n:na;let u=null;if(e.identity)u=e.identity;else{let x=await s.get(fr);if(!x&&$f)try{const _=new Up,v=await _.get(hr),d=await _.get(fr);v&&d&&c===na&&(console.log("Discovered an identity stored in localstorage. Migrating to IndexedDB"),await s.set(hr,v),await s.set(fr,d),x=v,await _.remove(hr),await _.remove(fr))}catch(_){console.error("error while attempting to recover localstorage: "+_)}if(x)try{typeof x=="object"?c===ia&&typeof x=="string"?u=await gr.fromJSON(x):u=await ts.fromKeyPair(x):typeof x=="string"&&(u=gr.fromJSON(x))}catch{}}let l=new Zi,p=null;if(u)try{const x=await s.get(hr);if(typeof x=="object"&&x!==null)throw new Error("Delegation chain is incorrectly stored. A delegation chain should be stored as a string.");e.identity?l=e.identity:x&&(p=rs.fromJSON(x),lp(p)?"toDer"in u?l=ns.fromDelegation(u,p):l=sc.fromDelegation(u,p):(await sa(s),u=null))}catch(x){console.error(x),await sa(s),u=null}let b;return!((i=e.idleOptions)===null||i===void 0)&&i.disableIdle?b=void 0:(p||e.identity)&&(b=cc.create(e.idleOptions)),u||(c===ia?(u=await gr.generate(),await s.set(fr,JSON.stringify(u.toJSON()))):(e.storage&&c===na&&console.warn(`You are using a custom storage provider that may not support CryptoKey storage. If you are using a custom storage provider that does not support CryptoKey storage, you should use '${ia}' as the key type, as it can serialize to a string`),u=await ts.generate(),await s.set(fr,u.getKeyPair()))),new this(l,u,p,s,b,e)}_registerDefaultIdleCallback(){var e,r;const n=(e=this._createOptions)===null||e===void 0?void 0:e.idleOptions;!n?.onIdle&&!n?.disableDefaultIdleCallback&&((r=this.idleManager)===null||r===void 0||r.registerCallback(()=>{this.logout(),location.reload()}))}async _handleSuccess(e,r){var n,i;const s=e.delegations.map(p=>({delegation:new eo(p.delegation.pubkey,p.delegation.expiration,p.delegation.targets),signature:p.signature.buffer})),c=rs.fromDelegations(s,e.userPublicKey.buffer),u=this._key;if(!u)return;this._chain=c,"toDer"in u?this._identity=ns.fromDelegation(u,this._chain):this._identity=sc.fromDelegation(u,this._chain),(n=this._idpWindow)===null||n===void 0||n.close();const l=(i=this._createOptions)===null||i===void 0?void 0:i.idleOptions;!this.idleManager&&!l?.disableIdle&&(this.idleManager=cc.create(l),this._registerDefaultIdleCallback()),this._removeEventListener(),delete this._idpWindow,this._chain&&await this._storage.set(hr,JSON.stringify(this._chain.toJSON())),r?.(e)}getIdentity(){return this._identity}async isAuthenticated(){return!this.getIdentity().getPrincipal().isAnonymous()&&this._chain!==null}async login(e){var r,n,i,s;const c=BigInt(8)*BigInt(36e11),u=new URL(((r=e?.identityProvider)===null||r===void 0?void 0:r.toString())||Pp);u.hash=Ip,(n=this._idpWindow)===null||n===void 0||n.close(),this._removeEventListener(),this._eventHandler=this._getEventHandler(u,Object.assign({maxTimeToLive:(i=e?.maxTimeToLive)!==null&&i!==void 0?i:c},e)),window.addEventListener("message",this._eventHandler),this._idpWindow=(s=window.open(u.toString(),"idpWindow",e?.windowOpenerFeatures))!==null&&s!==void 0?s:void 0;const l=()=>{this._idpWindow&&(this._idpWindow.closed?this._handleFailure(Cp,e?.onError):setTimeout(l,kp))};l()}_getEventHandler(e,r){return async n=>{var i,s,c;if(n.origin!==e.origin)return;const u=n.data;switch(u.kind){case"authorize-ready":{const l=Object.assign({kind:"authorize-client",sessionPublicKey:new Uint8Array((i=this._key)===null||i===void 0?void 0:i.getPublicKey().toDer()),maxTimeToLive:r?.maxTimeToLive,allowPinAuthentication:r?.allowPinAuthentication,derivationOrigin:(s=r?.derivationOrigin)===null||s===void 0?void 0:s.toString()},r?.customValues);(c=this._idpWindow)===null||c===void 0||c.postMessage(l,e.origin);break}case"authorize-client-success":try{await this._handleSuccess(u,r?.onSuccess)}catch(l){this._handleFailure(l.message,r?.onError)}break;case"authorize-client-failure":this._handleFailure(u.text,r?.onError);break}}}_handleFailure(e,r){var n;(n=this._idpWindow)===null||n===void 0||n.close(),r?.(e),this._removeEventListener(),delete this._idpWindow}_removeEventListener(){this._eventHandler&&window.removeEventListener("message",this._eventHandler),this._eventHandler=void 0}async logout(e={}){if(await sa(this._storage),this._identity=new Zi,this._chain=null,e.returnTo)try{window.history.pushState({},"",e.returnTo)}catch{window.location.href=e.returnTo}}}async function sa(t){await t.remove(fr),await t.remove(hr),await t.remove(Rp)}const aa=()=>Mp.create({idleOptions:{disableIdle:!0,disableDefaultIdleCallback:!0}});var $p=(t=>(t[t.FractionalMoreThan8Decimals=0]="FractionalMoreThan8Decimals",t[t.InvalidFormat=1]="InvalidFormat",t[t.FractionalTooManyDecimals=2]="FractionalTooManyDecimals",t))($p||{});BigInt(1e8);var dc=t=>t==null,hc="abcdefghijklmnopqrstuvwxyz234567",Mn=Object.create(null);for(let t=0;t<hc.length;t++)Mn[hc[t]]=t;Mn[0]=Mn.o;Mn[1]=Mn.i;const Gp=({width:t,height:e})=>{if(dc(window)||dc(window.top))return;const{top:{innerWidth:r,innerHeight:n}}=window,i=n/2+screenY-e/2,s=r/2+screenX-t/2;return`toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width=${t}, height=${e}, top=${i}, left=${s}`};let Pt;const Vp="https://golfpad.xyz",qp="https://gw4gh-taaaa-aaaal-qjfia-cai.icp0.io",Hp=()=>window.location.origin===Vp,jp=()=>{const{subscribe:t,set:e,update:r}=$n({identity:void 0});return{subscribe:t,sync:async()=>{Pt=Pt??await aa();const n=await Pt.isAuthenticated();e({identity:n?Pt.getIdentity():null})},signIn:({domain:n})=>new Promise(async(i,s)=>{Pt=Pt??await aa(),console.log(n);const c=n;await Pt?.login({maxTimeToLive:Il,onSuccess:()=>{r(u=>({...u,identity:Pt?.getIdentity()})),i()},onError:s,identityProvider:c,...Hp()&&{derivationOrigin:qp},windowOpenerFeatures:Gp({width:kl,height:Cl})})}),signOut:async()=>{await(Pt??await aa()).logout(),Pt=null,r(i=>({...i,identity:null}))}}},ut=jp(),Kp=$n(void 0),pc=async()=>{const t=await Ac(()=>import("./DGM2VuR3.js"),[],import.meta.url),e=new t.default;return e.onmessage=async({data:r})=>{const{msg:n,data:i}=r;switch(n){case"nnsSignOut":await ut.signOut();return;case"nnsDelegationRemainingTime":Kp.set(i.authRemainingTime);return}},{syncAuthIdle:r=>{if(!r.identity){e.postMessage({msg:"nnsStopIdleTimer"});return}e.postMessage({msg:"nnsStartIdleTimer"})}}},zp=t=>t;function Gf(t){const e=t-1;return e*e*e+1}function gc(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}function yc(t,{delay:e=0,duration:r=400,easing:n=zp}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:r,easing:n,css:s=>`opacity: ${s*i}`}}function Wp(t,{delay:e=0,duration:r=400,easing:n=Gf,x:i=0,y:s=0,opacity:c=0}={}){const u=getComputedStyle(t),l=+u.opacity,p=u.transform==="none"?"":u.transform,b=l*(1-c),[x,_]=gc(i),[v,d]=gc(s);return{delay:e,duration:r,easing:n,css:(A,S)=>`
			transform: ${p} translate(${(1-A)*x}${_}, ${(1-A)*v}${d});
			opacity: ${l-b*S}`}}function qg(t,{delay:e=0,duration:r=400,easing:n=Gf,start:i=0,opacity:s=0}={}){const c=getComputedStyle(t),u=+c.opacity,l=c.transform==="none"?"":c.transform,p=1-i,b=u*(1-s);return{delay:e,duration:r,easing:n,css:(x,_)=>`
			transform: ${l} scale(${1-p*_});
			opacity: ${u-b*_}
		`}}const Yp=()=>{const t=vl;return{page:{subscribe:t.page.subscribe},navigating:{subscribe:t.navigating.subscribe},updated:t.updated}},Zp={subscribe(t){return Yp().page.subscribe(t)}},Xp="nn75s-ayupf-j6mj3-kluyb-wjj7y-eang2-dwzzr-cfdxk-etbw7-cgwnb-lqe",Jp=Bc(ut,({identity:t})=>t!=null);Bc(ut,({identity:t})=>t!=null&&t.getPrincipal().toString()===Xp);var Qp=ft('<div class="nav-item expanded svelte-htsp64"><button> </button></div>'),Lp=ft('<div class="nav-item expanded svelte-htsp64"><a class="brand-button" href="/profile">Profile</a> <button class="px-12 py-3 text-lg font-semibold shadow-lg bg-GolfPadForest text-GolfPadYellow">SIGN OUT</button></div>'),Dp=ft('<div class="flex min-h-screen flex-col relative nav-overlay svelte-htsp64"><div class="absolute top-4 left-4 z-10"><button class="bg-black rounded-full w-12 h-12 flex items-center justify-center text-2xl font-bold text-white shadow-md">-</button></div> <div class="absolute top-4 right-4 z-10"><button><span class="text-3xl font-extrabold text-black condensed">GOLFPAD</span></button></div> <div class="nav-content flex flex-col items-start pl-10 svelte-htsp64"><!> <!></div> <div class="flex justify-between items-center p-5 text-xs lg:text-base"><div class="social-links svelte-htsp64"><a href="https://twitter.com" target="_blank" class="svelte-htsp64">TWITTER</a> <a href="https://oc.app" target="_blank" class="svelte-htsp64">OPENCHAT</a> <a href="https://youtube.com" target="_blank" class="svelte-htsp64">YOUTUBE</a></div> <div><img src="placeholder.png" alt="Profile" class="w-12 h-12 rounded-full"></div></div></div>');function eg(t,e){as(e,!1);const[r,n]=ka(),i=()=>An(Zp,"$page",r),s=()=>An(b,"$navItems",r),c=()=>An(Jp,"$authSignedInStore",r);let u=Sn(e,"expanded",8,!1),l=Sn(e,"selectedRoute",12,"home"),p=Sn(e,"toggleNav",8);const b=$n([{name:"HOME",route:"home"},{name:"WHITEPAPER",route:"whitepaper"},{name:"GAME RULES",route:"game-rules"}]);function x(I){if(l(I),p()(),I==="home"){Is("/");return}Is(`/${I}`)}function _(){p()()}function v(){p()(),Is("/")}function d(){ut.signOut()}di(()=>i(),()=>{switch(i().url.pathname){case"/":l("home");break;case"/whitepaper":l("whitepaper");break;case"/game-rules":l("game-rules");break;case"/games":l("games");break;case"/governance":l("governance");break;default:l("home");break}}),Ec(),ss();var A=Mi(),S=Xr(A);{var P=I=>{var R=Dp(),H=st(R),B=st(H);at(H);var j=Gt(H,2),V=st(j);at(j);var K=Gt(j,2),Y=st(K);Oc(Y,1,s,D=>D.route,(D,T)=>{var U=Qp(),G=st(U),$=st(G,!0);at(G),at(U),Tc(()=>{Pc(G,1,`text-3xl lg:text-6xl font-bold condensed ${(l()===gt(T).route?"text-white":"text-black")??""}`),Sc($,gt(T).name)}),Yt("click",G,()=>x(gt(T).route)),We(D,U)});var z=Gt(Y,2);{var ne=D=>{var T=Lp(),U=Gt(st(T),2);at(T),Yt("click",U,d),We(D,T)};Jr(z,D=>{c()&&D(ne)})}at(K),cs(2),at(R),Yt("click",B,_),Yt("click",V,v),ca(1,R,()=>yc,()=>({duration:300})),ca(2,R,()=>yc,()=>({duration:300})),We(I,R)};Jr(S,I=>{u()&&I(P)})}We(t,A),os(),n()}var tg=ft('<div class="z-10 px-4 mb-20 text-center"><h1 class="mb-1 font-bold text-BrandForest">WELCOME TO <span class="condensed">GOLFPAD</span></h1> <h2 class="mx-16 mb-6 text-5xl font-black leading-tight text-black md:text-6xl condensed">THE FUTURE OF GOLF STARTS HERE</h2> <button class="brand-button">CONNECT</button></div> <div class="absolute bottom-0 left-0 z-0 w-full"><img src="golfball_mobile.png" alt="Golf Ball" class="object-cover w-full h-auto md:hidden"> <img src="golfball.png" alt="Golf Ball" class="hidden object-cover w-full md:flex"></div>',1);function rg(t,e){as(e,!1);function r(){let c={domain:"https://identity.ic0.app"};ut.signIn(c)}ss();var n=tg(),i=Xr(n),s=Gt(st(i),4);at(i),cs(2),Yt("click",s,r),We(t,n),os()}var ng=ft('<div class="flex-none h-[80px] relative"><div class="absolute z-10 top-4 left-4"><button class="flex items-center justify-center w-12 h-12 text-2xl font-bold text-white bg-black rounded-full shadow-md">+</button></div> <div class="absolute z-10 top-4 right-4"><a href="/"><span class="text-3xl font-extrabold text-black condensed">GOLFPAD</span></a></div></div>');function ig(t,e){let r=Sn(e,"toggleNav",8);var n=ng(),i=st(n),s=st(i);at(i),cs(2),at(n),Yt("click",s,function(...c){r()?.apply(this,c)}),We(t,n)}function sg(){const{subscribe:t,update:e}=$n([]);let r=0;function n(s){e(c=>[...c,{...s,id:++r}])}function i(s){e(c=>c.filter(u=>u.id!==s))}return{subscribe:t,addToast:n,removeToast:i}}const Wn=sg(),{addToast:Hg}=Wn;function Lr(t){return t&&t.err!==void 0}const is=({IDL:t})=>{const e=t.Text,r=t.Record({principalId:e,requestedBy:e}),n=t.Variant({InvalidProfilePicture:t.Null,DecodeError:t.Null,TooLong:t.Null,NotAllowed:t.Null,NotEnoughFunds:t.Null,TooShort:t.Null,NotFound:t.Null,NotAuthorized:t.Null,AlreadyExists:t.Null,CreateGameError:t.Null,OutOfRange:t.Null,PaymentError:t.Null,CanisterFull:t.Null}),i=t.Variant({ok:t.Null,err:n}),s=t.Nat,c=t.Record({gameId:s,acceptedById:e}),u=t.Nat8,l=t.Record({golfer2MulliganUsed:t.Bool,winner:e,golfer1MulliganUsed:t.Bool,holeNumber:u}),p=t.Variant({MulligansScores:l}),b=t.Record({submittedById:e,gameId:s,detail:p}),x=t.Text,_=t.Record({principalId:x}),v=t.Record({gameId:s}),d=t.Nat8,A=t.Variant({Mulligans:t.Null,BuildIt:t.Null,Bands:t.Null,NextUp:t.Null,Prophet:t.Null}),S=t.Nat,P=t.Record({par:t.Nat8,name:t.Text,yardage:t.Nat,colour:t.Text,strokeIndex:t.Nat8}),I=t.Record({owner:e,uploaded:t.Int,image:t.Vec(t.Nat8)}),R=t.Record({name:t.Text,tees:t.Vec(P),number:t.Nat8,images:t.Vec(I)}),H=t.Record({added:t.Int,holes:t.Vec(R),name:t.Text,colour:t.Text,strokeIndex:t.Nat8}),B=t.Record({name:t.Text,inviteIds:t.Vec(e),createdById:e,teeOffTime:t.Int,courseVersion:d,gameType:A,courseId:S,teeGroup:H}),j=t.Variant({ok:s,err:n}),V=t.Record({name:t.Text,createdById:e}),K=t.Nat,Y=t.Variant({ok:K,err:n}),z=t.Int16,ne=t.Record({username:t.Text,profilePictureExtension:t.Opt(t.Text),profilePicture:t.Opt(t.Vec(t.Nat8)),handicap:t.Opt(z)}),D=t.Record({gameId:s}),T=t.Record({channelId:K}),U=t.Record({holes:t.Vec(R),name:t.Text,initialTeeGroup:H}),G=t.Record({name:t.Text,updatedTeeGroup:t.Opt(H),courseId:S}),$=t.Record({version:t.Text,onHold:t.Bool}),M=t.Variant({ok:$,err:n}),W=t.Record({gameId:s}),J=t.Variant({Unplayed:t.Null,Active:t.Null,Complete:t.Null}),oe=t.Record({golfer2MulliganUsed:t.Bool,winner:e,golfer1MulliganUsed:t.Bool,holeNumber:u}),se=t.Record({winner:e,results:t.Vec(oe),golfer2HolesWonCount:t.Nat8,golfer1HolesWonCount:t.Nat8}),ue=t.Variant({MulligansScores:se}),Z=t.Record({}),g=t.Record({wontHitTreeOrBunkerStartHole:u,underParStartHole:u,golferId:e,wontDoubleBogeyStartHole:u,singlePutt2Of3GreensStartHole:u,wontBogeyStartHole:u,parOrUnderStartHole:u,hit2Of3FairwaysStartHole:u,hit2Of3GreensStartHole:u,wontLoseBallStartHole:u}),L=t.Variant({Mulligans:Z,BuildIt:t.Record({}),Bands:g,NextUp:t.Record({})}),ie=t.Record({courseVersion:d,courseId:S,teeGroup:H}),ae=t.Variant({Par:t.Null,Scrub:t.Null,DoubleBogey:t.Null,Birdie:t.Null,BallNotLost:t.Null,Bogey:t.Null,HitFairway:t.Null,Albatross:t.Null,HitBunker:t.Null,HitTree:t.Null,HitGreen:t.Null,TakeMulligan:t.Null,HitWater:t.Null,LongestDrive:t.Null,Eagle:t.Null,OnePuttGreen:t.Null}),X=t.Record({golferId:e,hole:u,event:ae}),te=t.Record({id:s,playerIds:t.Vec(e),status:J,scoreDetail:t.Opt(ue),invites:t.Vec(e),predictions:t.Vec(L),winner:e,teeOffTime:t.Int,courseSnapshot:ie,events:t.Vec(X),gameType:A,courseId:S}),y=t.Variant({ok:te,err:n}),m=t.Record({channelId:K}),E=t.Record({channelId:K,name:t.Text}),k=t.Variant({ok:E,err:n}),F=t.Record({channelId:K}),C=t.Record({channelId:K}),f=t.Variant({ok:C,err:n}),a=t.Record({channelId:K,page:t.Nat}),o=t.Record({channelId:K}),h=t.Variant({ok:o,err:n}),w=t.Record({golfCourseId:S}),N=t.Record({activeVersion:d,name:t.Text,tees:t.Vec(H),courseId:S}),q=t.Variant({ok:N,err:n}),Q=t.Record({offset:t.Nat,limit:t.Nat,searchTerm:t.Text}),ce=t.Record({entries:t.Vec(N)}),de=t.Variant({ok:ce,err:n}),he=t.Record({principalId:e}),ee=t.Record({username:t.Text,golferPicture:t.Opt(t.Vec(t.Nat8)),handicap:t.Opt(z),golferPictureExtension:t.Text,principalId:e}),pe=t.Variant({ok:ee,err:n}),Ne=t.Record({principalId:x}),et=t.Record({}),bt=t.Variant({ok:et,err:n}),Vt=t.Record({gameId:s,invitedGolferIds:t.Vec(e)}),we=t.Record({username:t.Text,principalId:e}),mt=t.Bool,je=t.Variant({ok:mt,err:n}),ke=t.Record({totalEntries:t.Nat,offset:t.Nat,limit:t.Nat,principalId:e}),Te=t.Record({requestTime:t.Int,principalId:e}),an=t.Record({friendRequests:t.Vec(Te)}),Se=t.Variant({ok:an,err:n}),on=t.Record({totalEntries:t.Nat,offset:t.Nat,limit:t.Nat,principalId:e}),cn=t.Record({principalId:e}),un=t.Record({friendRequests:t.Vec(cn)}),fn=t.Variant({ok:un,err:n}),ln=t.Record({totalEntries:t.Nat,offset:t.Nat,limit:t.Nat,searchTerm:t.Text}),Rt=t.Record({golferPrincipalId:e,golferPicture:t.Opt(t.Vec(t.Nat8)),golferName:t.Text,handicap:t.Opt(z),golferPictureExtension:t.Text}),no=t.Record({golfers:t.Vec(Rt)}),io=t.Variant({ok:no,err:n}),so=t.Record({principalId:x}),ao=t.Record({}),$e=t.Variant({ok:ao,err:n}),oo=t.Record({principalId:e,requestedBy:e}),co=t.Record({rejectedById:e,gameId:s}),uo=t.Record({channelId:K}),ms=t.Record({requestedFriend:e,principalId:e}),_s=t.Record({channelId:K,principalId:e}),vs=t.Record({channelId:K,principalId:e}),xs=t.Record({principalId:e,firstName:t.Text}),Ue=t.Record({gameId:s}),Es=t.Record({channelId:K,name:t.Text,channelBanner:t.Opt(t.Vec(t.Nat8)),channelBannerExtension:t.Text,channelImageExtension:t.Text,channelImage:t.Opt(t.Vec(t.Nat8))}),Ts=t.Record({channelId:K}),Ss=t.Record({handicap:t.Opt(z),principalId:e}),As=t.Record({homeCourseId:t.Opt(S),principalId:e}),Ns=t.Record({lastName:t.Text,principalId:e}),Bs=t.Record({profilePictureExtension:t.Text,profilePicture:t.Opt(t.Vec(t.Nat8)),principalId:e}),Rs=t.Record({username:t.Text,principalId:e}),Os=t.Record({channelId:K}),xe=t.Variant({Ok:t.Text,Err:t.Text});return t.Service({acceptFriendRequest:t.Func([r],[i],[]),acceptGameInvite:t.Func([c],[i],[]),addGameScore:t.Func([b],[i],[]),addShot:t.Func([_],[i],[]),beginGame:t.Func([v],[i],[]),createGame:t.Func([B],[j],[]),createGolfChannel:t.Func([V],[Y],[]),createUser:t.Func([ne],[i],[]),deleteGame:t.Func([D],[i],[]),deleteGolfChannel:t.Func([T],[i],[]),executeAddGolfCourse:t.Func([U],[],[]),executeUpdateGolfCourse:t.Func([G],[],[]),getAppStatus:t.Func([],[M],["query"]),getGame:t.Func([W],[y],[]),getGolfChannel:t.Func([m],[k],[]),getGolfChannelVideo:t.Func([F],[f],[]),getGolfChannelVideos:t.Func([a],[h],[]),getGolfCourse:t.Func([w],[q],[]),getGolfCourses:t.Func([Q],[de],[]),getProfile:t.Func([he],[pe],[]),getShot:t.Func([Ne],[bt],[]),inviteGolfers:t.Func([Vt],[i],[]),isUsernameAvailable:t.Func([we],[je],["query"]),listFriendRequests:t.Func([ke],[Se],[]),listFriends:t.Func([on],[fn],[]),listGolfers:t.Func([ln],[io],[]),predictShot:t.Func([so],[$e],[]),rejectFriendRequest:t.Func([oo],[i],[]),rejectGameInvite:t.Func([co],[i],[]),removeGolfChannelVideo:t.Func([uo],[i],[]),sendFriendRequest:t.Func([ms],[i],[]),subscribeToGolfChannel:t.Func([_s],[i],[]),unsubscribeFromGolfChannel:t.Func([vs],[i],[]),updateFirstName:t.Func([xs],[i],[]),updateGame:t.Func([Ue],[i],[]),updateGolfChannel:t.Func([Es],[i],[]),updateGolfChannelVideo:t.Func([Ts],[i],[]),updateHandicap:t.Func([Ss],[i],[]),updateHomeCourse:t.Func([As],[i],[]),updateLastName:t.Func([Ns],[i],[]),updateProfilePicture:t.Func([Bs],[i],[]),updateUsername:t.Func([Rs],[i],[]),uploadGolfChannelVideo:t.Func([Os],[i],[]),validateAddGolfCourse:t.Func([U],[xe],["query"]),validateUpdateGolfCourse:t.Func([G],[xe],["query"])})};var ag={};const wc=ag.CANISTER_ID_BACKEND,og=(t,e={})=>{const r=e.agent||new pr({...e.agentOptions});return e.agent&&e.agentOptions&&console.warn("Detected both agent and agentOptions passed to createActor. Ignoring agentOptions and proceeding with the provided agent."),zn.createActor(is,{agent:r,canisterId:t,...e.actorOptions})};wc&&og(wc);class Jt{static createActor(e,r="",n=null,i=null){const s={host:`https://${r}.icp-api.io`,identity:n};i?i.agentOptions?i.agentOptions.host=s.host:i.agentOptions=s:i={agentOptions:s};const c=new pr({...i.agentOptions});return zn.createActor(e,{agent:c,canisterId:r,...i?.actorOptions})}static getAgent(e="",r=null,n=null){const i={host:`https://${e}.icp-api.io`,identity:r};return n?n.agentOptions?n.agentOptions.host=i.host:n.agentOptions=i:n={agentOptions:i},new pr({...n.agentOptions})}static createIdentityActor(e,r){let n;return new Promise((i,s)=>{n=e.subscribe(c=>{c.identity&&i(c.identity)})}).then(i=>(n(),Jt.createActor(is,r,i)))}static createGovernanceAgent(e,r){let n;return new Promise((i,s)=>{n=e.subscribe(c=>{c.identity&&i(c.identity)})}).then(i=>(n(),Jt.createActor(is,r,i)))}}var cg={BACKEND_CANISTER_ID:"elbip-aiaaa-aaaal-qjfhq-cai",FRONTEND_CANISTER_ID:"gw4gh-taaaa-aaaal-qjfia-cai",DFX_NETWORK:"ic"};class vr{constructor(){ut.sync()}async getProfile(){return null}async createUser(e){try{return await(await Jt.createIdentityActor(ut,cg.BACKEND_CANISTER_ID??"")).createUser(e)}catch(r){throw console.error("Error creating user:",r),r}}async updateUsername(e){}async updateHandicap(e){}async updateFirstName(e){}async updateLastName(e){}async updateHomeCourse(e){}async updateProfilePicture(e){}}var fi={BACKEND_CANISTER_ID:"elbip-aiaaa-aaaal-qjfhq-cai",FRONTEND_CANISTER_ID:"gw4gh-taaaa-aaaal-qjfia-cai",DFX_NETWORK:"ic"};function ug(){const{subscribe:t,set:e}=$n(null);async function r(){let A=localStorage.getItem("user_profile_data");if(A){const S=JSON.parse(A);e(S);return}try{await v()}catch(S){throw console.error("Error fetching user profile:",S),S}}async function n(){return new vr().isAdmin()}async function i(A){return new vr().createUser(A)}async function s(A){return new vr().updateUsername(A)}async function c(A){return new vr().updateHandicap(A)}async function u(A){return new vr().updateFirstName(A)}async function l(A){return new vr().updateLastName(A)}async function p(A){return new vr().updateHomeCourse(A)}async function b(A){try{const P=x(A);if(A.size>1e3*1024)return null;const I=new FileReader;I.readAsArrayBuffer(A),I.onloadend=async()=>{const R=I.result,H=new Uint8Array(R);try{const B=await Jt.createIdentityActor(ut,fi.BACKEND_CANISTER_ID??"");let j={principalId:"",profilePicture:[H],profilePictureExtension:P};const V=await B.updateUserPicture(j);if(Lr(V)){console.error("Error updating profile picture");return}return await v(),V}catch(B){console.error(B)}}}catch(S){throw console.error("Error updating profile picture:",S),S}}function x(A){const S=A.name,P=S.lastIndexOf(".");return P!==-1?S.substring(P+1):""}async function _(A){try{return await(await Jt.createIdentityActor(ut,fi.BACKEND_CANISTER_ID??"")).isUsernameTaken(A)}catch(S){throw console.error("Error getting user:",S),S}}async function v(){const A=await Jt.createIdentityActor(ut,fi.BACKEND_CANISTER_ID);ut.subscribe(async S=>{let P=S.identity?.getPrincipal().toString();if(!P)return;let I={principalId:P},R=await A.getProfile(I);if(Lr(R)){console.error("Error fetching user profile");return}let B=R.ok;e(B)})}async function d(A){const S=await Jt.createIdentityActor(ut,fi.BACKEND_CANISTER_ID);let P={principalId:A},I=await S.getProfile(P);return Lr(I)?(console.error("Error fetching user profile"),null):I.ok}return{subscribe:t,sync:r,getProfile:d,createUser:i,updateUsername:s,updateHandicap:c,updateFirstName:u,updateLastName:l,updateHomeCourse:p,cacheProfile:v,updateProfilePicture:b,isUsernameAvailable:_,isAdmin:n}}const jg=ug();var fg=ft('<div class="local-spinner svelte-pvdm52"></div>');function bc(t){var e=fg();We(t,e)}var lg={BACKEND_CANISTER_ID:"elbip-aiaaa-aaaal-qjfhq-cai"};class mc{constructor(){}async getAppStatus(){const r=await(await Jt.createActor(is,lg.BACKEND_CANISTER_ID)).getAppStatus();if(Lr(r))throw new Error("Failed to get app status");return r.ok}}function dg(){async function t(){const r=await new mc().getAppStatus();if(Lr(r))throw new Error("Error fetching app status");let n=r;if(!localStorage.getItem("version")){localStorage.setItem("version",n.version);return}n.version!==localStorage.getItem("version")&&Wn.addToast({message:`ICFC V${n.version} is now available. Click here to reload:`,type:"frontend-update"})}async function e(){const r=await new mc().getAppStatus();if(Lr(r))throw new Error("Error fetching app status");let n=r;localStorage.setItem("version",n.version),window.location.replace(`${window.location.pathname}?v=${n.version}`)}return{checkServerVersion:t,updateFrontend:e}}const hg=dg();var pg=ft('<button class="brand-button">Update Website</button>'),gg=ft('<div><span> </span> <!> <button class="font-bold ml-4">&times;</button></div>');function yg(t,e){as(e,!1);let r=Sn(e,"toast",8);Rc(()=>{r().duration&&r().duration>0&&setTimeout(n,r().duration)});function n(){Wn.removeToast(r().id)}function i(){hg.updateFrontend()}ss();var s=gg(),c=st(s),u=st(c,!0);at(c);var l=Gt(c,2);{var p=x=>{var _=pg();Yt("click",_,i),We(x,_)};Jr(l,x=>{r().type=="frontend-update"&&x(p)})}var b=Gt(l,2);at(s),Tc(()=>{Pc(s,1,`fixed top-0 left-0 right-0 z-[9999] p-4 text-white shadow-md flex justify-between items-center bg-${r().type}`),Sc(u,r().message)}),Yt("click",b,n),We(t,s),os()}var wg=ft("<div><!></div>");function bg(t){const[e,r]=ka(),n=()=>An(Wn,"$toasts",e);var i=Mi(),s=Xr(i);Oc(s,1,n,c=>c.id,(c,u)=>{var l=wg(),p=st(l);yg(p,{get toast(){return gt(u)}}),at(l),ca(1,l,()=>Wp,()=>({y:20,duration:200})),We(c,l)}),We(t,i),r()}var mg=ft('<link rel="preload" href="/MonaSans-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous"> <link rel="preload" href="/MonaSans-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous"> <link rel="preload" href="/MonaSansCondensed-ExtraBold.woff2" as="font" type="font/woff2" crossorigin="anonymous"> <link rel="preload" href="/MonaSansCondensed-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">',1),_g=ft('<div class="bg-white text-black flex-1 flex"><!></div>'),vg=ft("<p>Logged in</p>"),xg=ft("<!> <!> <!> <!>",1),Eg=ft('<div class="flex flex-col min-h-screen default-text"><!></div>');function Kg(t,e){as(e,!1);const[r,n]=ka(),i=()=>An(ut,"$authStore",r),s=Zn();let c=Zn(!1),u,l=Zn(!1),p="home",b=Zn(!0);const x=async()=>{await Promise.all([_()]),u=await pc()},_=async()=>{try{await ut.sync()}catch{Wn.addToast({message:"Unexpected issue while syncing the status of your authentication.",type:"error"})}},v=async P=>{if(u?.syncAuthIdle(P),!P.identity){pn(c,!1);return}gt(c)||pn(c,!0)};Rc(async()=>{u=await pc(),await v(i()),pn(b,!1)});function d(){pn(l,!gt(l))}di(()=>i(),()=>{v(i())}),di(()=>fo,()=>{pn(s,fo.url.pathname==="/whitepaper")}),di(()=>i(),()=>{(()=>{if(i()===void 0)return;document.querySelector("body > #app-spinner")?.remove()})()}),Ec(),ss();var A=Mi();bl(P=>{var I=mg();cs(6),We(P,I)}),Yt("storage",gl,_);var S=Xr(A);xl(S,x,P=>{bc(P)},(P,I)=>{var R=Eg(),H=st(R);{var B=V=>{bc(V)},j=V=>{var K=xg(),Y=Xr(K);ig(Y,{toggleNav:d});var z=Gt(Y,2);{var ne=G=>{var $=_g(),M=st($);Al(M,e,"default",{}),at($),We(G,$)},D=G=>{var $=Mi(),M=Xr($);{var W=oe=>{var se=vg();We(oe,se)},J=oe=>{rg(oe,{})};Jr(M,oe=>{gt(c)?oe(W):oe(J,!1)})}We(G,$)};Jr(z,G=>{gt(s)?G(ne):G(D,!1)})}var T=Gt(z,2);eg(T,{get expanded(){return gt(l)},selectedRoute:p,toggleNav:d});var U=Gt(T,2);bg(U),We(V,K)};Jr(H,V=>{gt(b)?V(B):V(j,!1)})}at(R),We(P,R)}),We(t,A),os(),n()}export{Kg as L,Al as a,ca as b,Pg as c,qg as d,Oc as e,yc as f,Fg as i,Pc as s,Ig as t,jg as u};
