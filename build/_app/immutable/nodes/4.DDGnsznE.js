import{c as N,a as g,t as D}from"../chunks/HCuMicKI.js";import{i as J}from"../chunks/8Q8-ADJa.js";import{p as Q,a as V,f as h,a1 as f,a2 as I,w as a,s as Z,z as tt}from"../chunks/AGc4v_Jp.js";import{i as b}from"../chunks/Bn46RIuP.js";import{e as et,i as rt}from"../chunks/DXct-rb-.js";import{s as at,a as ot}from"../chunks/C7nj3rmD.js";import{w as it,o as nt}from"../chunks/v9RRueV-.js";import{g as R}from"../chunks/D4dtDc8v.js";import{A as p,a as c,i as d,L as st,t as ct}from"../chunks/C1VosLKo.js";import{p as mt}from"../chunks/C77BM_1A.js";import{L as ut}from"../chunks/TSpNyb_W.js";import{P as lt}from"../chunks/DZB6e4u4.js";import{L as gt}from"../chunks/D2og91Rj.js";var _={BACKEND_CANISTER_ID:"elbip-aiaaa-aaaal-qjfhq-cai",FRONTEND_CANISTER_ID:"gw4gh-taaaa-aaaal-qjfia-cai",DFX_NETWORK:"ic"};class C{constructor(){}async getGameSummaries(e){try{let t=await(await p.createIdentityActor(c,_.BACKEND_CANISTER_ID??"")).getGameSummaries(e);return d(t)&&console.error("Error Fetching Game Summaries",t),t.ok}catch(r){throw console.error("Error Fetching Game Summaries",r),r}}async getGame(e){try{const r=await p.createIdentityActor(c,_.BACKEND_CANISTER_ID??"");let t={gameId:BigInt(e)},n=await r.getGame(t);return d(n)&&console.error("Error Fetching Game",n),n.ok}catch(r){throw console.error("Error Fetching Game",r),r}}async createGame(e){const t=await(await p.createIdentityActor(c,_.BACKEND_CANISTER_ID)).createGame(e);if(d(t))throw new Error("Error Creating Game");return t.ok}async beginGame(e){const t=await(await p.createIdentityActor(c,_.BACKEND_CANISTER_ID)).beginGame(e);if(d(t))throw new Error("Error Setting Up Game");return t.ok}async predictGame(e){const t=await(await p.createIdentityActor(c,_.BACKEND_CANISTER_ID)).predictGame(e);if(d(t))throw new Error("Error Making Game Prediction");return t.ok}async addGameScore(e){const t=await(await p.createIdentityActor(c,_.BACKEND_CANISTER_ID)).addGameScore(e);if(d(t))throw new Error("Error Adding Game Score");return t.ok}}function ft(){const{subscribe:y,set:e}=it([]);async function r(o){return new C().getGameSummaries(o)}async function t(o){return new C().getGame(o)}async function n(o){return new C().createGame(o)}return{subscribe:y,setGame:o=>e(o),getGame:t,createGame:n,getGameSummaries:r}}const pt=ft();function dt(y,e){mt(e,"game",8)}var _t=D("<p>You have no games.</p>"),yt=D("<!> <!>",1),At=D("<p>Error loading game summaries.</p>");function Rt(y,e){Q(e,!1);const[r,t]=at(),n=()=>ot(c,"$authStore",r);let o=I(!0),i=I(null),A=I(1n),v=I(1n);nt(async()=>{T()});function $(){R("/games/create")}async function k(w){const s=Number(a(A))+w;s>=1&&s<=Number(a(v))&&(f(A,BigInt(s)),await T())}async function T(){f(o,!0);try{const s=n().identity?.getPrincipal();if(!s){R("/");return}let E={page:a(A),user_id:s.toString()};f(i,await pt.getGameSummaries(E)),a(i)?.total&&a(i)?.pageSize&&f(v,BigInt(Math.ceil(Number(a(i).total)/Number(a(i).pageSize))))}catch{ct.addToast({type:"error",message:"Error loading game summaries."}),f(i,null)}finally{f(o,!1)}}J(),st(y,{children:(w,s)=>{var E=N(),K=h(E);{var F=m=>{gt(m)},L=m=>{ut(m,{title:"GAMES",buttonTitle:"NEW GAME",buttonCallback:$,children:(M,wt)=>{var P=N(),q=h(P);{var x=u=>{var G=yt(),B=h(G);{var j=l=>{var S=N(),X=h(S);et(X,1,()=>a(i)?.entries,rt,(Y,H)=>{dt(Y,{get game(){return a(H)}})}),g(l,S)},O=l=>{var S=_t();g(l,S)};b(B,l=>{a(i).entries.length>0?l(j):l(O,!1)})}var W=Z(B,2);const U=tt(()=>Number(a(A)));lt(W,{changePage:k,get currentPage(){return a(U)},get totalPages(){return a(v)}}),g(u,G)},z=u=>{var G=At();g(u,G)};b(q,u=>{a(i)?u(x):u(z,!1)})}g(M,P)},$$slots:{default:!0}})};b(K,m=>{a(o)?m(F):m(L,!1)})}g(w,E)},$$slots:{default:!0}}),V(),t()}export{Rt as component};
