import{c as E,a as u,t as D}from"../chunks/HCuMicKI.js";import{i as Q}from"../chunks/XNWQKLPs.js";import{p as U,a as V,f as h,a1 as g,a2 as G,w as e,s as Z,z as ee}from"../chunks/AGc4v_Jp.js";import{i as A}from"../chunks/Bn46RIuP.js";import{e as ae,i as te}from"../chunks/DXct-rb-.js";import{s as re,a as oe}from"../chunks/C7nj3rmD.js";import{w as se,o as ie}from"../chunks/v9RRueV-.js";import{g as B}from"../chunks/Dgm5pAvY.js";import{A as N,a as w,i as I,L as ne,t as me}from"../chunks/BboxWTF9.js";import{p as ce}from"../chunks/C77BM_1A.js";import{L as le}from"../chunks/BzUOsuRu.js";import{P as ue}from"../chunks/C516gq5F.js";import{L as ge}from"../chunks/BdRhVS7j.js";var b={BACKEND_CANISTER_ID:"elbip-aiaaa-aaaal-qjfhq-cai",FRONTEND_CANISTER_ID:"gw4gh-taaaa-aaaal-qjfia-cai",DFX_NETWORK:"ic"};class C{constructor(){}async getGameSummaries(r){try{let t=await(await N.createIdentityActor(w,b.BACKEND_CANISTER_ID??"")).getGameSummaries(r);return I(t)&&console.error("Error Fetching Game Summaries",t),t.ok}catch(a){throw console.error("Error Fetching Game Summaries",a),a}}async getGame(r){try{const a=await N.createIdentityActor(w,b.BACKEND_CANISTER_ID??"");let t={gameId:BigInt(r)},i=await a.getGame(t);return I(i)&&console.error("Error Fetching Game",i),i.ok}catch(a){throw console.error("Error Fetching Game",a),a}}async createGame(r){const t=await(await N.createIdentityActor(w,b.BACKEND_CANISTER_ID)).createGame(r);if(I(t))throw new Error("Error Creating Game");return{ok:t.ok}}}function fe(){const{subscribe:f,set:r}=se([]);async function a(o){return new C().getGameSummaries(o)}async function t(o){return new C().getGame(o)}async function i(o){return new C().createGame(o)}return{subscribe:f,setGame:o=>r(o),getGame:t,createGame:i,getGameSummaries:a}}const pe=fe();function _e(f,r){ce(r,"game",8)}var de=D("<p>You have no games.</p>"),ve=D("<!> <!>",1),ye=D("<p>Error loading game summaries.</p>");function Be(f,r){U(r,!1);const[a,t]=re(),i=()=>oe(w,"$authStore",a);let o=G(!0),s=G(null),p=G(1n),S=G(1n);ie(async()=>{P()});function F(){B("/games/create")}async function L(_){const n=Number(e(p))+_;n>=1&&n<=Number(e(S))&&(g(p,BigInt(n)),await P())}async function P(){g(o,!0);try{const n=i().identity?.getPrincipal();if(!n){B("/");return}let d={page:e(p),user_id:n.toString()};g(s,await pe.getGameSummaries(d)),e(s)?.total&&e(s)?.pageSize&&g(S,BigInt(Math.ceil(Number(e(s).total)/Number(e(s).pageSize))))}catch{me.addToast({type:"error",message:"Error loading game summaries."}),g(s,null)}finally{g(o,!1)}}Q(),ne(f,{children:(_,n)=>{var d=E(),R=h(d);{var k=m=>{ge(m)},K=m=>{le(m,{title:"GAMES",buttonTitle:"NEW GAME",buttonCallback:F,children:(q,he)=>{var $=E(),M=h($);{var x=c=>{var v=ve(),T=h(v);{var j=l=>{var y=E(),Y=h(y);ae(Y,1,()=>e(s)?.entries,te,(H,J)=>{_e(H,{get game(){return e(J)}})}),u(l,y)},O=l=>{var y=de();u(l,y)};A(T,l=>{e(s).entries.length>0?l(j):l(O,!1)})}var W=Z(T,2);const X=ee(()=>Number(e(p)));ue(W,{changePage:L,get currentPage(){return e(X)},get totalPages(){return e(S)}}),u(c,v)},z=c=>{var v=ye();u(c,v)};A(M,c=>{e(s)?c(x):c(z,!1)})}u(q,$)},$$slots:{default:!0}})};A(R,m=>{e(o)?m(k):m(K,!1)})}u(_,d)},$$slots:{default:!0}}),V(),t()}export{Be as component};
